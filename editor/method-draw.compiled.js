(function(){if(!("SVGPathSeg"in window)){window.SVGPathSeg=function(b,n,a){this.pathSegType=b;this.pathSegTypeAsLetter=n;this._owningPathSegList=a};SVGPathSeg.PATHSEG_UNKNOWN=0;SVGPathSeg.PATHSEG_CLOSEPATH=1;SVGPathSeg.PATHSEG_MOVETO_ABS=2;SVGPathSeg.PATHSEG_MOVETO_REL=3;SVGPathSeg.PATHSEG_LINETO_ABS=4;SVGPathSeg.PATHSEG_LINETO_REL=5;SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6;SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9;SVGPathSeg.PATHSEG_ARC_ABS=
10;SVGPathSeg.PATHSEG_ARC_REL=11;SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12;SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13;SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14;SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15;SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16;SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18;SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19;SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)};
window.SVGPathSegClosePath=function(b){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CLOSEPATH,"z",b)};SVGPathSegClosePath.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"};SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter};SVGPathSegClosePath.prototype.clone=function(){return new SVGPathSegClosePath(undefined)};window.SVGPathSegMovetoAbs=function(b,n,a){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_ABS,
"M",b);this._x=n;this._y=a};SVGPathSegMovetoAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"};SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegMovetoAbs.prototype.clone=function(){return new SVGPathSegMovetoAbs(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(b){this._x=
b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});window.SVGPathSegMovetoRel=function(b,n,a){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_MOVETO_REL,"m",b);this._x=n;this._y=a};SVGPathSegMovetoRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"};SVGPathSegMovetoRel.prototype._asPathString=
function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegMovetoRel.prototype.clone=function(){return new SVGPathSegMovetoRel(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoAbs=
function(b,n,a){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_ABS,"L",b);this._x=n;this._y=a};SVGPathSegLinetoAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"};SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegLinetoAbs.prototype.clone=function(){return new SVGPathSegLinetoAbs(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegLinetoAbs.prototype,
"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoRel=function(b,n,a){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_REL,"l",b);this._x=n;this._y=a};SVGPathSegLinetoRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"};
SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegLinetoRel.prototype.clone=function(){return new SVGPathSegLinetoRel(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},
enumerable:true});window.SVGPathSegCurvetoCubicAbs=function(b,n,a,d,c,p,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",b);this._x=n;this._y=a;this._x1=d;this._y1=c;this._x2=p;this._y2=e};SVGPathSegCurvetoCubicAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"};SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+
" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicAbs(undefined,this._x,this._y,this._x1,this._y1,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});
Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(b){this._x1=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(b){this._y1=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(b){this._x2=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicAbs.prototype,
"y2",{get:function(){return this._y2},set:function(b){this._y2=b;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoCubicRel=function(b,n,a,d,c,p,e){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",b);this._x=n;this._y=a;this._x1=d;this._y1=c;this._x2=p;this._y2=e};SVGPathSegCurvetoCubicRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"};SVGPathSegCurvetoCubicRel.prototype._asPathString=
function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicRel(undefined,this._x,this._y,this._x1,this._y1,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},
set:function(b){this._y=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(b){this._x1=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(b){this._y1=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(b){this._x2=
b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(b){this._y2=b;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoQuadraticAbs=function(b,n,a,d,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",b);this._x=n;this._y=a;this._x1=d;this._y1=c};SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticAbs.prototype.toString=
function(){return"[object SVGPathSegCurvetoQuadraticAbs]"};SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticAbs(undefined,this._x,this._y,this._x1,this._y1)};Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});
Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(b){this._x1=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(b){this._y1=b;this._segmentChanged()},enumerable:true});
window.SVGPathSegCurvetoQuadraticRel=function(b,n,a,d,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",b);this._x=n;this._y=a;this._x1=d;this._y1=c};SVGPathSegCurvetoQuadraticRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"};SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y};
SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticRel(undefined,this._x,this._y,this._x1,this._y1)};Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,
"x1",{get:function(){return this._x1},set:function(b){this._x1=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(b){this._y1=b;this._segmentChanged()},enumerable:true});window.SVGPathSegArcAbs=function(b,n,a,d,c,p,e,k){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_ABS,"A",b);this._x=n;this._y=a;this._r1=d;this._r2=c;this._angle=p;this._largeArcFlag=e;this._sweepFlag=k};SVGPathSegArcAbs.prototype=
Object.create(SVGPathSeg.prototype);SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"};SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y};SVGPathSegArcAbs.prototype.clone=function(){return new SVGPathSegArcAbs(undefined,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)};Object.defineProperty(SVGPathSegArcAbs.prototype,
"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(b){this._r1=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(b){this._r2=
b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(b){this._angle=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(b){this._largeArcFlag=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(b){this._sweepFlag=
b;this._segmentChanged()},enumerable:true});window.SVGPathSegArcRel=function(b,n,a,d,c,p,e,k){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_ARC_REL,"a",b);this._x=n;this._y=a;this._r1=d;this._r2=c;this._angle=p;this._largeArcFlag=e;this._sweepFlag=k};SVGPathSegArcRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"};SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+
this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y};SVGPathSegArcRel.prototype.clone=function(){return new SVGPathSegArcRel(undefined,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)};Object.defineProperty(SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},
set:function(b){this._y=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(b){this._r1=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(b){this._r2=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(b){this._angle=
b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(b){this._largeArcFlag=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(b){this._sweepFlag=b;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoHorizontalAbs=function(b,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,
"H",b);this._x=n};SVGPathSegLinetoHorizontalAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"};SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x};SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new SVGPathSegLinetoHorizontalAbs(undefined,this._x)};Object.defineProperty(SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},
set:function(b){this._x=b;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoHorizontalRel=function(b,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",b);this._x=n};SVGPathSegLinetoHorizontalRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"};SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x};SVGPathSegLinetoHorizontalRel.prototype.clone=
function(){return new SVGPathSegLinetoHorizontalRel(undefined,this._x)};Object.defineProperty(SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoVerticalAbs=function(b,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",b);this._y=n};SVGPathSegLinetoVerticalAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"};
SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y};SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new SVGPathSegLinetoVerticalAbs(undefined,this._y)};Object.defineProperty(SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});window.SVGPathSegLinetoVerticalRel=function(b,n){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",b);
this._y=n};SVGPathSegLinetoVerticalRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"};SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y};SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new SVGPathSegLinetoVerticalRel(undefined,this._y)};Object.defineProperty(SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},
set:function(b){this._y=b;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoCubicSmoothAbs=function(b,n,a,d,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",b);this._x=n;this._y=a;this._x2=d;this._y2=c};SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"};SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+
" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothAbs(undefined,this._x,this._y,this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},
enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(b){this._x2=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(b){this._y2=b;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoCubicSmoothRel=function(b,n,a,d,c){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",b);this._x=n;
this._y=a;this._x2=d;this._y2=c};SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"};SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y};SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoCubicSmoothRel(undefined,this._x,this._y,
this._x2,this._y2)};Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(b){this._x2=b;this._segmentChanged()},
enumerable:true});Object.defineProperty(SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(b){this._y2=b;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoQuadraticSmoothAbs=function(b,n,a){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",b);this._x=n;this._y=a};SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"};
SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothAbs(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothAbs.prototype,
"y",{get:function(){return this._y},set:function(b){this._y=b;this._segmentChanged()},enumerable:true});window.SVGPathSegCurvetoQuadraticSmoothRel=function(b,n,a){SVGPathSeg.call(this,SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",b);this._x=n;this._y=a};SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(SVGPathSeg.prototype);SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"};SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=
function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y};SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new SVGPathSegCurvetoQuadraticSmoothRel(undefined,this._x,this._y)};Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(b){this._x=b;this._segmentChanged()},enumerable:true});Object.defineProperty(SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(b){this._y=
b;this._segmentChanged()},enumerable:true});SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new SVGPathSegClosePath(undefined)};SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(b,n){return new SVGPathSegMovetoAbs(undefined,b,n)};SVGPathElement.prototype.createSVGPathSegMovetoRel=function(b,n){return new SVGPathSegMovetoRel(undefined,b,n)};SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(b,n){return new SVGPathSegLinetoAbs(undefined,b,n)};SVGPathElement.prototype.createSVGPathSegLinetoRel=
function(b,n){return new SVGPathSegLinetoRel(undefined,b,n)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(b,n,a,d,c,p){return new SVGPathSegCurvetoCubicAbs(undefined,b,n,a,d,c,p)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(b,n,a,d,c,p){return new SVGPathSegCurvetoCubicRel(undefined,b,n,a,d,c,p)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(b,n,a,d){return new SVGPathSegCurvetoQuadraticAbs(undefined,b,n,a,d)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=
function(b,n,a,d){return new SVGPathSegCurvetoQuadraticRel(undefined,b,n,a,d)};SVGPathElement.prototype.createSVGPathSegArcAbs=function(b,n,a,d,c,p,e){return new SVGPathSegArcAbs(undefined,b,n,a,d,c,p,e)};SVGPathElement.prototype.createSVGPathSegArcRel=function(b,n,a,d,c,p,e){return new SVGPathSegArcRel(undefined,b,n,a,d,c,p,e)};SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(b){return new SVGPathSegLinetoHorizontalAbs(undefined,b)};SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=
function(b){return new SVGPathSegLinetoHorizontalRel(undefined,b)};SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(b){return new SVGPathSegLinetoVerticalAbs(undefined,b)};SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(b){return new SVGPathSegLinetoVerticalRel(undefined,b)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(b,n,a,d){return new SVGPathSegCurvetoCubicSmoothAbs(undefined,b,n,a,d)};SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=
function(b,n,a,d){return new SVGPathSegCurvetoCubicSmoothRel(undefined,b,n,a,d)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(b,n){return new SVGPathSegCurvetoQuadraticSmoothAbs(undefined,b,n)};SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(b,n){return new SVGPathSegCurvetoQuadraticSmoothRel(undefined,b,n)}}if(!("SVGPathSegList"in window)){window.SVGPathSegList=function(b){this._pathElement=b;this._list=this._parsePath(this._pathElement.getAttribute("d"));
this._mutationObserverConfig={attributes:true,attributeFilter:["d"]};this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this));this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};Object.defineProperty(SVGPathSegList.prototype,"numberOfItems",{get:function(){this._checkPathSynchronizedToList();return this._list.length},enumerable:true});Object.defineProperty(SVGPathElement.prototype,"pathSegList",{get:function(){if(!this._pathSegList)this._pathSegList=
new SVGPathSegList(this);return this._pathSegList},enumerable:true});Object.defineProperty(SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:true});Object.defineProperty(SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:true});Object.defineProperty(SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:true});SVGPathSegList.prototype._checkPathSynchronizedToList=
function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())};SVGPathSegList.prototype._updateListFromPathMutations=function(b){if(this._pathElement){var n=false;b.forEach(function(a){if(a.attributeName=="d")n=true});if(n)this._list=this._parsePath(this._pathElement.getAttribute("d"))}};SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect();this._pathElement.setAttribute("d",SVGPathSegList._pathSegArrayAsString(this._list));
this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)};SVGPathSegList.prototype.segmentChanged=function(){this._writeListToPath()};SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList();this._list.forEach(function(b){b._owningPathSegList=null});this._list=[];this._writeListToPath()};SVGPathSegList.prototype.initialize=function(b){this._checkPathSynchronizedToList();this._list=[b];b._owningPathSegList=this;this._writeListToPath();return b};
SVGPathSegList.prototype._checkValidIndex=function(b){if(isNaN(b)||b<0||b>=this.numberOfItems)throw"INDEX_SIZE_ERR";};SVGPathSegList.prototype.getItem=function(b){this._checkPathSynchronizedToList();this._checkValidIndex(b);return this._list[b]};SVGPathSegList.prototype.insertItemBefore=function(b,n){this._checkPathSynchronizedToList();if(n>this.numberOfItems)n=this.numberOfItems;if(b._owningPathSegList)b=b.clone();this._list.splice(n,0,b);b._owningPathSegList=this;this._writeListToPath();return b};
SVGPathSegList.prototype.replaceItem=function(b,n){this._checkPathSynchronizedToList();if(b._owningPathSegList)b=b.clone();this._checkValidIndex(n);this._list[n]=b;b._owningPathSegList=this;this._writeListToPath();return b};SVGPathSegList.prototype.removeItem=function(b){this._checkPathSynchronizedToList();this._checkValidIndex(b);var n=this._list[b];this._list.splice(b,1);this._writeListToPath();return n};SVGPathSegList.prototype.appendItem=function(b){this._checkPathSynchronizedToList();if(b._owningPathSegList)b=
b.clone();this._list.push(b);b._owningPathSegList=this;this._writeListToPath();return b};SVGPathSegList._pathSegArrayAsString=function(b){var n="",a=true;b.forEach(function(d){if(a){a=false;n+=d._asPathString()}else n+=" "+d._asPathString()});return n};SVGPathSegList.prototype._parsePath=function(b){if(!b||b.length==0)return[];var n=this,a=function(){this.pathSegList=[]};a.prototype.appendSegment=function(c){this.pathSegList.push(c)};var d=function(c){this._string=c;this._currentIndex=0;this._endIndex=
this._string.length;this._previousCommand=SVGPathSeg.PATHSEG_UNKNOWN;this._skipOptionalSpaces()};d.prototype._isCurrentSpace=function(){var c=this._string[this._currentIndex];return c<=" "&&(c==" "||c=="\n"||c=="\t"||c=="\r"||c=="\u000c")};d.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex};d.prototype._skipOptionalSpacesOrDelimiter=function(){if(this._currentIndex<this._endIndex&&
!this._isCurrentSpace()&&this._string.charAt(this._currentIndex)!=",")return false;if(this._skipOptionalSpaces())if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)==","){this._currentIndex++;this._skipOptionalSpaces()}return this._currentIndex<this._endIndex};d.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex};d.prototype.peekSegmentType=function(){return this._pathSegTypeFromChar(this._string[this._currentIndex])};d.prototype._pathSegTypeFromChar=
function(c){switch(c){case "Z":case "z":return SVGPathSeg.PATHSEG_CLOSEPATH;case "M":return SVGPathSeg.PATHSEG_MOVETO_ABS;case "m":return SVGPathSeg.PATHSEG_MOVETO_REL;case "L":return SVGPathSeg.PATHSEG_LINETO_ABS;case "l":return SVGPathSeg.PATHSEG_LINETO_REL;case "C":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case "c":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case "Q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case "q":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case "A":return SVGPathSeg.PATHSEG_ARC_ABS;
case "a":return SVGPathSeg.PATHSEG_ARC_REL;case "H":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case "h":return SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case "V":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case "v":return SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case "S":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case "s":return SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case "T":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case "t":return SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;
default:return SVGPathSeg.PATHSEG_UNKNOWN}};d.prototype._nextCommandHelper=function(c,p){if((c=="+"||c=="-"||c=="."||c>="0"&&c<="9")&&p!=SVGPathSeg.PATHSEG_CLOSEPATH){if(p==SVGPathSeg.PATHSEG_MOVETO_ABS)return SVGPathSeg.PATHSEG_LINETO_ABS;if(p==SVGPathSeg.PATHSEG_MOVETO_REL)return SVGPathSeg.PATHSEG_LINETO_REL;return p}return SVGPathSeg.PATHSEG_UNKNOWN};d.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return true;var c=this.peekSegmentType();return c==SVGPathSeg.PATHSEG_MOVETO_ABS||
c==SVGPathSeg.PATHSEG_MOVETO_REL};d.prototype._parseNumber=function(){var c=0,p=0,e=1,k=0,h=1,o=1,u=this._currentIndex;this._skipOptionalSpaces();if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="+")this._currentIndex++;else if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="-"){this._currentIndex++;h=-1}if(!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&this._string.charAt(this._currentIndex)!=
".")){for(var B=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=B)for(var s=this._currentIndex-1,K=1;s>=B;){p+=K*(this._string.charAt(s--)-"0");K*=10}if(this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)=="."){this._currentIndex++;if(this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>
"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)k+=(this._string.charAt(this._currentIndex++)-"0")*(e*=0.1)}if(this._currentIndex!=u&&this._currentIndex+1<this._endIndex&&(this._string.charAt(this._currentIndex)=="e"||this._string.charAt(this._currentIndex)=="E")&&this._string.charAt(this._currentIndex+1)!="x"&&this._string.charAt(this._currentIndex+1)!="m"){this._currentIndex++;if(this._string.charAt(this._currentIndex)==
"+")this._currentIndex++;else if(this._string.charAt(this._currentIndex)=="-"){this._currentIndex++;o=-1}if(this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";){c*=10;c+=this._string.charAt(this._currentIndex)-"0";this._currentIndex++}}p=p+k;p*=h;if(c)p*=Math.pow(10,o*c);if(u!=this._currentIndex){this._skipOptionalSpacesOrDelimiter();
return p}}};d.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var c=false;c=this._string.charAt(this._currentIndex++);if(c=="0")c=false;else if(c=="1")c=true;else return;this._skipOptionalSpacesOrDelimiter();return c}};d.prototype.parseSegment=function(){var c=this._string[this._currentIndex],p=this._pathSegTypeFromChar(c);if(p==SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==SVGPathSeg.PATHSEG_UNKNOWN)return null;p=this._nextCommandHelper(c,this._previousCommand);
if(p==SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;this._previousCommand=p;switch(p){case SVGPathSeg.PATHSEG_MOVETO_REL:return new SVGPathSegMovetoRel(n,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_MOVETO_ABS:return new SVGPathSegMovetoAbs(n,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_REL:return new SVGPathSegLinetoRel(n,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_ABS:return new SVGPathSegLinetoAbs(n,this._parseNumber(),
this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new SVGPathSegLinetoHorizontalRel(n,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new SVGPathSegLinetoHorizontalAbs(n,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new SVGPathSegLinetoVerticalRel(n,this._parseNumber());case SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new SVGPathSegLinetoVerticalAbs(n,this._parseNumber());case SVGPathSeg.PATHSEG_CLOSEPATH:this._skipOptionalSpaces();
return new SVGPathSegClosePath(n);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:c={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicRel(n,c.x,c.y,c.x1,c.y1,c.x2,c.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:c={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicAbs(n,
c.x,c.y,c.x1,c.y1,c.x2,c.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:c={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothRel(n,c.x,c.y,c.x2,c.y2);case SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:c={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoCubicSmoothAbs(n,c.x,c.y,c.x2,c.y2);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:c={x1:this._parseNumber(),
y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticRel(n,c.x,c.y,c.x1,c.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:c={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegCurvetoQuadraticAbs(n,c.x,c.y,c.x1,c.y1);case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new SVGPathSegCurvetoQuadraticSmoothRel(n,this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new SVGPathSegCurvetoQuadraticSmoothAbs(n,
this._parseNumber(),this._parseNumber());case SVGPathSeg.PATHSEG_ARC_REL:c={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcRel(n,c.x,c.y,c.x1,c.y1,c.arcAngle,c.arcLarge,c.arcSweep);case SVGPathSeg.PATHSEG_ARC_ABS:c={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),
x:this._parseNumber(),y:this._parseNumber()};return new SVGPathSegArcAbs(n,c.x,c.y,c.x1,c.y1,c.arcAngle,c.arcLarge,c.arcSweep);default:throw"Unknown path seg type.";}};a=new a;b=new d(b);if(!b.initialCommandIsMoveTo())return[];for(;b.hasMoreData();){d=b.parseSegment();if(!d)return[];a.appendSegment(d)}return a.pathSegList}}})();function touchHandler(b){var n=b.changedTouches,a=n[0],d="";switch(b.type){case "touchstart":d="mousedown";break;case "touchmove":d="mousemove";break;case "touchend":d="mouseup";break;default:return}var c=document.createEvent("MouseEvent");c.initMouseEvent(d,true,true,window,1,a.screenX,a.screenY,a.clientX,a.clientY,false,false,false,false,0,null);if(n.length<2){a.target.dispatchEvent(c);b.preventDefault()}};(function(b){function n(a){if(typeof a.data==="string"){var d=a.handler,c=a.data.toLowerCase().split(" ");a.handler=function(p){if(!(this!==p.target&&(/textarea|select/i.test(p.target.nodeName)||p.target.type==="text"))){var e=p.type!=="keypress"&&b.hotkeys.specialKeys[p.which],k=String.fromCharCode(p.which).toLowerCase(),h="",o={};if(p.altKey&&e!=="alt")h+="alt+";if(p.ctrlKey&&e!=="ctrl")h+="ctrl+";if(p.metaKey&&!p.ctrlKey&&e!=="meta")h+="meta+";if(p.shiftKey&&e!=="shift")h+="shift+";if(e)o[h+e]=
true;else{o[h+k]=true;o[h+b.hotkeys.shiftNums[k]]=true;if(h==="shift+")o[b.hotkeys.shiftNums[k]]=true}e=0;for(k=c.length;e<k;e++)if(o[c[e]])return d.apply(this,arguments)}}}}b.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",
106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta",219:"[",221:"]"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};b.each(["keydown","keyup","keypress"],function(){b.event.special[this]={add:n}})})(jQuery);(function(b){var n={},a;b.svgIcons=function(d,c){function p(la,ba){if(la!=="ajax"){if(R)return;var ea=(P=ia[0].contentDocument)&&P.getElementById("svg_eof");if(!ea&&!(ba&&ea)){T++;if(T<50)setTimeout(p,20);else{k();R=true}return}R=true}K=b(P.firstChild).children();if(c.no_img)setTimeout(function(){I||e()},500);else{ea=ma+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzUiIGhlaWdodD0iMjc1Ij48L3N2Zz4%3D";M=b(new Image).attr({src:ea,width:0,height:0}).appendTo("body").load(function(){e(true)}).error(function(){e()})}}
function e(la,ba){if(!I){if(c.no_img)la=false;if(la){var ea=b(document.createElement("div"));ea.hide().appendTo("body")}if(ba){var ra=c.fallback_path?c.fallback_path:"";b.each(ba,function(Ra,Ja){b("#"+Ra);var ta=b(new Image).attr({"class":"svg_icon",src:ra+Ja,width:B,height:s,alt:"icon"});ha(ta,Ra)})}else for(var pa=K.length,na=0;na<pa;na++){var qa=K[na],Ka=qa.id;if(Ka==="svg_eof")break;b("#"+Ka);qa=qa.getElementsByTagNameNS(o,"svg")[0];var Fa=document.createElementNS(o,"svg");Fa.setAttributeNS(o,
"viewBox",[0,0,B,s].join(" "));var Oa=qa.getAttribute("width"),La=qa.getAttribute("height");qa.removeAttribute("width");qa.removeAttribute("height");qa.getAttribute("viewBox")||qa.setAttribute("viewBox",[0,0,Oa,La].join(" "));Fa.setAttribute("xmlns",o);Fa.setAttribute("width",B);Fa.setAttribute("height",s);Fa.setAttribute("xmlns:xlink",u);Fa.setAttribute("class","svg_icon");ca||(qa=qa.cloneNode(true));Fa.appendChild(qa);if(la){ca||Fa.cloneNode(true);ea.empty().append(Fa);qa=ma+h(ea.html());qa=b(new Image).attr({"class":"svg_icon",
src:qa})}else qa=a(b(Fa),na);ha(qa,Ka)}c.placement&&b.each(c.placement,function(Ra,Ja){n[Ja]&&b(Ra).each(function(ta){var wa=n[Ja].clone();if(ta>0&&!la)wa=a(wa,ta,true);oa(b(this),wa,Ja)})});if(!ba){la&&ea.remove();ia&&ia.remove();M&&M.remove()}c.resize&&b.resizeSvgIcons(c.resize);I=true;c.callback&&c.callback(n)}}function k(){if(d.indexOf(".svgz")!=-1){var la=d.replace(".svgz",".svg");window.console&&console.log(".svgz failed, trying with .svg");b.svgIcons(la,c)}else c.fallback&&e(false,c.fallback)}
function h(la){if(window.btoa)return window.btoa(la);var ba=Array(Math.floor((la.length+2)/3)*4),ea,ra,pa,na,qa,Ka,Fa=0,Oa=0;do{ea=la.charCodeAt(Fa++);ra=la.charCodeAt(Fa++);pa=la.charCodeAt(Fa++);na=ea>>2;ea=(ea&3)<<4|ra>>4;qa=(ra&15)<<2|pa>>6;Ka=pa&63;if(isNaN(ra))qa=Ka=64;else if(isNaN(pa))Ka=64;ba[Oa++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(na);ba[Oa++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(ea);ba[Oa++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(qa);
ba[Oa++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(Ka)}while(Fa<la.length);return ba.join("")}var o="http://www.w3.org/2000/svg",u="http://www.w3.org/1999/xlink",B=c.w?c.w:24,s=c.h?c.h:24,K,P,M,I=false,R=false,T=0,O=navigator.userAgent,ca=!!window.opera;O.indexOf("Safari/")>-1&&O.indexOf("Chrome/");var ma="data:image/svg+xml;charset=utf-8;base64,";if(c.svgz){var ia=b('<object data="'+d+'" type=image/svg+xml>').appendTo("body").hide();try{P=ia[0].contentDocument;ia.load(p);
p(0,true)}catch(Z){k()}}else{var V=new DOMParser;b.ajax({url:d,dataType:"string",success:function(la){if(la){P=V.parseFromString(la,"text/xml");b(function(){p("ajax")})}else b(k)},error:function(la){if(window.opera)b(function(){k()});else if(la.responseText){P=V.parseFromString(la.responseText,"text/xml");P.childNodes.length||b(k);b(function(){p("ajax")})}else b(k)}})}var oa=function(la,ba,ea,ra){ca&&ba.css("visibility","hidden");if(c.replace){ra&&ba.attr("id",ea);(ea=la.attr("class"))&&ba.attr("class",
"svg_icon "+ea);la.replaceWith(ba)}else la.append(ba);ca&&setTimeout(function(){ba.removeAttr("style")},1)},ha=function(la,ba){if(c.id_match===undefined||c.id_match!==false)oa(holder,la,ba,true);n[ba]=la};a=function(la,ba){var ea=la.find("defs");if(!ea.length)return la;ea=ca?ea.find("*").filter(function(){return!!this.id}):ea.find("[id]");var ra=la[0].getElementsByTagName("*"),pa=ra.length;ea.each(function(na){var qa=this.id;b(P).find("#"+qa);this.id=na="x"+qa+ba+na;qa="url(#"+qa+")";var Ka="url(#"+
na+")";for(na=0;na<pa;na++){var Fa=ra[na];Fa.getAttribute("fill")===qa&&Fa.setAttribute("fill",Ka);Fa.getAttribute("stroke")===qa&&Fa.setAttribute("stroke",Ka);Fa.getAttribute("filter")===qa&&Fa.setAttribute("filter",Ka)}});return la}};b.getSvgIcon=function(d,c){var p=n[d];if(c&&p)p=a(p,0,true).clone(true);return p};b.resizeSvgIcons=function(d){var c=!b(".svg_icon:first").length;b.each(d,function(p,e){var k=b.isArray(e),h=k?e[0]:e,o=k?e[1]:e;if(c)p=p.replace(/\.svg_icon/g,"svg");b(p).each(function(){this.setAttribute("width",
h);this.setAttribute("height",o);if(window.opera&&window.widget){this.parentNode.style.width=h+"px";this.parentNode.style.height=o+"px"}})})}})(jQuery);(function(){function b(d,c,p){d=document.createElementNS(n.svg,d);if(a)for(var e in c)d.setAttribute(e,c[e]);else for(e in c){var k=c[e],h=d[e];if(h&&h.constructor==="SVGLength")h.baseVal.value=k;else d.setAttribute(e,k)}p&&p.appendChild(d);return d}var n={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"};if(!window.console)window.console=new function(){this.log=function(){};this.dir=function(){}};$.jGraduate={Paint:function(d){d=d||{};this.alpha=isNaN(d.alpha)?100:d.alpha;if(d.copy){this.type=
d.copy.type;this.alpha=d.copy.alpha;this.radialGradient=this.linearGradient=this.solidColor=null;switch(this.type){case "solidColor":this.solidColor=d.copy.solidColor;break;case "linearGradient":this.linearGradient=d.copy.linearGradient.cloneNode(true);break;case "radialGradient":this.radialGradient=d.copy.radialGradient.cloneNode(true)}}else if(d.linearGradient){this.type="linearGradient";this.radialGradient=this.solidColor=null;this.linearGradient=d.linearGradient.cloneNode(true)}else if(d.radialGradient){this.type=
"radialGradient";this.linearGradient=this.solidColor=null;this.radialGradient=d.radialGradient.cloneNode(true)}else if(d.solidColor){this.type="solidColor";this.solidColor=d.solidColor}else{this.type="none";this.radialGradient=this.linearGradient=this.solidColor=null}}};jQuery.fn.jGraduateDefaults={paint:new $.jGraduate.Paint,window:{pickerTitle:"Drag markers to pick a paint"},images:{clientPath:"images/"},newstop:"inverse"};var a=navigator.userAgent.indexOf("Gecko/")>=0;jQuery.fn.jGraduate=function(d){var c=
arguments;return this.each(function(){function p(ga,aa,ja,N,Q){var da=Q||b("stop",{"stop-color":aa,"stop-opacity":ja,offset:ga},V);if(Q){aa=Q.getAttribute("stop-color");ja=Q.getAttribute("stop-opacity");ga=Q.getAttribute("offset")}else V.appendChild(da);if(ja===null)ja=1;Q=b("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:"url(#jGraduate_trans)",transform:"translate("+(10+ga*ca)+", 26)"},Va);var Da=
b("path",{d:"M-6.2,0.9c3.6-4,6.7-4.3,6.7-12.4c-0.2,7.9,3.1,8.8,6.5,12.4c3.5,3.8,2.9,9.6,0,12.3c-3.1,2.8-10.4,2.7-13.2,0C-9.6,9.9-9.4,4.4-6.2,0.9z",fill:aa,"fill-opacity":ja,transform:"translate("+(10+ga*ca)+", 26)",stroke:"#000","stroke-width":1.5},Va);$(Da).mousedown(function(Ma){e(this);Ya=fb;R.mousemove(o).mouseup(k);ua=ub.offset();Ma.preventDefault();return false}).data("stop",da).data("bg",Q).dblclick(function(){$("div.jGraduate_LightBox").show();for(var Ma=this,Sa=+da.getAttribute("stop-opacity")||
1,cb=da.getAttribute("stop-color")||1,pb=(parseFloat(Sa)*255).toString(16);pb.length<2;)pb="0"+pb;aa=cb.substr(1)+pb;$("#"+s+"_jGraduate_stopPicker").css({left:100,bottom:15}).jPicker({window:{title:"Pick the start color and opacity for the gradient"},images:{clientPath:B.images.clientPath},color:{active:aa,alphaSupport:true}},function(Ta){cb=Ta.val("hex")?"#"+Ta.val("hex"):"none";Sa=Ta.val("a")!==null?Ta.val("a")/256:1;Ma.setAttribute("fill",cb);Ma.setAttribute("fill-opacity",Sa);da.setAttribute("stop-color",
cb);da.setAttribute("stop-opacity",Sa);$("div.jGraduate_LightBox").hide();$("#"+s+"_jGraduate_stopPicker").hide()},null,function(){$("div.jGraduate_LightBox").hide();$("#"+s+"_jGraduate_stopPicker").hide()})});$(V).find("stop").each(function(){var Ma=$(this);if(+this.getAttribute("offset")>ga){if(!aa){var Sa=this.getAttribute("stop-color"),cb=this.getAttribute("stop-opacity");da.setAttribute("stop-color",Sa);Da.setAttribute("fill",Sa);da.setAttribute("stop-opacity",cb===null?1:cb);Da.setAttribute("fill-opacity",
cb===null?1:cb)}Ma.before(da);return false}});N&&e(Da);return da}function e(ga){fb&&fb.setAttribute("stroke","#000");ga.setAttribute("stroke","blue");fb=ga;fb.parentNode.appendChild(fb)}function k(){R.unbind("mousemove",o);if(Ba.getAttribute("display")!=="none"){Ba.setAttribute("display","none");var ga=$(fb),aa=ga.data("stop");ga=ga.data("bg");$([fb,aa,ga]).remove()}Ya=null}function h(){var ga=Ua?"rotate("+Ua+","+Ca+","+hb+") ":"";db===1&&Ga===1?V.removeAttribute("gradientTransform"):V.setAttribute("gradientTransform",
ga+"translate("+-Ca*(db-1)+","+-hb*(Ga-1)+") scale("+db+","+Ga+")")}function o(ga){var aa=ga.pageX-ua.left;ga=ga.pageY-ua.top;aa=aa<10?10:aa>ca+10?ca+10:aa;var ja="translate("+aa+", 26)";if(ga<-60||ga>130){Ba.setAttribute("display","block");Ba.setAttribute("transform",ja)}else Ba.setAttribute("display","none");Ya.setAttribute("transform",ja);$.data(Ya,"bg").setAttribute("transform",ja);$.data(Ya,"stop").setAttribute("offset",(aa-10)/ca);var N=0;$(V).find("stop").each(function(){var Q=this.getAttribute("offset"),
da=$(this);if(Q<N){da.prev().before(da);va=$(V).find("stop")}N=Q})}var u=$(this),B=$.extend(true,{},jQuery.fn.jGraduateDefaults,d),s=u.attr("id"),K="#"+u.attr("id")+" ";if(K){var P=function(){switch(u.paint.type){case "radialGradient":u.paint.linearGradient=null;break;case "linearGradient":u.paint.radialGradient=null;break;case "solidColor":u.paint.radialGradient=u.paint.linearGradient=null}$.isFunction(u.okCallback)&&u.okCallback(u.paint);u.hide()},M=function(){$.isFunction(u.cancelCallback)&&u.cancelCallback();
u.hide()};$.extend(true,u,{paint:new $.jGraduate.Paint({copy:B.paint}),okCallback:$.isFunction(c[1])&&c[1]||null,cancelCallback:$.isFunction(c[2])&&c[2]||null});u.position();var I=null,R=$(window);if(u.paint.type=="none")u.paint=$.jGraduate.Paint({solidColor:"ffffff"});u.addClass("jGraduate_Picker");u.html('<ul class="jGraduate_tabs"><li class="jGraduate_tab_color jGraduate_tab_current" data-type="col">Solid Color</li><li class="jGraduate_tab_lingrad" data-type="lg">Linear Gradient</li><li class="jGraduate_tab_radgrad" data-type="rg">Radial Gradient</li></ul><div class="jGraduate_colPick"></div><div class="jGraduate_gradPick"></div><div class="jGraduate_LightBox"></div><div id="'+
s+'_jGraduate_stopPicker" class="jGraduate_stopPicker"></div>');var T=$(K+"> .jGraduate_colPick"),O=$(K+"> .jGraduate_gradPick");O.html('<div id="'+s+'_jGraduate_Swatch" class="jGraduate_Swatch"><h2 class="jGraduate_Title">'+B.window.pickerTitle+'</h2><div id="'+s+'_jGraduate_GradContainer" class="jGraduate_GradContainer"></div><div id="'+s+'_jGraduate_StopSlider" class="jGraduate_StopSlider"></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_lg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Begin Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+
s+'_jGraduate_x1" size="3" title="Enter starting x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+s+'_jGraduate_y1" size="3" title="Enter starting y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">End Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+s+'_jGraduate_x2" size="3" title="Enter ending x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+
s+'_jGraduate_y2" size="3" title="Enter ending y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_Form jGraduate_Points jGraduate_rg_field"><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Center Point</label><div class="jGraduate_Form_Section"><label>x:</label><input type="text" id="'+s+'_jGraduate_cx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+s+'_jGraduate_cy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div><div class="jGraduate_StopSection"><label class="jGraduate_Form_Heading">Focal Point</label><div class="jGraduate_Form_Section"><label>Match center: <input type="checkbox" checked="checked" id="'+
s+'_jGraduate_match_ctr"/></label><br/><label>x:</label><input type="text" id="'+s+'_jGraduate_fx" size="3" title="Enter x value between 0.0 and 1.0"/><label> y:</label><input type="text" id="'+s+'_jGraduate_fy" size="3" title="Enter y value between 0.0 and 1.0"/></div></div></div><div class="jGraduate_StopSection jGraduate_SpreadMethod"><label class="jGraduate_Form_Heading">Spread method</label><div class="jGraduate_Form_Section"><select class="jGraduate_spreadMethod"><option value=pad selected>Pad</option><option value=reflect>Reflect</option><option value=repeat>Repeat</option></select></div></div><div class="jGraduate_Form"><div class="jGraduate_Slider jGraduate_RadiusField jGraduate_rg_field"><label class="prelabel">Radius:</label><div id="'+
s+'_jGraduate_Radius" class="jGraduate_SliderBar jGraduate_Radius" title="Click to set radius"><img id="'+s+'_jGraduate_RadiusArrows" class="jGraduate_RadiusArrows" src="'+B.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_RadiusInput" size="3" value="100"/>%</label></div><div class="jGraduate_Slider jGraduate_EllipField jGraduate_rg_field"><label class="prelabel">Ellip:</label><div id="'+s+'_jGraduate_Ellip" class="jGraduate_SliderBar jGraduate_Ellip" title="Click to set Ellip"><img id="'+
s+'_jGraduate_EllipArrows" class="jGraduate_EllipArrows" src="'+B.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_EllipInput" size="3" value="0"/>%</label></div><div class="jGraduate_Slider jGraduate_AngleField jGraduate_rg_field"><label class="prelabel">Angle:</label><div id="'+s+'_jGraduate_Angle" class="jGraduate_SliderBar jGraduate_Angle" title="Click to set Angle"><img id="'+s+'_jGraduate_AngleArrows" class="jGraduate_AngleArrows" src="'+B.images.clientPath+
'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_AngleInput" size="3" value="0"/>\u00ba&nbsp;</label></div><div class="jGraduate_Slider jGraduate_OpacField"><label class="prelabel">Opac:</label><div id="'+s+'_jGraduate_Opac" class="jGraduate_SliderBar jGraduate_Opac" title="Click to set Opac"><img id="'+s+'_jGraduate_OpacArrows" class="jGraduate_OpacArrows" src="'+B.images.clientPath+'rangearrows2.gif"></div><label><input type="text" id="'+s+'_jGraduate_OpacInput" size="3" value="100"/>%</label></div></div><div class="jGraduate_OkCancel"><input type="button" id="'+
s+'_jGraduate_Ok" class="jGraduate_Ok" value="OK"/><input type="button" id="'+s+'_jGraduate_Cancel" class="jGraduate_Cancel" value="Cancel"/></div>');var ca=256,ma=ca-0,ia=ca-0,Z,V,oa,ha={};$(".jGraduate_SliderBar").width(145);var la=$("#"+s+"_jGraduate_GradContainer")[0],ba=b("svg",{id:s+"_jgraduate_svg",width:ca,height:ca,xmlns:n.svg},la);Z=Z||u.paint.type;var ea=V=u.paint[Z],ra=u.paint.alpha,pa=Z==="solidColor";switch(Z){case "solidColor":case "linearGradient":if(!pa){V.id=s+"_lg_jgraduate_grad";
ea=V=ba.appendChild(V)}b("radialGradient",{id:s+"_rg_jgraduate_grad"},ba);if(Z==="linearGradient")break;case "radialGradient":if(!pa){V.id=s+"_rg_jgraduate_grad";ea=V=ba.appendChild(V)}b("linearGradient",{id:s+"_lg_jgraduate_grad",x1:0,y1:0,x2:1,y2:0},ba)}if(pa){ea=V=$("#"+s+"_lg_jgraduate_grad")[0];I=u.paint[Z];p(0,"#"+I,1);var na=typeof B.newstop;if(na==="string")switch(B.newstop){case "same":p(1,"#"+I,1);break;case "inverse":na="";if(I.length===3)I=I.split("").map(function(ga){return ga+""+ga}).join("");
for(var qa=0;qa<6;qa+=2){I.substr(qa,2);var Ka=(255-parseInt(I.substr(qa,2),16)).toString(16);if(Ka.length<2)Ka=0+Ka;na+=Ka}p(1,"#"+na,1);break;case "white":p(1,"#ffffff",1);break;case "black":p(1,"#000000",1)}else if(na==="object")p(1,B.newstop.color||"#"+I,"opac"in B.newstop?B.newstop.opac:1)}I=parseFloat(ea.getAttribute("x1")||0);na=parseFloat(ea.getAttribute("y1")||0);qa=parseFloat(ea.getAttribute("x2")||1);Ka=parseFloat(ea.getAttribute("y2")||0);var Fa=parseFloat(ea.getAttribute("cx")||0.5),
Oa=parseFloat(ea.getAttribute("cy")||0.5),La=parseFloat(ea.getAttribute("fx")||Fa),Ra=parseFloat(ea.getAttribute("fy")||Oa);oa=b("rect",{id:s+"_jgraduate_rect",x:0,y:0,width:ma,height:ia,fill:"url(#"+s+"_jgraduate_grad)","fill-opacity":ra/100},ba);var Ja=$("<div/>").attr({"class":"grad_coord jGraduate_lg_field",title:"Begin Stop"}).text(1).css({top:na*ca,left:I*ca}).data("coord","start").appendTo(la),ta=Ja.clone().text(2).css({top:Ka*ca,left:qa*ca}).attr("title","End stop").data("coord","end").appendTo(la),
wa=$("<div/>").attr({"class":"grad_coord jGraduate_rg_field",title:"Center stop"}).text("C").css({top:Oa*ca,left:Fa*ca}).data("coord","center").appendTo(la),Ea=wa.clone().text("F").css({top:Ra*ca,left:La*ca,display:"none"}).attr("title","Focus point").data("coord","focus").appendTo(la);Ea[0].id=s+"_jGraduate_focusCoord";$(K+" .grad_coord");$.each(["x1","y1","x2","y2","cx","cy","fx","fy"],function(ga,aa){var ja=V.getAttribute(aa),N=isNaN(aa[1]);ja||(ja=N?"0.5":aa==="x2"?"1.0":"0.0");ha[aa]=$("#"+s+
"_jGraduate_"+aa).val(ja).change(function(){if(isNaN(parseFloat(this.value))||this.value<0)this.value=0;else if(this.value>1)this.value=1;if(!(aa[0]==="f"&&!gb))if(N&&Z==="radialGradient"||!N&&Z==="linearGradient")V.setAttribute(aa,this.value);var Q=N?aa[0]==="c"?wa:Ea:aa[1]==="1"?Ja:ta,da=aa.indexOf("x")>=0?"left":"top";Q.css(da,this.value*ca)}).change()});var va,Va,ub=$("#"+s+"_jGraduate_StopSlider"),fb,Wa,Ya,Ba=b("path",{d:"m9.75,-6l-19.5,19.5m0,-19.5l19.5,19.5",fill:"none",stroke:"#D00","stroke-width":5,
display:"none"},Wa),ua,db=1,Ga=1,Ua=0,Ca=Fa,hb=Oa;Wa=b("svg",{width:"100%",height:45},ub[0]);la=b("pattern",{width:16,height:16,patternUnits:"userSpaceOnUse",id:"jGraduate_trans"},Wa);b("image",{width:16,height:16},la).setAttributeNS(n.xlink,"xlink:href",B.images.clientPath+"map-opacity.png");$(Wa).on("click touchstart",function(ga){ua=ub.offset();if(ga.target.tagName!=="path"){var aa=ga.pageX-ua.left-8;aa=aa<10?10:aa>ca+10?ca+10:aa;p(aa/ca,0,0,true);ga.stopPropagation()}});$(Wa).mouseover(function(){Wa.appendChild(Ba)});
Va=b("g",{},Wa);b("line",{x1:10,y1:15,x2:ca+10,y2:15,"stroke-width":2,stroke:"#000"},Wa);var qb=O.find(".jGraduate_spreadMethod").change(function(){V.setAttribute("spreadMethod",$(this).val())}),Za=null,$a=function(ga){var aa=ga.pageX-kb.left,ja=ga.pageY-kb.top;aa=aa<0?0:aa>ca?ca:aa;ja=ja<0?0:ja>ca?ca:ja;Za.css("left",aa).css("top",ja);aa=aa/ma;ja=ja/ia;var N=Za.data("coord"),Q=V;switch(N){case "start":ha.x1.val(aa);ha.y1.val(ja);Q.setAttribute("x1",aa);Q.setAttribute("y1",ja);break;case "end":ha.x2.val(aa);
ha.y2.val(ja);Q.setAttribute("x2",aa);Q.setAttribute("y2",ja);break;case "center":ha.cx.val(aa);ha.cy.val(ja);Q.setAttribute("cx",aa);Q.setAttribute("cy",ja);Ca=aa;hb=ja;h();break;case "focus":ha.fx.val(aa);ha.fy.val(ja);Q.setAttribute("fx",aa);Q.setAttribute("fy",ja);h()}ga.preventDefault()},vb=function(){Za=null;R.unbind("mousemove",$a).unbind("mouseup",vb)};va=V.getElementsByTagNameNS(n.svg,"stop");if(sa<2){for(;sa<2;){V.appendChild(document.createElementNS(n.svg,"stop"));++sa}va=V.getElementsByTagNameNS(n.svg,
"stop")}var sa=va.length;for(qa=0;qa<sa;qa++)p(0,0,0,0,va[qa]);qb.val(V.getAttribute("spreadMethod")||"pad");var kb,gb=false;oa.setAttribute("fill-opacity",ra/100);$("#"+s+" div.grad_coord").mousedown(function(ga){ga.preventDefault();Za=$(this);Za.offset();kb=Za.parent().offset();R.mousemove($a).mouseup(vb)});$("#"+s+"_jGraduate_Ok").bind("click touchstart",function(){u.paint.type=Z;u.paint[Z]=V.cloneNode(true);u.paint.solidColor=null;P()});$("#"+s+"_jGraduate_Cancel").bind("click touchstart",function(){M()});
if(Z==="radialGradient")if(gb)Ea.show();else{Ea.hide();ha.fx.val("");ha.fy.val("")}$("#"+s+"_jGraduate_match_ctr")[0].checked=!gb;var tb,lb;$("#"+s+"_jGraduate_match_ctr").change(function(){gb=!this.checked;Ea.toggle(gb);ha.fx.val("");ha.fy.val("");var ga=V;if(gb){var aa=tb||0.5,ja=lb||0.5;ga.setAttribute("fx",aa);ga.setAttribute("fy",ja);ha.fx.val(aa);ha.fy.val(ja)}else{tb=ga.getAttribute("fx");lb=ga.getAttribute("fy");ga.removeAttribute("fx");ga.removeAttribute("fy")}});va=V.getElementsByTagNameNS(n.svg,
"stop");sa=va.length;if(sa<2){for(;sa<2;){V.appendChild(document.createElementNS(n.svg,"stop"));++sa}va=V.getElementsByTagNameNS(n.svg,"stop")}var eb;ra=O=0;if(Z==="radialGradient"){ba=V.gradientTransform.baseVal;if(ba.numberOfItems===2){sa=ba.getItem(0);ba=ba.getItem(1);if(sa.type===2&&ba.type===3){sa=ba.matrix;if(sa.a!==1)O=Math.round(-(1-sa.a)*100);else if(sa.d!==1)O=Math.round((1-sa.d)*100)}}else if(ba.numberOfItems===3){la=ba.getItem(0);sa=ba.getItem(1);ba=ba.getItem(2);if(la.type===4&&sa.type===
2&&ba.type===3){ra=Math.round(la.angle);sa=ba.matrix;if(sa.a!==1)O=Math.round(-(1-sa.a)*100);else if(sa.d!==1)O=Math.round((1-sa.d)*100)}}}O={radius:{handle:"#"+s+"_jGraduate_RadiusArrows",input:"#"+s+"_jGraduate_RadiusInput",val:(V.getAttribute("r")||0.5)*100},opacity:{handle:"#"+s+"_jGraduate_OpacArrows",input:"#"+s+"_jGraduate_OpacInput",val:u.paint.alpha||100},ellip:{handle:"#"+s+"_jGraduate_EllipArrows",input:"#"+s+"_jGraduate_EllipInput",val:O},angle:{handle:"#"+s+"_jGraduate_AngleArrows",input:"#"+
s+"_jGraduate_AngleInput",val:ra}};$.each(O,function(ga,aa){var ja=$(aa.handle);ja.mousedown(function(N){var Q=ja.parent();eb={type:ga,elem:ja,input:$(aa.input),parent:Q,offset:Q.offset()};R.mousemove(nb).mouseup(rb);N.preventDefault()});$(aa.input).val(aa.val).change(function(){var N=+this.value,Q=0,da=Z==="radialGradient";switch(ga){case "radius":da&&V.setAttribute("r",N/100);Q=Math.pow(N/100,0.4)/2*145;break;case "opacity":u.paint.alpha=N;oa.setAttribute("fill-opacity",N/100);Q=N*1.45;break;case "ellip":db=
Ga=1;if(N===0){Q=72.5;break}if(N>99.5)N=99.5;if(N>0)Ga=1-N/100;else db=-(N/100)-1;Q=145*((N+100)/2)/100;da&&h();break;case "angle":Ua=N;Q=Ua/180;Q+=0.5;Q*=145;da&&h()}if(Q>145)Q=145;else if(Q<0)Q=0;ja.css({"margin-left":Q-5})}).change()});var nb=function(ga){var aa=ga.pageX-eb.offset.left-parseInt(eb.parent.css("border-left-width"));if(aa>145)aa=145;if(aa<=0)aa=0;var ja=aa-5;aa/=145;switch(eb.type){case "radius":aa=Math.pow(aa*2,2.5);if(aa>0.98&&aa<1.02)aa=1;if(aa<=0.01)aa=0.01;V.setAttribute("r",
aa);break;case "opacity":u.paint.alpha=parseInt(aa*100);oa.setAttribute("fill-opacity",aa);break;case "ellip":Ga=db=1;if(aa<0.5){aa/=0.5;db=aa<=0?0.01:aa}else if(aa>0.5){aa/=0.5;aa=2-aa;Ga=aa<=0?0.01:aa}h();aa-=1;if(Ga===aa+1)aa=Math.abs(aa);break;case "angle":aa-=0.5;Ua=aa*=180;h();aa/=100}eb.elem.css({"margin-left":ja});aa=Math.round(aa*100);eb.input.val(aa);ga.preventDefault()},rb=function(){R.unbind("mousemove",nb).unbind("mouseup",rb);eb=null};for(O=(u.paint.alpha*255/100).toString(16);O.length<
2;)O="0"+O;O=O.split(".")[0];I=u.paint.solidColor=="none"?"":u.paint.solidColor+O;pa||(I=va[0].getAttribute("stop-color"));$.extend($.fn.jPicker.defaults.window,{alphaSupport:true,effects:{type:"show",speed:0}});T.jPicker({window:{title:B.window.pickerTitle},images:{clientPath:B.images.clientPath},color:{active:I,alphaSupport:true}},function(ga){u.paint.type="solidColor";u.paint.alpha=ga.val("ahex")?Math.round(ga.val("a")/255*100):100;u.paint.solidColor=ga.val("hex")?ga.val("hex"):"none";u.paint.radialGradient=
null;P()},null,function(){M()});var wb=$(K+" .jGraduate_tabs li");wb.on("click touchstart",function(){wb.removeClass("jGraduate_tab_current");$(this).addClass("jGraduate_tab_current");$(K+" > div").hide();var ga=$(this).attr("data-type");$(K+" .jGraduate_gradPick").show();if(ga==="rg"||ga==="lg"){$(".jGraduate_"+ga+"_field").show();$(".jGraduate_"+(ga==="lg"?"rg":"lg")+"_field").hide();$("#"+s+"_jgraduate_rect")[0].setAttribute("fill","url(#"+s+"_"+ga+"_jgraduate_grad)");Z=ga==="lg"?"linearGradient":
"radialGradient";$("#"+s+"_jGraduate_OpacInput").val(u.paint.alpha).change();var aa=$("#"+s+"_"+ga+"_jgraduate_grad")[0];if(V!==aa){var ja=$(V).find("stop");$(aa).empty().append(ja);V=aa;aa=qb.val();V.setAttribute("spreadMethod",aa)}gb=ga==="rg"&&V.getAttribute("fx")!=null&&!(Fa==La&&Oa==Ra);$("#"+s+"_jGraduate_focusCoord").toggle(gb);if(gb)$("#"+s+"_jGraduate_match_ctr")[0].checked=false}else{$(K+" .jGraduate_gradPick").hide();$(K+" .jGraduate_colPick").show()}});$(K+" > div").hide();wb.removeClass("jGraduate_tab_current");
var xb;switch(u.paint.type){case "linearGradient":xb=$(K+" .jGraduate_tab_lingrad");break;case "radialGradient":xb=$(K+" .jGraduate_tab_radgrad");break;default:xb=$(K+" .jGraduate_tab_color")}u.show();setTimeout(function(){xb.addClass("jGraduate_tab_current").click()},10)}else alert("Container element must have an id attribute to maintain unique id strings for sub-elements.")})}})();jQuery&&function(){var b=$(window),n=$(document);$.extend($.fn,{contextMenu:function(a,d){if(a.menu==undefined)return false;if(a.inSpeed==undefined)a.inSpeed=150;if(a.outSpeed==undefined)a.outSpeed=75;if(a.inSpeed==0)a.inSpeed=-1;if(a.outSpeed==0)a.outSpeed=-1;$(this).each(function(){var c=$(this),p=$(c).offset(),e=$("#"+a.menu);e.addClass("contextMenu");$(this).bind("mousedown",function(h){$(this).on("mouseup",function(o){var u=$(this);u.unbind("mouseup");$(".contextMenu").hide();if(h.button===2||
a.allowLeft||h.ctrlKey&&svgedit.browser.isMac())svgedit.browser.isTouch()||k(o,h,u)})});svgedit.browser.isTouch()&&$(this).bind("taphold",function(h){var o=$(this);o.unbind("mouseup");k(h,h,o)});var k=function(h,o,u){if(typeof o=="undefined")o=h;h.stopPropagation();if(c.hasClass("disabled")||o.altKey)return false;var B=h.pageX,s=h.pageY;if(svgedit.browser.isTouch()){B=h.originalEvent.touches[0].pageX;s=h.originalEvent.touches[0].pageY}h=b.width()-e.width();o=b.height()-e.height();if(B>h-15)B=h-15;
if(s>o-30)s=o-30;if(svgedit.browser.isTouch())s-=e.height()/2;n.unbind("click");e.css({top:s,left:B}).fadeIn(a.inSpeed);e.find("A").mouseover(function(){e.find("LI.hover").removeClass("hover");$(this).parent().addClass("hover")}).mouseout(function(){e.find("LI.hover").removeClass("hover")});n.keypress(function(K){switch(K.keyCode){case 38:if(e.find("LI.hover").length){e.find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover");e.find("LI.hover").length||e.find("LI:last").addClass("hover")}else e.find("LI:last").addClass("hover");
break;case 40:if(e.find("LI.hover").length==0)e.find("LI:first").addClass("hover");else{e.find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover");e.find("LI.hover").length||e.find("LI:first").addClass("hover")}break;case 13:e.find("LI.hover A").trigger("click");break;case 27:n.trigger("click")}});e.find("A").unbind("mouseup");e.find("LI:not(.disabled) A").mouseup(function(){n.unbind("click").unbind("keypress");$(".contextMenu").hide();d&&d($(this).attr("href").substr(1),
$(u),{x:B-p.left,y:s-p.top,docX:B,docY:s});return false});setTimeout(function(){n.click(function(){n.unbind("click").unbind("keypress");e.fadeOut(a.outSpeed);return false})},0)};$(c).add($("UL.contextMenu")).bind("contextmenu",function(){return false})});return $(this)},disableContextMenuItems:function(a){if(a==undefined){$(this).find("LI").addClass("disabled");return $(this)}$(this).each(function(){if(a!=undefined)for(var d=a.split(","),c=0;c<d.length;c++)$(this).find('A[href="'+d[c]+'"]').parent().addClass("disabled")});
return $(this)},enableContextMenuItems:function(a){if(a==undefined){$(this).find("LI.disabled").removeClass("disabled");return $(this)}$(this).each(function(){if(a!=undefined)for(var d=a.split(","),c=0;c<d.length;c++)$(this).find('A[href="'+d[c]+'"]').parent().removeClass("disabled")});return $(this)},disableContextMenu:function(){$(this).each(function(){$(this).addClass("disabled")});return $(this)},enableContextMenu:function(){$(this).each(function(){$(this).removeClass("disabled")});return $(this)},
destroyContextMenu:function(){$(this).each(function(){$(this).unbind("mousedown").unbind("mouseup")});return $(this)}})}(jQuery);var svgedit=svgedit||{};
(function(){if(!svgedit.browser)svgedit.browser={};var b=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;svgedit.browser.supportsSvg=function(){return b};if(svgedit.browser.supportsSvg()){var n=navigator.userAgent,a=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=!!window.opera,c=n.indexOf("AppleWebKit")>=0,p=n.indexOf("Gecko/")>=0,e=n.indexOf("MSIE")>=0,k=n.indexOf("Chrome/")>=0,h=n.indexOf("Windows")>=0,o=n.indexOf("Macintosh")>=
0,u="ontouchstart"in window,B=!!a.querySelector,s=!!document.evaluate,K=function(){var ca=document.createElementNS("http://www.w3.org/2000/svg","svg"),ma=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(ca);ma.setAttribute("x",5);ca.appendChild(ma);var ia=document.createElementNS("http://www.w3.org/2000/svg","text");ia.textContent="a";ma.appendChild(ia);ma=ia.getStartPositionOfChar(0);ma=ma.x;document.documentElement.removeChild(ca);return ma===0}(),
P=function(){var ca=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(ca);var ma=document.createElementNS("http://www.w3.org/2000/svg","path");ma.setAttribute("d","M0,0 C0,0 10,10 10,0");ca.appendChild(ma);ma=ma.getBBox();document.documentElement.removeChild(ca);return ma.height>4&&ma.height<5}(),M=function(){var ca=document.createElementNS("http://www.w3.org/2000/svg","svg");document.documentElement.appendChild(ca);var ma=document.createElementNS("http://www.w3.org/2000/svg",
"path");ma.setAttribute("d","M0,0 10,0");var ia=document.createElementNS("http://www.w3.org/2000/svg","path");ia.setAttribute("d","M5,0 15,0");var Z=document.createElementNS("http://www.w3.org/2000/svg","g");Z.appendChild(ma);Z.appendChild(ia);ca.appendChild(Z);ma=Z.getBBox();document.documentElement.removeChild(ca);return ma.width==15}(),I=function(){var ca=document.createElementNS("http://www.w3.org/2000/svg","rect");ca.setAttribute("x",0.1);(ca=ca.cloneNode(false).getAttribute("x").indexOf(",")==
-1)||$.alert("NOTE: This version of Opera is known to contain bugs in SVG-edit.\n    Please upgrade to the <a href='http://opera.com'>latest version</a> in which the problems have been fixed.");return ca}(),R=function(){var ca=document.createElementNS("http://www.w3.org/2000/svg","rect");ca.setAttribute("style","vector-effect:non-scaling-stroke");return ca.style.vectorEffect==="non-scaling-stroke"}(),T=function(){var ca=document.createElementNS("http://www.w3.org/2000/svg","rect").transform.baseVal,
ma=a.createSVGTransform();ca.appendItem(ma);return ca.getItem(0)==ma}(),O=function(){if(typeof Blob!="function")return false;var ca=new Blob(["<svg xmlns='http://www.w3.org/2000/svg'></svg>"],{type:"image/svg+xml;charset=utf-8"}),ma=new Image;ma.onload=function(){svgedit.browser.supportsBlobs=function(){return true}};ma.onerror=function(){svgedit.browser.supportsBlobs=function(){return false}};ma.src=URL.createObjectURL(ca);return false}();svgedit.browser.isOpera=function(){return d};svgedit.browser.isWebkit=
function(){return c};svgedit.browser.isGecko=function(){return p};svgedit.browser.isIE=function(){return e};svgedit.browser.isChrome=function(){return k};svgedit.browser.isWindows=function(){return h};svgedit.browser.isMac=function(){return o};svgedit.browser.isTouch=function(){return u};svgedit.browser.supportsSelectors=function(){return B};svgedit.browser.supportsXpath=function(){return s};svgedit.browser.supportsPathBBox=function(){return P};svgedit.browser.supportsHVLineContainerBBox=function(){return M};
svgedit.browser.supportsGoodTextCharPos=function(){return K};svgedit.browser.supportsEditableText=function(){return d};svgedit.browser.supportsGoodDecimals=function(){return I};svgedit.browser.supportsNonScalingStroke=function(){return R};svgedit.browser.supportsNativeTransformLists=function(){return T};svgedit.browser.supportsBlobs=function(){return O}}else window.location="browser-not-supported.html"})();svgedit=svgedit||{};
(function(){if(!svgedit.transformlist)svgedit.transformlist={};var b=document.createElementNS("http://www.w3.org/2000/svg","svg"),n={};svgedit.transformlist.SVGTransformList=function(a){this._elem=a||null;this._xforms=[];this._update=function(){var d="";b.createSVGMatrix();for(var c=0;c<this.numberOfItems;++c){var p=this._list.getItem(c);d=d;p=p;var e=p.matrix,k="";switch(p.type){case 1:k="matrix("+[e.a,e.b,e.c,e.d,e.e,e.f].join(",")+")";break;case 2:k="translate("+e.e+","+e.f+")";break;case 3:k=
e.a==e.d?"scale("+e.a+")":"scale("+e.a+","+e.d+")";break;case 4:var h=0;k=0;if(p.angle!=0){h=1-e.a;k=(h*e.f+e.b*e.e)/(h*h+e.b*e.b);h=(e.e-e.b*k)/h}k="rotate("+p.angle+" "+h+","+k+")"}d=d+(k+" ")}this._elem.setAttribute("transform",d)};this._list=this;this._init=function(){var d=this._elem.getAttribute("transform");if(d)for(var c=/\s*((scale|matrix|rotate|translate)\s*\(.*?\))\s*,?\s*/,p=true;p;){p=d.match(c);d=d.replace(c,"");if(p&&p[1]){var e=p[1].split(/\s*\(/),k=e[0];e=e[1].match(/\s*(.*?)\s*\)/);
e[1]=e[1].replace(/(\d)-/g,"$1 -");var h=e[1].split(/[, ]+/),o="abcdef".split(""),u=b.createSVGMatrix();$.each(h,function(K,P){h[K]=parseFloat(P);if(k=="matrix")u[o[K]]=h[K]});e=b.createSVGTransform();var B="set"+k.charAt(0).toUpperCase()+k.slice(1),s=k=="matrix"?[u]:h;if(k=="scale"&&s.length==1)s.push(s[0]);else if(k=="translate"&&s.length==1)s.push(0);else if(k=="rotate"&&s.length==1){s.push(0);s.push(0)}e[B].apply(e,s);this._list.appendItem(e)}}};this._removeFromOtherLists=function(d){if(d){var c=
false,p;for(p in n){for(var e=n[p],k=0,h=e._xforms.length;k<h;++k)if(e._xforms[k]==d){c=true;e.removeItem(k);break}if(c)break}}};this.numberOfItems=0;this.clear=function(){this.numberOfItems=0;this._xforms=[]};this.initialize=function(d){this.numberOfItems=1;this._removeFromOtherLists(d);this._xforms=[d]};this.getItem=function(d){if(d<this.numberOfItems&&d>=0)return this._xforms[d];throw{code:1};};this.insertItemBefore=function(d,c){var p=null;if(c>=0)if(c<this.numberOfItems){this._removeFromOtherLists(d);
p=Array(this.numberOfItems+1);for(var e=0;e<c;++e)p[e]=this._xforms[e];p[e]=d;for(var k=e+1;e<this.numberOfItems;++k,++e)p[k]=this._xforms[e];this.numberOfItems++;this._xforms=p;p=d;this._list._update()}else p=this._list.appendItem(d);return p};this.replaceItem=function(d,c){var p=null;if(c<this.numberOfItems&&c>=0){this._removeFromOtherLists(d);p=this._xforms[c]=d;this._list._update()}return p};this.removeItem=function(d){if(d<this.numberOfItems&&d>=0){for(var c=this._xforms[d],p=Array(this.numberOfItems-
1),e=0;e<d;++e)p[e]=this._xforms[e];for(d=e;d<this.numberOfItems-1;++d,++e)p[d]=this._xforms[e+1];this.numberOfItems--;this._xforms=p;this._list._update();return c}else throw{code:1};};this.appendItem=function(d){this._removeFromOtherLists(d);this._xforms.push(d);this.numberOfItems++;this._list._update();return d}};svgedit.transformlist.resetListMap=function(){n={}};svgedit.transformlist.removeElementFromListMap=function(a){a.id&&n[a.id]&&delete n[a.id]};svgedit.transformlist.getTransformList=function(a){if(svgedit.browser.supportsNativeTransformLists())if(a.transform)return a.transform.baseVal;
else if(a.gradientTransform)return a.gradientTransform.baseVal;else{if(a.patternTransform)return a.patternTransform.baseVal}else{var d=a.id;d||(d="temp");var c=n[d];if(!c||d=="temp"){n[d]=new svgedit.transformlist.SVGTransformList(a);n[d]._init();c=n[d]}return c}return null}})();svgedit=svgedit||{};
(function(){if(!svgedit.math)svgedit.math={};var b=document.createElementNS("http://www.w3.org/2000/svg","svg");svgedit.math.transformPoint=function(n,a,d){return{x:d.a*n+d.c*a+d.e,y:d.b*n+d.d*a+d.f}};svgedit.math.isIdentity=function(n){return n.a===1&&n.b===0&&n.c===0&&n.d===1&&n.e===0&&n.f===0};svgedit.math.matrixMultiply=function(){for(var n=arguments,a=n.length,d=n[a-1];a-- >1;)d=n[a-1].multiply(d);if(Math.abs(d.a)<1.0E-14)d.a=0;if(Math.abs(d.b)<1.0E-14)d.b=0;if(Math.abs(d.c)<1.0E-14)d.c=0;if(Math.abs(d.d)<
1.0E-14)d.d=0;if(Math.abs(d.e)<1.0E-14)d.e=0;if(Math.abs(d.f)<1.0E-14)d.f=0;return d};svgedit.math.hasMatrixTransform=function(n){if(!n)return false;for(var a=n.numberOfItems;a--;){var d=n.getItem(a);if(d.type==1&&!svgedit.math.isIdentity(d.matrix))return true}return false};svgedit.math.transformBox=function(n,a,d,c,p){var e={x:n,y:a},k={x:n+d,y:a};d={x:n+d,y:a+c};n={x:n,y:a+c};a=svgedit.math.transformPoint;e=a(e.x,e.y,p);var h=c=e.x,o=e.y,u=e.y;k=a(k.x,k.y,p);c=Math.min(c,k.x);h=Math.max(h,k.x);
o=Math.min(o,k.y);u=Math.max(u,k.y);n=a(n.x,n.y,p);c=Math.min(c,n.x);h=Math.max(h,n.x);o=Math.min(o,n.y);u=Math.max(u,n.y);d=a(d.x,d.y,p);c=Math.min(c,d.x);h=Math.max(h,d.x);o=Math.min(o,d.y);u=Math.max(u,d.y);return{tl:e,tr:k,bl:n,br:d,aabox:{x:c,y:o,width:h-c,height:u-o}}};svgedit.math.transformListToTransform=function(n,a,d){if(n==null)return b.createSVGTransformFromMatrix(b.createSVGMatrix());a=a==undefined?0:a;d=d==undefined?n.numberOfItems-1:d;a=parseInt(a);d=parseInt(d);if(a>d){var c=d;d=a;
a=c}c=b.createSVGMatrix();for(a=a;a<=d;++a){var p=a>=0&&a<n.numberOfItems?n.getItem(a).matrix:b.createSVGMatrix();c=svgedit.math.matrixMultiply(c,p)}return b.createSVGTransformFromMatrix(c)};svgedit.math.getMatrix=function(n){n=svgedit.transformlist.getTransformList(n);return svgedit.math.transformListToTransform(n).matrix};svgedit.math.snapToAngle=function(n,a,d,c){var p=Math.PI/4;d=d-n;var e=c-a;c=Math.sqrt(d*d+e*e);p=Math.round(Math.atan2(e,d)/p)*p;return{x:n+c*Math.cos(p),y:a+c*Math.sin(p),a:p}};
svgedit.math.rectsIntersect=function(n,a){if(!n||!a)return false;return a.x<n.x+n.width&&a.x+a.width>n.x&&a.y<n.y+n.height&&a.y+a.height>n.y}})();svgedit=svgedit||{};
(function(){if(!svgedit.units)svgedit.units={};var b=["x","x1","cx","rx","width"],n=["y","y1","cy","ry","height"],a=$.merge(["r","radius"],b);$.merge(a,n);var d,c={px:1};svgedit.units.init=function(e){d=e;e=document.createElementNS("http://www.w3.org/2000/svg","svg");document.body.appendChild(e);var k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttribute("width","1em");k.setAttribute("height","1ex");k.setAttribute("x","1in");e.appendChild(k);k=k.getBBox();document.body.removeChild(e);
e=k.x;c.em=k.width;c.ex=k.height;c["in"]=e;c.cm=e/2.54;c.mm=e/25.4;c.pt=e/72;c.pc=e/6;c["%"]=0};svgedit.units.getTypeMap=function(){return c};svgedit.units.shortFloat=function(e){var k=d.getRoundDigits();if(isNaN(e)){if($.isArray(e))return svgedit.units.shortFloat(e[0])+","+svgedit.units.shortFloat(e[1])}else return+(+e).toFixed(k);return parseFloat(e).toFixed(k)-0};svgedit.units.convertUnit=function(e,k){k=k||d.getBaseUnit();return svgedit.unit.shortFloat(e/c[k])};svgedit.units.setUnitAttr=function(e,
k,h){isNaN(h)||e.getAttribute(k);e.setAttribute(k,h)};var p={line:["x1","x2","y1","y2"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],foreignObject:["x","y","width","height"],rect:["x","y","width","height"],image:["x","y","width","height"],use:["x","y","width","height"],text:["x","y"]};svgedit.units.convertAttrs=function(e){var k=e.tagName,h=d.getBaseUnit();if(k=p[k])for(var o=k.length,u=0;u<o;u++){var B=k[u],s=e.getAttribute(B);if(s)isNaN(s)||e.setAttribute(B,s/c[h]+h)}};svgedit.units.convertToNum=
function(e,k){if(!isNaN(k))return k-0;if(k.substr(-1)==="%"){var h=k.substr(0,k.length-1)/100,o=d.getWidth(),u=d.getHeight();return b.indexOf(e)>=0?h*o:n.indexOf(e)>=0?h*u:h*Math.sqrt(o*o+u*u)/Math.sqrt(2)}else{o=k.substr(-2);h=k.substr(0,k.length-2);return h*c[o]}};svgedit.units.isValidUnit=function(e,k,h){var o=false;if(a.indexOf(e)>=0)if(isNaN(k)){k=k.toLowerCase();$.each(c,function(s){if(!o)if(RegExp("^-?[\\d\\.]+"+s+"$").test(k))o=true})}else o=true;else if(e=="id"){e=false;try{var u=d.getElement(k);
e=u==null||u===h}catch(B){}return e}else o=true;return o}})();svgedit=svgedit||{};
(function(){function b(e){if(svgedit.browser.supportsHVLineContainerBBox())try{return e.getBBox()}catch(k){}var h=$.data(e,"ref"),o=null;if(h){var u=$(h).children().clone().attr("visibility","hidden");$(p).append(u);o=u.filter("line, path")}else o=$(e).find("line, path");var B=false;if(o.length){o.each(function(){var s=this.getBBox();if(!s.width||!s.height)B=true});if(B){e=h?u:$(e).children();ret=getStrokedBBox(e)}else ret=e.getBBox()}else ret=e.getBBox();h&&u.remove();return ret}if(!svgedit.utilities)svgedit.utilities=
{};var n="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),a=null,d=null,c=null,p=null;svgedit.utilities.init=function(e){a=e;d=e.getDOMDocument();c=e.getDOMContainer();p=e.getSVGRoot()};svgedit.utilities.toXml=function(e){return $("<p/>").text(e).html()};svgedit.utilities.fromXml=function(e){return $("<p/>").html(e).text()};svgedit.utilities.encode64=function(e){e=svgedit.utilities.convertToXMLReferences(e);if(window.btoa)return window.btoa(e);
var k=Array(Math.floor((e.length+2)/3)*4),h,o,u,B,s,K,P=0,M=0;do{h=e.charCodeAt(P++);o=e.charCodeAt(P++);u=e.charCodeAt(P++);B=h>>2;h=(h&3)<<4|o>>4;s=(o&15)<<2|u>>6;K=u&63;if(isNaN(o))s=K=64;else if(isNaN(u))K=64;k[M++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(B);k[M++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h);k[M++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(s);k[M++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(K)}while(P<
e.length);return k.join("")};svgedit.utilities.decode64=function(e){if(window.atob)return window.atob(e);var k="",h,o,u="",B,s="",K=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(K++));o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(K++));B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(K++));s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e.charAt(K++));
h=h<<2|o>>4;o=(o&15)<<4|B>>2;u=(B&3)<<6|s;k+=String.fromCharCode(h);if(B!=64)k+=String.fromCharCode(o);if(s!=64)k+=String.fromCharCode(u)}while(K<e.length);return unescape(k)};svgedit.utilities.convertToXMLReferences=function(e){for(var k="",h=0;h<e.length;h++){var o=e.charCodeAt(h);if(o<128)k+=e[h];else if(o>127)k+="&#"+o+";"}return k};svgedit.utilities.text2xml=function(e){if(e.indexOf("<svg:svg")>=0)e=e.replace(/<(\/?)svg:/g,"<$1").replace("xmlns:svg","xmlns");var k;try{var h=window.DOMParser?
new DOMParser:new ActiveXObject("Microsoft.XMLDOM");h.async=false}catch(o){throw Error("XML Parser could not be instantiated");}try{k=h.loadXML?h.loadXML(e)?h:false:h.parseFromString(e,"text/xml")}catch(u){throw Error("Error parsing XML string");}return k};svgedit.utilities.bboxToObj=function(e){return{x:e.x,y:e.y,width:e.width,height:e.height}};svgedit.utilities.walkTree=function(e,k){if(e&&e.nodeType==1){k(e);for(var h=e.childNodes.length;h--;)svgedit.utilities.walkTree(e.childNodes.item(h),k)}};
svgedit.utilities.walkTreePost=function(e,k){if(e&&e.nodeType==1){for(var h=e.childNodes.length;h--;)svgedit.utilities.walkTree(e.childNodes.item(h),k);k(e)}};svgedit.utilities.getUrlFromAttr=function(e){if(e)if(e.indexOf('url("')===0)return e.substring(5,e.indexOf('"',6));else if(e.indexOf("url('")===0)return e.substring(5,e.indexOf("'",6));else if(e.indexOf("url(")===0)return e.substring(4,e.indexOf(")"));return null};svgedit.utilities.getHref=function(e){if(e)return e.getAttributeNS("http://www.w3.org/1999/xlink",
"href")};svgedit.utilities.setHref=function(e,k){e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",k)};svgedit.utilities.findDefs=function(e){e=a.getSVGContent().documentElement;var k=e.getElementsByTagNameNS("http://www.w3.org/2000/svg","defs");return k=k.length>0?k[0]:e.insertBefore(e.ownerDocument.createElementNS("http://www.w3.org/2000/svg","defs"),e.firstChild.nextSibling)};svgedit.utilities.getPathBBox=function(e){var k=e.pathSegList,h=k.numberOfItems;e=[[],[]];var o=k.getItem(0),
u=[o.x,o.y];for(o=0;o<h;o++){var B=k.getItem(o);if(typeof B.x!="undefined"){e[0].push(u[0]);e[1].push(u[1]);if(B.x1){for(var s=[B.x1,B.y1],K=[B.x2,B.y2],P=[B.x,B.y],M=0;M<2;M++){B=function(ca){return Math.pow(1-ca,3)*u[M]+3*Math.pow(1-ca,2)*ca*s[M]+3*(1-ca)*Math.pow(ca,2)*K[M]+Math.pow(ca,3)*P[M]};var I=6*u[M]-12*s[M]+6*K[M],R=-3*u[M]+9*s[M]-9*K[M]+3*P[M],T=3*s[M]-3*u[M];if(R==0){if(I!=0){I=-T/I;0<I&&I<1&&e[M].push(B(I))}}else{T=Math.pow(I,2)-4*T*R;if(!(T<0)){var O=(-I+Math.sqrt(T))/(2*R);0<O&&O<
1&&e[M].push(B(O));I=(-I-Math.sqrt(T))/(2*R);0<I&&I<1&&e[M].push(B(I))}}}u=P}else{e[0].push(B.x);e[1].push(B.y)}}}k=Math.min.apply(null,e[0]);h=Math.max.apply(null,e[0])-k;o=Math.min.apply(null,e[1]);e=Math.max.apply(null,e[1])-o;return{x:k,y:o,width:h,height:e}};svgedit.utilities.getBBox=function(e){var k=e||a.getSelectedElements()[0];if(e.nodeType!=1)return null;e=null;var h=k.nodeName;switch(h){case "text":if(k.textContent===""){k.textContent="a";e=k.getBBox();k.textContent=""}else try{e=k.getBBox()}catch(o){}break;
case "path":if(svgedit.browser.supportsPathBBox())try{e=k.getBBox()}catch(u){}else e=svgedit.utilities.getPathBBox(k);break;case "g":case "a":e=b(k);break;default:if(h==="use")e=b(k,true);if(h==="use")e||(e=k.getBBox());else if(~n.indexOf(h))try{e=k.getBBox()}catch(B){k=$(k).closest("foreignObject");if(k.length)try{e=k[0].getBBox()}catch(s){e=null}else e=null}}if(e)e=svgedit.utilities.bboxToObj(e);return e};svgedit.utilities.getRotationAngle=function(e,k){var h=e||a.getSelectedElements()[0];h=svgedit.transformlist.getTransformList(h);
if(!h)return 0;for(var o=h.numberOfItems,u=0;u<o;++u){var B=h.getItem(u);if(B.type==4)return k?B.angle*Math.PI/180:B.angle}return 0};svgedit.utilities.getElem=svgedit.browser.supportsSelectors()?function(e){return p.querySelector("#"+e)}:svgedit.browser.supportsXpath()?function(e){return d.evaluate('svg:svg[@id="svgroot"]//svg:*[@id="'+e+'"]',c,function(){return"http://www.w3.org/2000/svg"},9,null).singleNodeValue}:function(e){return $(p).find("[id="+e+"]")[0]};svgedit.utilities.assignAttributes=
function(e,k,h,o){for(var u in k)if(h=u.substr(0,4)==="xml:"?"http://www.w3.org/XML/1998/namespace":u.substr(0,6)==="xlink:"?"http://www.w3.org/1999/xlink":null)e.setAttributeNS(h,u,k[u]);else o?svgedit.units.setUnitAttr(e,u,k[u]):e.setAttribute(u,k[u])};svgedit.utilities.cleanupElement=function(e){var k={"fill-opacity":1,"stop-opacity":1,opacity:1,stroke:"none","stroke-dasharray":"none","stroke-linejoin":"miter","stroke-linecap":"butt","stroke-opacity":1,"stroke-width":1,rx:0,ry:0},h;for(h in k){var o=
k[h];e.getAttribute(h)==o&&e.removeAttribute(h)}}})();svgedit=svgedit||{};
(function(){if(!svgedit.sanitize)svgedit.sanitize={};var b={};b["http://www.w3.org/1999/xlink"]="xlink";b["http://www.w3.org/XML/1998/namespace"]="xml";b["http://www.w3.org/2000/xmlns/"]="xmlns";b["http://svg-edit.googlecode.com"]="se";b["http://www.w3.org/1999/xhtml"]="xhtml";b["http://www.w3.org/1998/Math/MathML"]="mathml";var n={};$.each(b,function(c,p){n[p]=c});var a={a:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","mask","opacity","stroke","stroke-dasharray",
"stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","xlink:href","xlink:title"],circle:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","r","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],clipPath:["class",
"clipPathUnits","id"],defs:[],style:["type"],desc:[],ellipse:["class","clip-path","clip-rule","cx","cy","fill","fill-opacity","fill-rule","filter","id","mask","opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],feGaussianBlur:["class","color-interpolation-filters","id","requiredFeatures","stdDeviation"],filter:["class","color-interpolation-filters",
"filterRes","filterUnits","height","id","primitiveUnits","requiredFeatures","width","x","xlink:href","y"],foreignObject:["class","font-size","height","id","opacity","requiredFeatures","style","transform","width","x","y"],g:["class","clip-path","clip-rule","id","display","fill","fill-opacity","fill-rule","filter","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage",
"transform","font-family","font-size","font-style","font-weight","text-anchor","data-locked"],image:["class","clip-path","clip-rule","filter","height","id","mask","opacity","requiredFeatures","style","systemLanguage","transform","width","x","xlink:href","xlink:title","y"],line:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","x1","x2","y1","y2"],linearGradient:["class","id","gradientTransform","gradientUnits","requiredFeatures","spreadMethod","systemLanguage","x1","x2","xlink:href","y1","y2"],marker:["id","class","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","systemLanguage","viewBox"],mask:["class","height","id","maskContentUnits","maskUnits","width","x",
"y"],metadata:["class","id"],path:["class","clip-path","clip-rule","d","fill","fill-opacity","fill-rule","filter","id","marker-end","marker-mid","marker-start","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],pattern:["class","height","id","patternContentUnits","patternTransform","patternUnits","requiredFeatures","style","systemLanguage","viewBox",
"width","x","xlink:href","y"],polygon:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","id","class","marker-end","marker-mid","marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],polyline:["class","clip-path","clip-rule","id","fill","fill-opacity","fill-rule","filter","marker-end","marker-mid",
"marker-start","mask","opacity","points","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform"],radialGradient:["class","cx","cy","fx","fy","gradientTransform","gradientUnits","id","r","requiredFeatures","spreadMethod","systemLanguage","xlink:href"],rect:["shape-rendering","class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask",
"opacity","requiredFeatures","rx","ry","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","width","x","y"],stop:["class","id","offset","requiredFeatures","stop-color","stop-opacity","style","systemLanguage"],svg:["class","clip-path","clip-rule","filter","id","height","mask","preserveAspectRatio","requiredFeatures","style","systemLanguage","viewBox","width","x","xmlns","xmlns:se",
"xmlns:xlink","y"],"switch":["class","id","requiredFeatures","systemLanguage"],symbol:["class","fill","fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","opacity","preserveAspectRatio","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","transform","viewBox"],text:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule",
"filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","transform","x","xml:space","y"],textPath:["class","id","method","requiredFeatures","spacing","startOffset","style","systemLanguage","transform","xlink:href"],title:[],tspan:["class","clip-path","clip-rule","dx","dy","fill",
"fill-opacity","fill-rule","filter","font-family","font-size","font-style","font-weight","id","mask","opacity","requiredFeatures","rotate","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","systemLanguage","text-anchor","textLength","transform","x","xml:space","y"],use:["class","clip-path","clip-rule","fill","fill-opacity","fill-rule","filter","height","id","mask","stroke","stroke-dasharray","stroke-dashoffset",
"stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","style","transform","width","x","xlink:href","y"],annotation:["encoding"],"annotation-xml":["encoding"],maction:["actiontype","other","selection"],math:["class","id","display","xmlns"],menclose:["notation"],merror:[],mfrac:["linethickness"],mi:["mathvariant"],mmultiscripts:[],mn:[],mo:["fence","lspace","maxsize","minsize","rspace","stretchy"],mover:[],mpadded:["lspace","width","height","depth","voffset"],mphantom:[],
mprescripts:[],mroot:[],mrow:["xlink:href","xlink:type","xmlns:xlink"],mspace:["depth","height","width"],msqrt:[],mstyle:["displaystyle","mathbackground","mathcolor","mathvariant","scriptlevel"],msub:[],msubsup:[],msup:[],mtable:["align","columnalign","columnlines","columnspacing","displaystyle","equalcolumns","equalrows","frame","rowalign","rowlines","rowspacing","width"],mtd:["columnalign","columnspan","rowalign","rowspan"],mtext:[],mtr:["columnalign","rowalign"],munder:[],munderover:[],none:[],
semantics:[]},d={};$.each(a,function(c,p){var e={};$.each(p,function(k,h){if(h.indexOf(":")>=0){var o=h.split(":");e[o[1]]=n[o[0]]}else e[h]=h=="xmlns"?"http://www.w3.org/2000/xmlns/":null});d[c]=e});svgedit.sanitize.getNSMap=function(){return b};svgedit.sanitize.sanitizeSvg=function(c){if(c.nodeType==3){c.nodeValue=c.nodeValue.replace(/^\s+|\s+$/g,"");c.nodeValue.length||c.parentNode.removeChild(c)}if(c.nodeType==1){var p=c.parentNode;if(c.ownerDocument&&p){var e=a[c.nodeName],k=d[c.nodeName];if(e!=
undefined){for(var h=[],o=c.attributes.length;o--;){var u=c.attributes.item(o),B=u.nodeName,s=u.localName,K=u.namespaceURI;if(!(k.hasOwnProperty(s)&&K==k[s]&&K!="http://www.w3.org/2000/xmlns/")&&!(K=="http://www.w3.org/2000/xmlns/"&&b[u.nodeValue])){B.indexOf("se:")==0&&h.push([B,u.nodeValue]);c.removeAttributeNS(K,s)}if(svgedit.browser.isGecko())switch(B){case "transform":case "gradientTransform":case "patternTransform":s=u.nodeValue.replace(/(\d)-/g,"$1 -");c.setAttribute(B,s)}if(B=="style"){u=
u.nodeValue.split(";");for(B=u.length;B--;){s=u[B].split(":");e.indexOf(s[0])>=0&&c.setAttribute(s[0],s[1])}c.removeAttribute("style")}}$.each(h,function(P,M){c.setAttributeNS("http://svg-edit.googlecode.com",M[0],M[1])});if((o=svgedit.utilities.getHref(c))&&["filter","linearGradient","pattern","radialGradient","textPath","use"].indexOf(c.nodeName)>=0)if(o[0]!="#"){svgedit.utilities.setHref(c,"");c.removeAttributeNS("http://www.w3.org/1999/xlink","href")}if(c.nodeName=="use"&&!svgedit.utilities.getHref(c))p.removeChild(c);
else{$.each(["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],function(P,M){var I=c.getAttribute(M);if(I)if((I=svgedit.utilities.getUrlFromAttr(I))&&I[0]!=="#"){c.setAttribute(M,"");c.removeAttribute(M)}});for(o=c.childNodes.length;o--;)svgedit.sanitize.sanitizeSvg(c.childNodes.item(o))}}else{for(e=[];c.hasChildNodes();)e.push(p.insertBefore(c.firstChild,c));p.removeChild(c);for(o=e.length;o--;)svgedit.sanitize.sanitizeSvg(e[o])}}}}})();svgedit=svgedit||{};
(function(){if(!svgedit.history)svgedit.history={};svgedit.history.HistoryEventTypes={BEFORE_APPLY:"before_apply",AFTER_APPLY:"after_apply",BEFORE_UNAPPLY:"before_unapply",AFTER_UNAPPLY:"after_unapply"};svgedit.history.MoveElementCommand=function(b,n,a,d){this.elem=b;this.text=d?"Move "+b.tagName+" to "+d:"Move "+b.tagName;this.oldNextSibling=n;this.oldParent=a;this.newNextSibling=b.nextSibling;this.newParent=b.parentNode};svgedit.history.MoveElementCommand.type=function(){return"svgedit.history.MoveElementCommand"};svgedit.history.MoveElementCommand.prototype.type=
svgedit.history.MoveElementCommand.type;svgedit.history.MoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.MoveElementCommand.prototype.apply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.newParent.insertBefore(this.elem,this.newNextSibling);b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.MoveElementCommand.prototype.unapply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.elem=this.oldParent.insertBefore(this.elem,this.oldNextSibling);b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.MoveElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.InsertElementCommand=function(b,n){this.elem=b;this.text=n||"Create "+b.tagName;this.parent=b.parentNode;this.nextSibling=this.elem.nextSibling};svgedit.history.InsertElementCommand.type=function(){return"svgedit.history.InsertElementCommand"};svgedit.history.InsertElementCommand.prototype.type=
svgedit.history.InsertElementCommand.type;svgedit.history.InsertElementCommand.prototype.getText=function(){return this.text};svgedit.history.InsertElementCommand.prototype.apply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);this.elem=this.parent.insertBefore(this.elem,this.nextSibling);b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.InsertElementCommand.prototype.unapply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,
this);this.parent=this.elem.parentNode;this.elem=this.elem.parentNode.removeChild(this.elem);b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.InsertElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.RemoveElementCommand=function(b,n,a,d){this.elem=b;this.text=d||"Delete "+b.tagName;this.nextSibling=n;this.parent=a;svgedit.transformlist.removeElementFromListMap(b)};svgedit.history.RemoveElementCommand.type=function(){return"svgedit.history.RemoveElementCommand"};
svgedit.history.RemoveElementCommand.prototype.type=svgedit.history.RemoveElementCommand.type;svgedit.history.RemoveElementCommand.prototype.getText=function(){return this.text};svgedit.history.RemoveElementCommand.prototype.apply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.parent=this.elem.parentNode;this.elem=this.parent.removeChild(this.elem);b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,
this)};svgedit.history.RemoveElementCommand.prototype.unapply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);svgedit.transformlist.removeElementFromListMap(this.elem);this.nextSibling==null&&window.console&&console.log("Error: reference element was lost");this.parent.insertBefore(this.elem,this.nextSibling);b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this)};svgedit.history.RemoveElementCommand.prototype.elements=function(){return[this.elem]};
svgedit.history.ChangeElementCommand=function(b,n,a){this.elem=b;this.text=a?"Change "+b.tagName+" "+a:"Change "+b.tagName;this.newValues={};this.oldValues=n;for(var d in n)this.newValues[d]=d=="#text"?b.textContent:d=="#href"?svgedit.utilities.getHref(b):b.getAttribute(d)};svgedit.history.ChangeElementCommand.type=function(){return"svgedit.history.ChangeElementCommand"};svgedit.history.ChangeElementCommand.prototype.type=svgedit.history.ChangeElementCommand.type;svgedit.history.ChangeElementCommand.prototype.getText=
function(){return this.text};svgedit.history.ChangeElementCommand.prototype.apply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);var n=false,a;for(a in this.newValues){if(this.newValues[a])if(a=="#text")this.elem.textContent=this.newValues[a];else a=="#href"?svgedit.utilities.setHref(this.elem,this.newValues[a]):this.elem.setAttribute(a,this.newValues[a]);else if(a=="#text")this.elem.textContent="";else{this.elem.setAttribute(a,"");this.elem.removeAttribute(a)}if(a==
"transform")n=true}if(!n)if(n=svgedit.utilities.getRotationAngle(this.elem)){a=elem.getBBox();n=["rotate(",n," ",a.x+a.width/2,",",a.y+a.height/2,")"].join("");n!=elem.getAttribute("transform")&&elem.setAttribute("transform",n)}b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.unapply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);var n=false,a;for(a in this.oldValues){if(this.oldValues[a])if(a==
"#text")this.elem.textContent=this.oldValues[a];else a=="#href"?svgedit.utilities.setHref(this.elem,this.oldValues[a]):this.elem.setAttribute(a,this.oldValues[a]);else if(a=="#text")this.elem.textContent="";else this.elem.removeAttribute(a);if(a=="transform")n=true}if(!n)if(n=svgedit.utilities.getRotationAngle(this.elem)){a=this.elem.getBBox();n=["rotate(",n," ",a.x+a.width/2,",",a.y+a.height/2,")"].join("");n!=this.elem.getAttribute("transform")&&this.elem.setAttribute("transform",n)}svgedit.transformlist.removeElementFromListMap(this.elem);
b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,this);return true};svgedit.history.ChangeElementCommand.prototype.elements=function(){return[this.elem]};svgedit.history.BatchCommand=function(b){this.text=b||"Batch Command";this.stack=[]};svgedit.history.BatchCommand.type=function(){return"svgedit.history.BatchCommand"};svgedit.history.BatchCommand.prototype.type=svgedit.history.BatchCommand.type;svgedit.history.BatchCommand.prototype.getText=function(){return this.text};svgedit.history.BatchCommand.prototype.apply=
function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_APPLY,this);for(var n=this.stack.length,a=0;a<n;++a)this.stack[a].apply(b);b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_APPLY,this)};svgedit.history.BatchCommand.prototype.unapply=function(b){b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.BEFORE_UNAPPLY,this);for(var n=this.stack.length-1;n>=0;n--)this.stack[n].unapply(b);b&&b.handleHistoryEvent(svgedit.history.HistoryEventTypes.AFTER_UNAPPLY,
this)};svgedit.history.BatchCommand.prototype.elements=function(){for(var b=[],n=this.stack.length;n--;)for(var a=this.stack[n].elements(),d=a.length;d--;)b.indexOf(a[d])==-1&&b.push(a[d]);return b};svgedit.history.BatchCommand.prototype.addSubCommand=function(b){this.stack.push(b)};svgedit.history.BatchCommand.prototype.isEmpty=function(){return this.stack.length==0};svgedit.history.UndoManager=function(b){this.handler_=b||null;this.undoStackPointer=0;this.undoStack=[];this.undoChangeStackPointer=
-1;this.undoableChangeStack=[]};svgedit.history.UndoManager.prototype.resetUndoStack=function(){this.undoStack=[];this.undoStackPointer=0};svgedit.history.UndoManager.prototype.getUndoStackSize=function(){return this.undoStackPointer};svgedit.history.UndoManager.prototype.getRedoStackSize=function(){return this.undoStack.length-this.undoStackPointer};svgedit.history.UndoManager.prototype.getNextUndoCommandText=function(){return this.undoStackPointer>0?this.undoStack[this.undoStackPointer-1].getText():
""};svgedit.history.UndoManager.prototype.getNextRedoCommandText=function(){return this.undoStackPointer<this.undoStack.length?this.undoStack[this.undoStackPointer].getText():""};svgedit.history.UndoManager.prototype.undo=function(){this.undoStackPointer>0&&this.undoStack[--this.undoStackPointer].unapply(this.handler_)};svgedit.history.UndoManager.prototype.redo=function(){this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0&&this.undoStack[this.undoStackPointer++].apply(this.handler_)};
svgedit.history.UndoManager.prototype.addCommandToHistory=function(b){if(this.undoStackPointer<this.undoStack.length&&this.undoStack.length>0)this.undoStack=this.undoStack.splice(0,this.undoStackPointer);this.undoStack.push(b);this.undoStackPointer=this.undoStack.length};svgedit.history.UndoManager.prototype.beginUndoableChange=function(b,n){for(var a=++this.undoChangeStackPointer,d=n.length,c=Array(d),p=Array(d);d--;){var e=n[d];if(e!=null){p[d]=e;c[d]=e.getAttribute(b)}}this.undoableChangeStack[a]=
{attrName:b,oldValues:c,elements:p}};svgedit.history.UndoManager.prototype.finishUndoableChange=function(){for(var b=this.undoChangeStackPointer--,n=this.undoableChangeStack[b],a=n.elements.length,d=n.attrName,c=new svgedit.history.BatchCommand("Change "+d);a--;){var p=n.elements[a];if(p!=null){var e={};e[d]=n.oldValues[a];e[d]!=p.getAttribute(d)&&c.addSubCommand(new svgedit.history.ChangeElementCommand(p,e,d))}}this.undoableChangeStack[b]=null;return c}})();svgedit=svgedit||{};
(function(){if(!svgedit.select)svgedit.select={};var b,n,a;svgedit.select.Selector=function(d,c){this.id=d;this.selectedElement=c;this.locked=true;this.selectorGroup=b.createSVGElement({element:"g",attr:{id:"selectorGroup"+this.id}});this.selectorRect=this.selectorGroup.appendChild(b.createSVGElement({element:"path",attr:{id:"selectedBox"+this.id,fill:"none",stroke:"#4F80FF","stroke-width":"1","shape-rendering":"crispEdges",style:"pointer-events:none"}}));svgedit.browser.isTouch()&&this.selectorRect.setAttribute("stroke-opacity",
0.3);this.gripCoords={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};this.reset(this.selectedElement)};svgedit.select.Selector.prototype.reset=function(d){this.locked=true;this.selectedElement=d;this.resize();this.selectorGroup.setAttribute("display","inline")};svgedit.select.Selector.prototype.updateGripCursors=function(d){var c=[];d=Math.round(d/45);if(d<0)d+=8;for(var p in a.selectorGrips)c.push(p);for(;d>0;){c.push(c.shift());d--}d=0;for(p in a.selectorGrips){a.selectorGrips[p].setAttribute("style",
"cursor:"+c[d]+"-resize");d++}};svgedit.select.Selector.prototype.showGrips=function(d){a.selectorGripsGroup.setAttribute("display",d?"inline":"none");var c=this.selectedElement;this.hasGrips=d;if(c&&d){this.selectorGroup.appendChild(a.selectorGripsGroup);this.updateGripCursors(svgedit.utilities.getRotationAngle(c))}};svgedit.select.Selector.prototype.resize=function(){var d=this.selectorRect,c=a,p=c.selectorGrips,e=this.selectedElement,k=e.getAttribute("stroke-width"),h=b.currentZoom(),o=1/h;if(e.getAttribute("stroke")!==
"none"&&!isNaN(k))o+=k/2;var u=e.tagName;if(u==="text")o+=2/h;k=svgedit.transformlist.getTransformList(e);k=svgedit.math.transformListToTransform(k).matrix;k.e*=h;k.f*=h;var B=svgedit.utilities.getBBox(e);if(u==="g"&&!$.data(e,"gsvg"))if(u=b.getStrokedBBox(e.childNodes))B=u;u=B.x;var s=B.y,K=B.width;B=B.height;o*=h;h=svgedit.math.transformBox(u*h,s*h,K*h,B*h,k);k=h.aabox;u=k.x-o;s=k.y-o;var P=k.width+o*2;K=k.height+o*2;k=u+P/2;B=s+K/2;if(e=svgedit.utilities.getRotationAngle(e)){u=b.svgRoot().createSVGTransform();
u.setRotate(-e,k,B);u=u.matrix;h.tl=svgedit.math.transformPoint(h.tl.x,h.tl.y,u);h.tr=svgedit.math.transformPoint(h.tr.x,h.tr.y,u);h.bl=svgedit.math.transformPoint(h.bl.x,h.bl.y,u);h.br=svgedit.math.transformPoint(h.br.x,h.br.y,u);u=h.tl;P=u.x;K=u.y;var M=u.x,I=u.y;u=Math.min;s=Math.max;P=u(P,u(h.tr.x,u(h.bl.x,h.br.x)))-o;K=u(K,u(h.tr.y,u(h.bl.y,h.br.y)))-o;M=s(M,s(h.tr.x,s(h.bl.x,h.br.x)))+o;I=s(I,s(h.tr.y,s(h.bl.y,h.br.y)))+o;u=P;s=K;P=M-P;K=I-K}d.setAttribute("d","M"+u+","+s+" L"+(u+P)+","+s+" "+
(u+P)+","+(s+K)+" "+u+","+(s+K)+"z");this.selectorGroup.setAttribute("transform",e?"rotate("+[e,k,B].join(",")+")":"");if(svgedit.browser.isTouch()){u-=15.75;s-=15.75}else{u-=4;s-=4}this.gripCoords={nw:[u,s].map(Math.round),ne:[u+P,s].map(Math.round),sw:[u,s+K].map(Math.round),se:[u+P,s+K].map(Math.round),n:[u+P/2,s].map(Math.round),w:[u,s+K/2].map(Math.round),e:[u+P,s+K/2].map(Math.round),s:[u+P/2,s+K].map(Math.round)};for(var R in this.gripCoords){d=this.gripCoords[R];p[R].setAttribute("x",d[0]);
p[R].setAttribute("y",d[1])}this.rotateCoords={nw:[u,s],ne:[u+P+8,s],sw:[u,s+K+8],se:[u+P+8,s+K+8]};for(R in this.rotateCoords){d=this.rotateCoords[R];c.rotateGrips[R].setAttribute("cx",d[0]);c.rotateGrips[R].setAttribute("cy",d[1])}};svgedit.select.SelectorManager=function(){this.rubberBandBox=this.selectorParentGroup=null;this.selectors=[];this.selectorMap={};this.selectorGrips={nw:null,n:null,ne:null,e:null,se:null,s:null,sw:null,w:null};this.selectorGripsGroup=null;this.rotateGrips={nw:null,ne:null,
se:null,sw:null};this.initGroup()};svgedit.select.SelectorManager.prototype.initGroup=function(){this.selectorParentGroup&&this.selectorParentGroup.parentNode&&this.selectorParentGroup.parentNode.removeChild(this.selectorParentGroup);this.selectorParentGroup=b.createSVGElement({element:"g",attr:{id:"selectorParentGroup"}});this.selectorGripsGroup=b.createSVGElement({element:"g",attr:{display:"none"}});this.selectorParentGroup.appendChild(this.selectorGripsGroup);b.svgRoot().appendChild(this.selectorParentGroup);
this.selectorMap={};this.selectors=[];this.rubberBandBox=null;for(var d in this.rotateGrips){var c=b.createSVGElement({element:"circle",attr:{id:"selectorGrip_rotate_"+d,fill:"#000",r:8,stroke:"#000","fill-opacity":0,"stroke-opacity":0,"stroke-width":0,style:"cursor:url("+n.imgPath+"rotate.png) 12 12, auto;"}});$.data(c,"dir",d);$.data(c,"type","rotate");this.rotateGrips[d]=this.selectorGripsGroup.appendChild(c)}for(d in this.selectorGrips){c=b.createSVGElement({element:"rect",attr:{id:"selectorGrip_resize_"+
d,width:8,height:8,fill:"#4F80FF",stroke:"rgba(0,0,0,0)","stroke-width":1,style:"cursor:"+d+"-resize","pointer-events":"all"}});if(svgedit.browser.isTouch()){c.setAttribute("width",30.5);c.setAttribute("height",30.5);c.setAttribute("fill-opacity",0.3)}$.data(c,"dir",d);$.data(c,"type","resize");this.selectorGrips[d]=this.selectorGripsGroup.appendChild(c)}if(!$("#canvasBackground").length){d=n.dimensions;d=b.createSVGElement({element:"svg",attr:{id:"canvasBackground",width:d[0],height:d[1],x:0,y:0,
overflow:svgedit.browser.isWebkit()?"none":"visible",style:"pointer-events:none"}});c=b.createSVGElement({element:"defs",attr:{id:"placeholder_defs"}});var p=b.createSVGElement({element:"pattern",attr:{id:"checkerPattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:20,height:20,viewBox:"0 0 10 10"}}),e=b.createSVGElement({element:"rect",attr:{x:0,y:0,width:10,height:10,fill:"#fff"}}),k=b.createSVGElement({element:"rect",attr:{x:0,y:0,width:5,height:5,fill:"#eee"}}),h=b.createSVGElement({element:"rect",
attr:{x:5,y:5,width:5,height:5,fill:"#eee"}}),o=b.createSVGElement({element:"rect",attr:{width:"100%",height:"100%",x:0,y:0,"stroke-width":1,stroke:"#000",fill:"url(#checkerPattern)",style:"pointer-events:none"}});d.appendChild(c);c.appendChild(p);p.appendChild(e);p.appendChild(k);p.appendChild(h);d.appendChild(o);b.svgRoot().insertBefore(d,b.svgContent())}};svgedit.select.SelectorManager.prototype.requestSelector=function(d){if(d==null)return null;var c=this.selectors.length;if(typeof this.selectorMap[d.id]==
"object"){this.selectorMap[d.id].locked=true;return this.selectorMap[d.id]}for(var p=0;p<c;++p)if(this.selectors[p]&&!this.selectors[p].locked){this.selectors[p].locked=true;this.selectors[p].reset(d);this.selectorMap[d.id]=this.selectors[p];return this.selectors[p]}this.selectors[c]=new svgedit.select.Selector(c,d);this.selectorParentGroup.appendChild(this.selectors[c].selectorGroup);this.selectorMap[d.id]=this.selectors[c];return this.selectors[c]};svgedit.select.SelectorManager.prototype.releaseSelector=
function(d){if(d!=null)for(var c=this.selectors.length,p=this.selectorMap[d.id],e=0;e<c;++e)if(this.selectors[e]&&this.selectors[e]==p){p.locked==false&&console.log("WARNING! selector was released but was already unlocked");delete this.selectorMap[d.id];p.locked=false;p.selectedElement=null;p.showGrips(false);try{p.selectorGroup.setAttribute("display","none")}catch(k){}break}};svgedit.select.SelectorManager.prototype.getRubberBandBox=function(){if(!this.rubberBandBox)this.rubberBandBox=this.selectorParentGroup.appendChild(b.createSVGElement({element:"rect",
attr:{id:"selectorRubberBand",fill:"none",stroke:"#666","stroke-width":1,"stroke-dasharray":"3,2",display:"none",style:"pointer-events:none"}}));return this.rubberBandBox};svgedit.select.init=function(d,c){n=d;b=c;a=new svgedit.select.SelectorManager;b.createSVGElement({element:"g",attr:{id:"hover_group"}})};svgedit.select.getSelectorManager=function(){return a}})();svgedit=svgedit||{};
(function(){if(!svgedit.draw)svgedit.draw={};var b="a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use".split(","),n={LET_DOCUMENT_DECIDE:0,ALWAYS_RANDOMIZE:1,NEVER_RANDOMIZE:2},a=n.LET_DOCUMENT_DECIDE;svgedit.draw.Layer=function(d,c){this.name_=d;this.group_=c};svgedit.draw.Layer.prototype.getName=function(){return this.name_};svgedit.draw.Layer.prototype.getGroup=function(){return this.group_};svgedit.draw.randomizeIds=function(d,c){a=d==false?n.NEVER_RANDOMIZE:
n.ALWAYS_RANDOMIZE;if(a==n.ALWAYS_RANDOMIZE&&!c.getNonce())c.setNonce(Math.floor(Math.random()*100001));else a==n.NEVER_RANDOMIZE&&c.getNonce()&&c.clearNonce()};svgedit.draw.Drawing=function(d,c){if(!d||!d.tagName||!d.namespaceURI||d.tagName!="svg"||d.namespaceURI!="http://www.w3.org/2000/svg")throw"Error: svgedit.draw.Drawing instance initialized without a <svg> element";this.svgElem_=d;this.obj_num=0;this.idPrefix=c||"svg_";this.releasedNums=[];this.all_layers=[];this.current_layer=null;this.nonce_=
"";var p=this.svgElem_.getAttributeNS("http://svg-edit.googlecode.com","nonce");if(p&&a!=n.NEVER_RANDOMIZE)this.nonce_=p;else a==n.ALWAYS_RANDOMIZE&&this.setNonce(Math.floor(Math.random()*100001))};svgedit.draw.Drawing.prototype.getElem_=function(d){return this.svgElem_.querySelector?this.svgElem_.querySelector("#"+d):$(this.svgElem_).find("[id="+d+"]")[0]};svgedit.draw.Drawing.prototype.getSvgElem=function(){return this.svgElem_};svgedit.draw.Drawing.prototype.getNonce=function(){return this.nonce_};
svgedit.draw.Drawing.prototype.setNonce=function(d){this.svgElem_.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:se","http://svg-edit.googlecode.com");this.svgElem_.setAttributeNS("http://svg-edit.googlecode.com","se:nonce",d);this.nonce_=d};svgedit.draw.Drawing.prototype.clearNonce=function(){this.nonce_=""};svgedit.draw.Drawing.prototype.getId=function(){return this.nonce_?this.idPrefix+this.nonce_+"_"+this.obj_num:this.idPrefix+this.obj_num};svgedit.draw.Drawing.prototype.getNextId=function(){var d=
this.obj_num,c=false;if(this.releasedNums.length>0){this.obj_num=this.releasedNums.pop();c=true}else this.obj_num++;for(var p=this.getId();this.getElem_(p);){if(c){this.obj_num=d;c=false}this.obj_num++;p=this.getId()}if(c)this.obj_num=d;return p};svgedit.draw.Drawing.prototype.releaseId=function(d){var c=this.idPrefix+(this.nonce_?this.nonce_+"_":"");if(typeof d!="string"||d.indexOf(c)!=0)return false;d=parseInt(d.substr(c.length));if(typeof d!="number"||d<=0||this.releasedNums.indexOf(d)!=-1)return false;
this.releasedNums.push(d);return true};svgedit.draw.Drawing.prototype.getNumLayers=function(){return this.all_layers.length};svgedit.draw.Drawing.prototype.hasLayer=function(d){for(var c=0;c<this.getNumLayers();c++)if(this.all_layers[c][0]==d)return true;return false};svgedit.draw.Drawing.prototype.getLayerName=function(d){if(d>=0&&d<this.getNumLayers())return this.all_layers[d][0];return""};svgedit.draw.Drawing.prototype.getCurrentLayer=function(){return this.current_layer};svgedit.draw.Drawing.prototype.getCurrentLayerName=
function(){for(var d=0;d<this.getNumLayers();++d)if(this.all_layers[d][1]==this.current_layer)return this.getLayerName(d);return""};svgedit.draw.Drawing.prototype.setCurrentLayer=function(d){for(var c=0;c<this.getNumLayers();++c)if(d==this.getLayerName(c)){if(this.current_layer!=this.all_layers[c][1]){this.current_layer.setAttribute("style","pointer-events:none");this.current_layer=this.all_layers[c][1];this.current_layer.setAttribute("style","pointer-events:all")}return true}return false};svgedit.draw.Drawing.prototype.deleteCurrentLayer=
function(){if(this.current_layer&&this.getNumLayers()>1){var d=this.current_layer.parentNode.removeChild(this.current_layer);this.identifyLayers();return d}return null};svgedit.draw.Drawing.prototype.identifyLayers=function(){this.all_layers=[];for(var d=this.svgElem_.childNodes.length,c=[],p=[],e=null,k=false,h=0;h<d;++h){var o=this.svgElem_.childNodes.item(h);if(o&&o.nodeType==1)if(o.tagName=="g"){k=true;var u=$("title",o).text();if(!u&&svgedit.browser.isOpera()&&o.querySelectorAll)u=$(o.querySelectorAll("title")).text();
if(u){p.push(u);this.all_layers.push([u,o]);e=o;svgedit.utilities.walkTree(o,function(B){B.setAttribute("style","pointer-events:inherit")});e.setAttribute("style","pointer-events:none")}else c.push(o)}else if(~b.indexOf(o.nodeName)){svgedit.utilities.getBBox(o);c.push(o)}}d=this.svgElem_.ownerDocument;if(c.length>0||!k){for(h=1;p.indexOf("Layer "+h)>=0;)h++;p="Layer "+h;e=d.createElementNS("http://www.w3.org/2000/svg","g");k=d.createElementNS("http://www.w3.org/2000/svg","title");k.textContent=p;
e.appendChild(k);for(k=0;k<c.length;++k)e.appendChild(c[k]);this.svgElem_.appendChild(e);this.all_layers.push([p,e])}svgedit.utilities.walkTree(e,function(B){B.setAttribute("style","pointer-events:inherit")});this.current_layer=e.getAttribute("data-locked")==="true"?this.all_layers.slice(-2)[0][1]:e;this.current_layer.setAttribute("style","pointer-events:all")};svgedit.draw.Drawing.prototype.createLayer=function(d){var c=this.svgElem_.ownerDocument,p=c.createElementNS("http://www.w3.org/2000/svg",
"g");c=c.createElementNS("http://www.w3.org/2000/svg","title");c.textContent=d;p.appendChild(c);this.svgElem_.appendChild(p);this.identifyLayers();return p};svgedit.draw.Drawing.prototype.getLayerVisibility=function(d){for(var c=null,p=0;p<this.getNumLayers();++p)if(this.getLayerName(p)==d){c=this.all_layers[p][1];break}if(!c)return false;return c.getAttribute("display")!="none"};svgedit.draw.Drawing.prototype.setLayerVisibility=function(d,c){if(typeof c!="boolean")return null;for(var p=null,e=0;e<
this.getNumLayers();++e)if(this.getLayerName(e)==d){p=this.all_layers[e][1];break}if(!p)return null;p.getAttribute("display");p.setAttribute("display",c?"inline":"none");return p};svgedit.draw.Drawing.prototype.getLayerOpacity=function(d){for(var c=0;c<this.getNumLayers();++c)if(this.getLayerName(c)==d){(d=this.all_layers[c][1].getAttribute("opacity"))||(d="1.0");return parseFloat(d)}return null};svgedit.draw.Drawing.prototype.setLayerOpacity=function(d,c){if(!(typeof c!="number"||c<0||c>1))for(var p=
0;p<this.getNumLayers();++p)if(this.getLayerName(p)==d){this.all_layers[p][1].setAttribute("opacity",c);break}}})();svgedit=svgedit||{};
(function(){if(!svgedit.path)svgedit.path={};var b={pathNodeTooltip:"Drag node to move it. Double-click node to change segment type",pathCtrlPtTooltip:"Drag control point to adjust curve properties"},n={2:["x","y"],4:["x","y"],6:["x","y","x1","y1","x2","y2"],8:["x","y","x1","y1"],10:["x","y","r1","r2","angle","largeArcFlag","sweepFlag"],12:["x"],14:["y"],16:["x","y","x2","y2"],18:["x","y"]},a=[],d=false,c={};svgedit.path.setLinkControlPoints=function(k){d=k};var p=svgedit.path.path=null;svgedit.path.init=
function(k){p=k;a=[0,"ClosePath"];$.each(["Moveto","Lineto","CurvetoCubic","CurvetoQuadratic","Arc","LinetoHorizontal","LinetoVertical","CurvetoCubicSmooth","CurvetoQuadraticSmooth"],function(h,o){a.push(o+"Abs");a.push(o+"Rel")})};svgedit.path.insertItemBefore=function(k,h,o){k.pathSegList.insertItemBefore(h,o)};svgedit.path.ptObjToArr=function(k,h){for(var o=n[k],u=o.length,B=Array(u),s=0;s<u;s++)B[s]=h[o[s]];return B};svgedit.path.getGripPt=function(k,h){var o={x:h?h.x:k.item.x,y:h?h.y:k.item.y},
u=k.path;if(u.matrix)o=svgedit.math.transformPoint(o.x,o.y,u.matrix);o.x*=p.getCurrentZoom();o.y*=p.getCurrentZoom();return o};svgedit.path.getPointFromGrip=function(k,h){var o={x:k.x,y:k.y};if(h.matrix){k=svgedit.math.transformPoint(o.x,o.y,h.imatrix);o.x=k.x;o.y=k.y}o.x/=p.getCurrentZoom();o.y/=p.getCurrentZoom();return o};svgedit.path.addPointGrip=function(k,h,o){var u=svgedit.path.getGripContainer(),B=svgedit.utilities.getElem("pathpointgrip_"+k);if(!B){B=document.createElementNS("http://www.w3.org/2000/svg",
"rect");svgedit.utilities.assignAttributes(B,{id:"pathpointgrip_"+k,display:"none",width:svgedit.browser.isTouch()?30:5,height:svgedit.browser.isTouch()?30:5,fill:"#fff",stroke:"#4F80FF","shape-rendering":"crispEdges","stroke-width":1,cursor:"move",style:"pointer-events:all","xlink:title":b.pathNodeTooltip});B=u.appendChild(B);$("#pathpointgrip_"+k).dblclick(function(){svgedit.path.path&&svgedit.path.path.setSegType()})}if(h&&o)svgedit.utilities.assignAttributes(B,{x:h-(svgedit.browser.isTouch()?
15:2.5),y:o-(svgedit.browser.isTouch()?15:2.5),display:"inline"});return B};svgedit.path.getGripContainer=function(){var k=svgedit.utilities.getElem("pathpointgrip_container");if(!k){k=svgedit.utilities.getElem("selectorParentGroup").appendChild(document.createElementNS("http://www.w3.org/2000/svg","g"));k.id="pathpointgrip_container"}return k};svgedit.path.addCtrlGrip=function(k){var h=svgedit.utilities.getElem("ctrlpointgrip_"+k);if(h)return h;h=document.createElementNS("http://www.w3.org/2000/svg",
"circle");svgedit.utilities.assignAttributes(h,{id:"ctrlpointgrip_"+k,display:"none",r:svgedit.browser.isTouch()?15:3,fill:"#4F80FF",stroke:"#4F80FF","stroke-opacity":0,"stroke-width":"3",cursor:"move",style:"pointer-events:all","xlink:title":b.pathCtrlPtTooltip});svgedit.path.getGripContainer().appendChild(h);return h};svgedit.path.getCtrlLine=function(k){var h=svgedit.utilities.getElem("ctrlLine_"+k);if(h)return h;h=document.createElementNS("http://www.w3.org/2000/svg","line");svgedit.utilities.assignAttributes(h,
{id:"ctrlLine_"+k,stroke:"#4F80FF","stroke-width":1,style:"pointer-events:none"});svgedit.path.getGripContainer().appendChild(h);return h};svgedit.path.getPointGrip=function(k,h){var o=svgedit.path.addPointGrip(k.index);if(h){var u=svgedit.path.getGripPt(k);svgedit.utilities.assignAttributes(o,{x:u.x-(svgedit.browser.isTouch()?15:2.5),y:u.y-(svgedit.browser.isTouch()?15:2.5),display:"inline"})}return o};svgedit.path.getControlPoints=function(k){var h=k.item,o=k.index;if(!h||!("x1"in h)||!("x2"in h))return null;
var u={};svgedit.path.getGripContainer();for(var B=[svgedit.path.path.segs[o-1].item,h],s=1;s<3;s++){var K=o+"c"+s,P=u["c"+s+"_line"]=svgedit.path.getCtrlLine(K),M=svgedit.path.getGripPt(k,{x:h["x"+s],y:h["y"+s]}),I=svgedit.path.getGripPt(k,{x:B[s-1].x,y:B[s-1].y});svgedit.utilities.assignAttributes(P,{x1:M.x,y1:M.y,x2:I.x,y2:I.y,display:"inline"});u["c"+s+"_line"]=P;pointGrip=u["c"+s]=svgedit.path.addCtrlGrip(K);svgedit.utilities.assignAttributes(pointGrip,{cx:M.x,cy:M.y,display:"inline"});u["c"+
s]=pointGrip}return u};svgedit.path.replacePathSeg=function(k,h,o,u){u=u||svgedit.path.path.elem;k=u["createSVGPathSeg"+a[k]].apply(u,o);u.pathSegList.replaceItem(k,h)};svgedit.path.getSegSelector=function(k,h){var o=k.index,u=svgedit.utilities.getElem("segline_"+o);if(!u){var B=svgedit.path.getGripContainer();u=document.createElementNS("http://www.w3.org/2000/svg","path");svgedit.utilities.assignAttributes(u,{id:"segline_"+o,display:"none",fill:"none",stroke:"#0ff","stroke-opacity":1,"shape-rendering":"crispEdges",
"stroke-width":2,style:"pointer-events:none",d:"M0,0 0,0"});B.appendChild(u)}if(h){o=k.prev;if(!o){u.setAttribute("display","none");return u}o=svgedit.path.getGripPt(o);svgedit.path.replacePathSeg(2,0,[o.x,o.y],u);B=svgedit.path.ptObjToArr(k.type,k.item,true);for(var s=0;s<B.length;s+=2){o=svgedit.path.getGripPt(k,{x:B[s],y:B[s+1]});B[s]=o.x;B[s+1]=o.y}svgedit.path.replacePathSeg(k.type,1,B,u)}return u};svgedit.path.smoothControlPoints=this.smoothControlPoints=function(k,h,o){var u=k.x-o.x,B=k.y-
o.y,s=h.x-o.x,K=h.y-o.y;if((u!=0||B!=0)&&(s!=0||K!=0)){k=Math.atan2(B,u);h=Math.atan2(K,s);u=Math.sqrt(u*u+B*B);s=Math.sqrt(s*s+K*K);B=p.getSVGRoot().createSVGPoint();K=p.getSVGRoot().createSVGPoint();if(k<0)k+=2*Math.PI;if(h<0)h+=2*Math.PI;var P=Math.abs(k-h),M=Math.abs(Math.PI-P)/2;if(k-h>0){k=P<Math.PI?k+M:k-M;h=P<Math.PI?h-M:h+M}else{k=P<Math.PI?k-M:k+M;h=P<Math.PI?h+M:h-M}B.x=u*Math.cos(k)+o.x;B.y=u*Math.sin(k)+o.y;K.x=s*Math.cos(h)+o.x;K.y=s*Math.sin(h)+o.y;return[B,K]}};svgedit.path.Segment=
function(k,h){this.selected=false;this.index=k;this.item=h;this.type=h.pathSegType;this.ctrlpts=[];this.segsel=this.ptgrip=null};svgedit.path.Segment.prototype.showCtrlPts=function(k){for(var h in this.ctrlpts)this.ctrlpts[h].setAttribute("display",k?"inline":"none")};svgedit.path.Segment.prototype.selectCtrls=function(){$("#ctrlpointgrip_"+this.index+"c1, #ctrlpointgrip_"+this.index+"c2").attr("fill","#4F80FF")};svgedit.path.Segment.prototype.show=function(k){if(this.ptgrip){this.ptgrip.setAttribute("display",
k?"inline":"none");this.segsel.setAttribute("display",k?"inline":"none");this.showCtrlPts(k)}};svgedit.path.Segment.prototype.select=function(k){if(this.ptgrip){this.ptgrip.setAttribute("stroke",k?"#4F80FF":"#4F80FF");this.ptgrip.setAttribute("fill",k?"#4F80FF":"#fff");this.segsel.setAttribute("display",k?"inline":"none");this.ctrlpts&&this.selectCtrls(k);this.selected=k}};svgedit.path.Segment.prototype.addGrip=function(){this.ptgrip=svgedit.path.getPointGrip(this,true);this.ctrlpts=svgedit.path.getControlPoints(this,
true);this.segsel=svgedit.path.getSegSelector(this,true)};svgedit.path.Segment.prototype.update=function(k){if(this.ptgrip){var h=svgedit.path.getGripPt(this),o=svgedit.browser.isTouch()?15:2.5;svgedit.utilities.assignAttributes(this.ptgrip,this.ptgrip.nodeName=="rect"?{x:h.x-o,y:h.y-o}:{cx:h.x,cy:h.y});svgedit.path.getSegSelector(this,true);if(this.ctrlpts){if(k){this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.type=this.item.pathSegType}svgedit.path.getControlPoints(this)}}};
svgedit.path.Segment.prototype.move=function(k,h){var o=this.item;o=$.extend({},o);o=this.ctrlpts?[o.x+=k,o.y+=h,o.x1,o.y1,o.x2+=k,o.y2+=h]:[o.x+=k,o.y+=h];svgedit.path.replacePathSeg(this.type,this.index,o);if(this.next&&this.next.ctrlpts){o=this.next.item;o=[o.x,o.y,o.x1+=k,o.y1+=h,o.x2,o.y2];svgedit.path.replacePathSeg(this.next.type,this.next.index,o)}if(this.mate){o=this.mate.item;o=[o.x+=k,o.y+=h];svgedit.path.replacePathSeg(this.mate.type,this.mate.index,o)}this.update(true);this.next&&this.next.update(true)};
svgedit.path.Segment.prototype.setLinked=function(k){var h,o,u;if(k==2){o=1;h=this.next;if(!h)return;u=this.item}else{o=2;h=this.prev;if(!h)return;u=h.item}var B=$.extend({},h.item);B["x"+o]=u.x+(u.x-this.item["x"+k]);B["y"+o]=u.y+(u.y-this.item["y"+k]);svgedit.path.replacePathSeg(h.type,h.index,[B.x,B.y,B.x1,B.y1,B.x2,B.y2]);h.update(true)};svgedit.path.Segment.prototype.moveCtrl=function(k,h,o){var u=$.extend({},this.item);u["x"+k]+=h;u["y"+k]+=o;svgedit.path.replacePathSeg(this.type,this.index,
[u.x,u.y,u.x1,u.y1,u.x2,u.y2]);this.update(true)};svgedit.path.Segment.prototype.setType=function(k,h){svgedit.path.replacePathSeg(k,this.index,h);this.type=k;this.item=svgedit.path.path.elem.pathSegList.getItem(this.index);this.showCtrlPts(k===6);this.ctrlpts=svgedit.path.getControlPoints(this);this.update(true)};svgedit.path.Path=function(k){if(!k||k.tagName!=="path")throw"svgedit.path.Path constructed without a <path> element";this.elem=k;this.segs=[];this.selected_pts=[];svgedit.path.path=this;
this.init()};svgedit.path.Path.prototype.init=function(){$(svgedit.path.getGripContainer()).find("*").attr("display","none");var k=this.elem.pathSegList,h=k.numberOfItems;this.segs=[];this.selected_pts=[];this.first_seg=null;for(var o=0;o<h;o++){var u=k.getItem(o);u=new svgedit.path.Segment(o,u);u.path=this;this.segs.push(u)}k=this.segs;u=null;for(o=0;o<h;o++){var B=k[o],s=o+1>=h?null:k[o+1],K=o-1<0?null:k[o-1];if(B.type===2){if(K&&K.type!==1){s=k[u];s.next=k[u+1];s.next.prev=s;s.addGrip()}u=o}else if(s&&
s.type===1){B.next=k[u+1];B.next.prev=B;B.mate=k[u];B.addGrip();if(this.first_seg==null)this.first_seg=B}else if(s){if(B.type!==1){B.addGrip();if(s&&s.type!==2){B.next=s;B.next.prev=B}}}else if(B.type!==1){s=k[u];s.next=k[u+1];s.next.prev=s;s.addGrip();B.addGrip();if(!this.first_seg)this.first_seg=k[u]}}return this};svgedit.path.Path.prototype.eachSeg=function(k){for(var h=this.segs.length,o=0;o<h;o++)if(k.call(this.segs[o],o)===false)break};svgedit.path.Path.prototype.addSeg=function(k){var h=this.segs[k];
if(h.prev){var o=h.prev,u;switch(h.item.pathSegType){case 4:var B=(h.item.x+o.item.x)/2,s=(h.item.y+o.item.y)/2;u=this.elem.createSVGPathSegLinetoAbs(B,s);break;case 6:u=(o.item.x+h.item.x1)/2;var K=(h.item.x1+h.item.x2)/2,P=(h.item.x2+h.item.x)/2,M=(u+K)/2;K=(K+P)/2;B=(M+K)/2;var I=(o.item.y+h.item.y1)/2,R=(h.item.y1+h.item.y2)/2;o=(h.item.y2+h.item.y)/2;var T=(I+R)/2;R=(R+o)/2;s=(T+R)/2;u=this.elem.createSVGPathSegCurvetoCubicAbs(B,s,u,I,M,T);svgedit.path.replacePathSeg(h.type,k,[h.item.x,h.item.y,
K,R,P,o])}svgedit.path.insertItemBefore(this.elem,u,k)}};svgedit.path.Path.prototype.deleteSeg=function(k){var h=this.segs[k],o=this.elem.pathSegList;h.show(false);var u=h.next;if(h.mate){var B=[u.item.x,u.item.y];svgedit.path.replacePathSeg(2,u.index,B);svgedit.path.replacePathSeg(4,h.index,B);o.removeItem(h.mate.index)}else{if(!h.prev){B=[u.item.x,u.item.y];svgedit.path.replacePathSeg(2,h.next.index,B)}o.removeItem(k)}};svgedit.path.Path.prototype.subpathIsClosed=function(k){var h=false;svgedit.path.path.eachSeg(function(o){if(o<=
k)return true;if(this.type===2)return false;else if(this.type===1){h=true;return false}});return h};svgedit.path.Path.prototype.removePtFromSelection=function(k){var h=this.selected_pts.indexOf(k);if(h!=-1){this.segs[k].select(false);this.selected_pts.splice(h,1)}};svgedit.path.Path.prototype.clearSelection=function(){this.eachSeg(function(){this.select(false)});this.selected_pts=[]};svgedit.path.Path.prototype.storeD=function(){this.last_d=this.elem.getAttribute("d")};svgedit.path.Path.prototype.show=
function(k){this.eachSeg(function(){this.show(k)});k&&this.selectPt(this.first_seg.index);return this};svgedit.path.Path.prototype.movePts=function(k,h){for(var o=this.selected_pts.length;o--;)this.segs[this.selected_pts[o]].move(k,h)};svgedit.path.Path.prototype.moveCtrl=function(k,h){var o=this.segs[this.selected_pts[0]];o.moveCtrl(this.dragctrl,k,h);d&&o.setLinked(this.dragctrl)};svgedit.path.Path.prototype.setSegType=function(k){this.storeD();for(var h=this.selected_pts.length,o;h--;){var u=this.segs[this.selected_pts[h]],
B=u.prev;if(B){if(!k){o="Toggle Path Segment Type";k=u.type==6?4:6}k-=0;var s=u.item.x,K=u.item.y,P=B.item.x;B=B.item.y;var M;switch(k){case 6:if(u.olditem){P=u.olditem;M=[s,K,P.x1,P.y1,P.x2,P.y2]}else{M=s-P;var I=K-B;M=[s,K,P+M/3,B+I/3,s-M/3,K-I/3]}break;case 4:M=[s,K];u.olditem=u.item}u.setType(k,M)}}svgedit.path.path.endChanges(o)};svgedit.path.Path.prototype.selectPt=function(k,h){this.clearSelection();k==null&&this.eachSeg(function(o){if(this.prev)k=o});this.addPtsToSelection(k);if(h){this.dragctrl=
h;d&&this.segs[k].setLinked(h)}};svgedit.path.Path.prototype.update=function(){var k=this.elem;if(svgedit.utilities.getRotationAngle(k)){this.matrix=svgedit.math.getMatrix(k);this.imatrix=this.matrix.inverse()}else this.imatrix=this.matrix=null;this.eachSeg(function(h){this.item=k.pathSegList.getItem(h);this.update()});return this};svgedit.path.getPath_=function(k){var h=c[k.id];h||(h=c[k.id]=new svgedit.path.Path(k));return h};svgedit.path.removePath_=function(k){k in c&&delete c[k]};var e=function(k,
h,o,u,B,s,K){dx=k-o;dy=h-u;r=Math.sqrt(dx*dx+dy*dy);theta=Math.atan2(dy,dx)+K;dx=r*Math.cos(theta)+o;dy=r*Math.sin(theta)+u;dx-=B;dy-=s;r=Math.sqrt(dx*dx+dy*dy);theta=Math.atan2(dy,dx)-K;return{x:(r*Math.cos(theta)+B)/1,y:(r*Math.sin(theta)+s)/1}};svgedit.path.recalcRotatedPath=function(){var k=svgedit.path.path.elem,h=svgedit.utilities.getRotationAngle(k,true);if(h){var o=svgedit.utilities.getBBox(k),u=svgedit.path.path.oldbbox,B=u.x+u.width/2;u=u.y+u.height/2;var s=o.x+o.width/2;o=o.y+o.height/
2;s=s-B;var K=o-u;o=Math.sqrt(s*s+K*K);K=Math.atan2(K,s)+h;s=o*Math.cos(K)+B;o=o*Math.sin(K)+u;K=k.pathSegList;for(var P=K.numberOfItems;P;){P-=1;var M=K.getItem(P),I=M.pathSegType;if(I!=1){var R=e(M.x,M.y,B,u,s,o,h);R=[R.x,R.y];if(M.x1!=null&&M.x2!=null){c_vals1=e(M.x1,M.y1,B,u,s,o,h);c_vals2=e(M.x2,M.y2,B,u,s,o,h);R.splice(R.length,0,c_vals1.x,c_vals1.y,c_vals2.x,c_vals2.y)}svgedit.path.replacePathSeg(I,P,R)}}svgedit.utilities.getBBox(k);B=svgroot.createSVGTransform();k=svgedit.transformlist.getTransformList(k);
B.setRotate(h*180/Math.PI,s,o);k.replaceItem(B,0)}};svgedit.path.clearData=function(){c={}}})();if(!window.console){window.console={};window.console.log=function(){};window.console.dir=function(){}}if(window.opera){window.console.log=function(b){opera.postError(b)};window.console.dir=function(){}}
(function(){var b=jQuery.fn.attr;jQuery.fn.attr=function(n,a){var d=this.length;if(!d)return b.apply(this,arguments);for(var c=0;c<d;c++){var p=this[c];if(p.namespaceURI==="http://www.w3.org/2000/svg")if(a!==undefined)p.setAttribute(n,a);else if($.isArray(n)){d=n.length;for(c={};d--;){var e=n[d],k=p.getAttribute(e);if(k||k==="0")k=isNaN(k)?k:k-0;c[e]=k}return c}else if(typeof n==="object")for(e in n)p.setAttribute(e,n[e]);else{if((k=p.getAttribute(n))||k==="0")k=isNaN(k)?k:k-0;return k}else return b.apply(this,
arguments)}return this}})();
$.SvgCanvas=function(b,n){function a(g,l){for(var m=svgedit.utilities.getBBox(g),A=0;A<2;A++){var z=A===0?"fill":"stroke",H=g.getAttribute(z);if(H&&H.indexOf("url(")===0){H=Q(H);if(H.tagName==="linearGradient"){var C=H.getAttribute("x1")||0,v=H.getAttribute("y1")||0,E=H.getAttribute("x2")||1,J=H.getAttribute("y2")||0;C=m.width*C+m.x;v=m.height*v+m.y;E=m.width*E+m.x;J=m.height*J+m.y;C=O(C,v,l);J=O(E,J,l);E={};E.x1=(C.x-m.x)/m.width;E.y1=(C.y-m.y)/m.height;E.x2=(J.x-m.x)/m.width;E.y2=(J.y-m.y)/m.height;
H=H.cloneNode(true);$(H).attr(E);H.id=ja();ib().appendChild(H);g.setAttribute(z,"url(#"+H.id+")")}}}}var d="http://www.w3.org/2000/svg",c={show_outside_canvas:true,selectNew:true,dimensions:[640,480]};n&&$.extend(c,n);var p=c.dimensions,e=this,k=b.ownerDocument,h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttribute("width",p[0]);h.setAttribute("height",p[1]);h.id="svgroot";h.setAttribute("xlinkns","http://www.w3.org/1999/xlink");b.appendChild(h);var o=k.createElementNS(d,"svg");
(e.clearSvgContentElement=function(){for(;o.firstChild;)o.removeChild(o.firstChild);$(o).attr({id:"svgcontent",width:p[0],height:p[1],x:p[0],y:p[1],overflow:c.show_outside_canvas?"visible":"hidden",xmlns:d,"xmlns:se":"http://svg-edit.googlecode.com","xmlns:xlink":"http://www.w3.org/1999/xlink"}).appendTo(h);var g=k.createComment(" Created with Method Draw - http://github.com/duopixel/Method-Draw/ ");o.appendChild(g)})();var u="svg_";e.setIdPrefix=function(g){u=g};e.current_drawing_=new svgedit.draw.Drawing(o,
u);var B=e.getCurrentDrawing=function(){return e.current_drawing_},s=1,K=null,P={shape:{fill:(c.initFill.color=="none"?"":"#")+c.initFill.color,fill_paint:null,fill_opacity:c.initFill.opacity,stroke:"#"+c.initStroke.color,stroke_paint:null,stroke_opacity:c.initStroke.opacity,stroke_width:c.initStroke.width,stroke_dasharray:"none",opacity:c.initOpacity}};P.text=$.extend(true,{},P.shape);$.extend(P.text,{fill:"#000000",stroke_width:0,font_size:24,font_family:"Helvetica, Arial, sans-serif"});var M=P.shape,
I=Array(1),R=this.addSvgElementFromJson=function(g){var l=svgedit.utilities.getElem(g.attr.id),m=B().getCurrentLayer();if(l&&g.element!=l.tagName){m.removeChild(l);l=null}if(!l){l=k.createElementNS(d,g.element);if(m)(K||m).appendChild(l)}g.curStyles&&svgedit.utilities.assignAttributes(l,{fill:M.fill,stroke:M.stroke,"stroke-width":M.stroke_width,"stroke-dasharray":M.stroke_dasharray,"stroke-opacity":M.stroke_opacity,"fill-opacity":M.fill_opacity,opacity:M.opacity/2,style:"pointer-events:inherit"},
100);svgedit.utilities.assignAttributes(l,g.attr,100);svgedit.utilities.cleanupElement(l);return l},T=e.getTransformList=svgedit.transformlist.getTransformList,O=svgedit.math.transformPoint,ca=e.matrixMultiply=svgedit.math.matrixMultiply,ma=e.hasMatrixTransform=svgedit.math.hasMatrixTransform,ia=e.transformListToTransform=svgedit.math.transformListToTransform,Z=svgedit.math.snapToAngle,V=svgedit.math.getMatrix;svgedit.units.init({getBaseUnit:function(){return c.baseUnit},getElement:svgedit.utilities.getElem,
getHeight:function(){return o.getAttribute("height")/s},getWidth:function(){return o.getAttribute("width")/s},getRoundDigits:function(){return db.round_digits}});var oa=e.convertToNum=svgedit.units.convertToNum;svgedit.utilities.init({getDOMDocument:function(){return k},getDOMContainer:function(){return b},getSVGRoot:function(){return h},getSelectedElements:function(){return I},getSVGContent:function(){return o}});var ha=e.getUrlFromAttr=svgedit.utilities.getUrlFromAttr,la=e.getHref=svgedit.utilities.getHref,
ba=e.setHref=svgedit.utilities.setHref,ea=svgedit.utilities.getPathBBox;e.getBBox=svgedit.utilities.getBBox;var ra=e.getRotationAngle=svgedit.utilities.getRotationAngle,pa=e.getElem=svgedit.utilities.getElem,na=e.assignAttributes=svgedit.utilities.assignAttributes,qa=this.cleanupElement=svgedit.utilities.cleanupElement,Ka=svgedit.sanitize.getNSMap(),Fa=e.sanitizeSvg=svgedit.sanitize.sanitizeSvg,Oa=svgedit.history.MoveElementCommand,La=svgedit.history.InsertElementCommand,Ra=svgedit.history.RemoveElementCommand,
Ja=svgedit.history.ChangeElementCommand,ta=svgedit.history.BatchCommand;e.undoMgr=new svgedit.history.UndoManager({handleHistoryEvent:function(g,l){var m=svgedit.history.HistoryEventTypes;if(g==m.BEFORE_UNAPPLY||g==m.BEFORE_APPLY)e.clearSelection();else if(g==m.AFTER_APPLY||g==m.AFTER_UNAPPLY){var A=l.elements();e.pathActions.clear();N("changed",A);A=l.type();m=g==m.AFTER_APPLY;if(A==Oa.type())(m?l.newParent:l.oldParent)==o&&e.identifyLayers();else if(A==La.type()||A==Ra.type()){l.parent==o&&e.identifyLayers();
if(A==La.type())m&&Wa(l.elem);else m||Wa(l.elem);l.elem.tagName==="use"&&zb(l.elem)}else if(A==Ja.type()){l.elem.tagName=="title"&&l.elem.parentNode.parentNode==o&&e.identifyLayers();m=m?l.newValues:l.oldValues;m.stdDeviation&&e.setBlurOffsets(l.elem.parentNode,m.stdDeviation)}}}});var wa=function(g){e.undoMgr.addCommandToHistory(g)};svgedit.select.init(c,{createSVGElement:function(g){return e.addSvgElementFromJson(g)},svgRoot:function(){return h},svgContent:function(){return o},currentZoom:function(){return s},
getStrokedBBox:function(g){return e.getStrokedBBox([g])}});var Ea=this.selectorManager=svgedit.select.getSelectorManager();svgedit.path.init({getCurrentZoom:function(){return s},getSVGRoot:function(){return h}});svgedit.utilities.snapToGrid=function(g){var l=c.snappingStep,m=c.baseUnit;if(m!=="px")l*=svgedit.units.getTypeMap()[m];return g=Math.round(g/l)*l};var va=svgedit.utilities.snapToGrid,Va={exportNoBlur:"Blurred elements will appear as un-blurred",exportNoforeignObject:"foreignObject elements will not appear",
exportNoDashArray:"Strokes will appear filled",exportNoText:"Text may not appear as expected"},ub=["clip-path","fill","filter","marker-end","marker-mid","marker-start","mask","stroke"],fb=$.data,Wa=function(g){var l=$(g).attr(ub),m;for(m in l){var A=l[m];if(A&&A.indexOf("url(")===0){A=ha(A).substr(1);if(!pa(A)){ib().appendChild(tb[A]);delete tb[A]}}}g=g.getElementsByTagName("*");if(g.length){l=0;for(m=g.length;l<m;l++)Wa(g[l])}},Ya={},Ba=c.imgPath+"logo.png",ua=[],db={round_digits:5},Ga=false,Ua=
null,Ca="select",hb="none",qb={},Za=P.text,$a=M,vb=null,sa=null,kb=[],gb={},tb={};e.clipBoard=[];var lb=this.runExtensions=function(g,l,m){var A=false;if(m)A=[];$.each(gb,function(z,H){if(g in H)if(m)A.push(H[g](l));else A=H[g](l)});return A};this.addExtension=function(g,l){if(g in gb)console.log('Cannot add extension "'+g+'", an extension by that name already exists"');else{var m=$.isFunction(l)?l($.extend(e.getPrivateMethods(),{svgroot:h,svgcontent:o,nonce:B().getNonce(),selectorManager:Ea})):l;
gb[g]=m;N("extension_added",m)}};var eb=this.round=function(g){return parseInt(g*s)/s},nb=this.getIntersectionList=function(g){if(sa==null)return null;var l=K||B().getCurrentLayer();kb.length||(kb=wb(l));var m=null;try{m=l.getIntersectionList(g,null)}catch(A){}if(m==null||typeof m.item!="function"){m=[];if(g)g=g;else{g=sa.getBBox();l={};for(var z in g)l[z]=g[z]/s;g=l}for(z=kb.length;z--;)g.width&&g.width&&svgedit.math.rectsIntersect(g,kb[z].bbox)&&m.push(kb[z].elem)}return m};getStrokedBBox=this.getStrokedBBox=
function(g){g||(g=rb());if(!g.length)return false;var l=function(J){try{var F=svgedit.utilities.getBBox(J),f=svgedit.utilities.getRotationAngle(J);if(f&&f%90||svgedit.math.hasMatrixTransform(svgedit.transformlist.getTransformList(J))){f=false;if(["ellipse","path","line","polyline","polygon"].indexOf(J.tagName)>=0)F=f=e.convertToPath(J,true);else if(J.tagName=="rect"){var q=J.getAttribute("rx"),w=J.getAttribute("ry");if(q||w)F=f=e.convertToPath(J,true)}if(!f){var D=J.cloneNode(true),G=document.createElementNS(d,
"g"),L=J.parentNode;L.appendChild(G);G.appendChild(D);F=svgedit.utilities.bboxToObj(G.getBBox());L.removeChild(G)}}return F}catch(U){console.log(J,U)}},m;$.each(g,function(){if(!m)if(this.parentNode)m=l(this)});if(m==null)return null;var A=m.x+m.width,z=m.y+m.height,H=m.x,C=m.y,v=function(J){var F=J.getAttribute("stroke-width"),f=0;if(J.getAttribute("stroke")!="none"&&!isNaN(F))f+=F/2;return f},E=[];$.each(g,function(J,F){var f=l(F);if(f){var q=v(F);H=Math.min(H,f.x-q);C=Math.min(C,f.y-q);E.push(f)}});
m.x=H;m.y=C;$.each(g,function(J,F){var f=E[J];if(f&&F.nodeType==1){var q=v(F);A=Math.max(A,f.x+f.width+q);z=Math.max(z,f.y+f.height+q)}});m.width=A-H;m.height=z-C;return m};var rb=this.getVisibleElements=function(g){g||(g=$(o).children());g.find("#canvas_background").length&&g.splice(0,1);var l=[];$(g).children().each(function(m,A){try{A.getBBox()&&l.push(A)}catch(z){}});return l.reverse()},wb=this.getVisibleElementsAndBBoxes=function(g){g||(g=$(o).children());var l=[];$(g).children().each(function(m,
A){try{A.getBBox()&&l.push({elem:A,bbox:getStrokedBBox([A])})}catch(z){}});return l.reverse()},xb=this.groupSvgElem=function(g){var l=document.createElementNS(d,"g");g.parentNode.replaceChild(l,g);$(l).append(g).data("gsvg",g)[0].id=ja()},ga=function(g){var l=document.createElementNS(g.namespaceURI,g.nodeName);l.removeAttribute("id");$.each(g.attributes,function(A,z){z.localName!="-moz-math-font-style"&&l.setAttributeNS(z.namespaceURI,z.nodeName,z.nodeValue)});if(svgedit.browser.isWebkit()&&g.nodeName==
"path"){var m=Ia.convertPath(g);l.setAttribute("d",m)}$.each(g.childNodes,function(A,z){switch(z.nodeType){case 1:l.appendChild(ga(z));break;case 3:l.textContent=z.nodeValue}});if($(g).data("gsvg"))$(l).data("gsvg",l.firstChild);else if($(g).data("symbol")){g=$(g).data("symbol");$(l).data("ref",g).data("symbol",g)}else l.tagName=="image"&&Eb(l);l.id=ja();return l},aa,ja,N;(function(g){var l={};aa=g.getId=function(){return B().getId()};ja=g.getNextId=function(){return B().getNextId()};N=g.call=function(m,
A){if(l[m])return l[m](this,A)};g.bind=function(m,A){var z=l[m];l[m]=A;return z}})(e);this.prepareSvg=function(g){this.sanitizeSvg(g.documentElement);g=g.getElementsByTagNameNS(d,"path");for(var l=0,m=g.length;l<m;++l){var A=g[l];A.setAttribute("d",Ia.convertPath(A));Ia.fixEnd(A)}};var Q=this.getRefElem=function(g){return pa(ha(g).substr(1))},da=function(g){if(!svgedit.browser.isGecko())return g;var l=g.cloneNode(true);g.parentNode.insertBefore(l,g);g.parentNode.removeChild(g);Ea.releaseSelector(g);
I[0]=l;Ea.requestSelector(l).showGrips(true);return l};this.setRotationAngle=function(g,l){g=parseFloat(g);var m=I[0];if(m){var A=m.getAttribute("transform"),z=svgedit.utilities.getBBox(m),H=z.x+z.width/2,C=z.y+z.height/2;z=T(m);z.numberOfItems>0&&z.getItem(0).type==4&&z.removeItem(0);if(g!=0){H=O(H,C,ia(z).matrix);C=h.createSVGTransform();C.setRotate(g,H.x,H.y);z.numberOfItems?z.insertItemBefore(C,0):z.appendItem(C)}else z.numberOfItems==0&&m.removeAttribute("transform");if(!l){z=m.getAttribute("transform");
m.setAttribute("transform",A);jb("transform",z,I);N("changed",I)}pa("pathpointgrip_container");m=Ea.requestSelector(I[0]);m.resize();m.updateGripCursors(g)}};var Da=this.recalculateAllSelectedDimensions=function(){for(var g=new ta(hb=="none"?"position":"size"),l=I.length;l--;){var m=Ta(I[l]);m&&g.addSubCommand(m)}if(!g.isEmpty()){wa(g);N("changed",I)}},Ma=[0,"z","M","m","L","l","C","c","Q","q","A","a","H","h","V","v","S","s","T","t"],Sa=function(g){console.log([g.a,g.b,g.c,g.d,g.e,g.f])},cb=this.remapElement=
function(g,l,m){var A=c.gridSnapping&&g.parentNode.parentNode.localName==="svg",z=function(){if(A)for(var f in l)l[f]=va(l[f]);na(g,l,1E3,true)};box=svgedit.utilities.getBBox(g);for(var H=0;H<2;H++){var C=H===0?"fill":"stroke",v=g.getAttribute(C);if(v&&v.indexOf("url(")===0)if(m.a<0||m.d<0){v=Q(v).cloneNode(true);if(m.a<0){var E=v.getAttribute("x1"),J=v.getAttribute("x2");v.setAttribute("x1",-(E-1));v.setAttribute("x2",-(J-1))}if(m.d<0){E=v.getAttribute("y1");J=v.getAttribute("y2");v.setAttribute("y1",
-(E-1));v.setAttribute("y2",-(J-1))}v.id=ja();ib().appendChild(v);g.setAttribute(C,"url(#"+v.id+")")}}H=g.tagName;if(H==="g"||H==="text"||H==="use")if(m.a==1&&m.b==0&&m.c==0&&m.d==1&&(m.e!=0||m.f!=0)){C=ia(g).matrix;C=ca(C.inverse(),m,C);l.x=parseFloat(l.x)+C.e;l.y=parseFloat(l.y)+C.f}else{C=T(g);v=h.createSVGTransform();v.setMatrix(ca(ia(C).matrix,m));C.clear();C.appendItem(v)}switch(H){case "foreignObject":case "rect":case "image":if(H==="image"&&(m.a<0||m.d<0)){C=T(g);v=h.createSVGTransform();
v.setMatrix(ca(ia(C).matrix,m));C.clear();C.appendItem(v)}else{C=O(l.x,l.y,m);l.width=m.a*l.width;l.height=m.d*l.height;l.x=C.x+Math.min(0,l.width);l.y=C.y+Math.min(0,l.height);l.width=Math.abs(l.width);l.height=Math.abs(l.height)}z();break;case "ellipse":H=O(l.cx,l.cy,m);l.cx=H.x;l.cy=H.y;l.rx=m.a*l.rx;l.ry=m.d*l.ry;l.rx=Math.abs(l.rx);l.ry=Math.abs(l.ry);z();break;case "circle":H=O(l.cx,l.cy,m);l.cx=H.x;l.cy=H.y;H=svgedit.math.transformBox(box.x,box.y,box.width,box.height,m);l.r=Math.min((H.tr.x-
H.tl.x)/2,(H.bl.y-H.tl.y)/2);if(l.r)l.r=Math.abs(l.r);z();break;case "line":C=O(l.x1,l.y1,m);E=O(l.x2,l.y2,m);l.x1=C.x;l.y1=C.y;l.x2=E.x;l.y2=E.y;case "text":m=g.querySelectorAll("tspan");for(H=m.length;H--;){C=oa("x",g.getAttribute("x"));v=oa("x",m[H].getAttribute("x"));E=oa("y",g.getAttribute("y"));J=oa("y",m[H].getAttribute("y"));var F={};if(!isNaN(C)&&!isNaN(v)&&C!=0&&v!=0&&l.x)F.x=l.x-(C-v);if(!isNaN(E)&&!isNaN(J)&&E!=0&&J!=0&&l.y)F.y=l.y-(E-J);if(F.x||F.y)na(m[H],F,1E3,true)}z();break;case "use":z();
break;case "g":(z=$(g).data("gsvg"))&&na(z,l,1E3,true);break;case "polyline":case "polygon":z=l.points.length;for(H=0;H<z;++H){J=l.points[H];J=O(J.x,J.y,m);l.points[H].x=J.x;l.points[H].y=J.y}z=l.points.length;m="";for(H=0;H<z;++H){J=l.points[H];m+=J.x+","+J.y+" "}g.setAttribute("points",m);break;case "path":C=g.pathSegList;z=C.numberOfItems;l.d=Array(z);for(H=0;H<z;++H){v=C.getItem(H);l.d[H]={type:v.pathSegType,x:v.x,y:v.y,x1:v.x1,y1:v.y1,x2:v.x2,y2:v.y2,r1:v.r1,r2:v.r2,angle:v.angle,largeArcFlag:v.largeArcFlag,
sweepFlag:v.sweepFlag}}z=l.d.length;H=l.d[0];F=O(H.x,H.y,m);l.d[0].x=F.x;l.d[0].y=F.y;for(H=1;H<z;++H){v=l.d[H];C=v.type;if(C%2==0){J=O(v.x!=undefined?v.x:F.x,v.y!=undefined?v.y:F.y,m);C=O(v.x1,v.y1,m);E=O(v.x2,v.y2,m);v.x=J.x;v.y=J.y;v.x1=C.x;v.y1=C.y;v.x2=E.x;v.y2=E.y}else{v.x=m.a*v.x;v.y=m.d*v.y;v.x1=m.a*v.x1;v.y1=m.d*v.y1;v.x2=m.a*v.x2;v.y2=m.d*v.y2}v.r1=m.a*v.r1;v.r2=m.d*v.r2}m="";z=l.d.length;for(H=0;H<z;++H){v=l.d[H];C=v.type;m+=Ma[C];switch(C){case 13:case 12:m+=v.x+" ";break;case 15:case 14:m+=
v.y+" ";break;case 3:case 5:case 19:case 2:case 4:case 18:m+=v.x+","+v.y+" ";break;case 7:case 6:m+=v.x1+","+v.y1+" "+v.x2+","+v.y2+" "+v.x+","+v.y+" ";break;case 9:case 8:m+=v.x1+","+v.y1+" "+v.x+","+v.y+" ";break;case 11:case 10:m+=v.r1+","+v.r2+" "+v.angle+" "+ +v.largeArcFlag+" "+ +v.sweepFlag+" "+v.x+","+v.y+" ";break;case 17:case 16:m+=v.x2+","+v.y2+" "+v.x+","+v.y+" "}}g.setAttribute("d",m)}},pb=function(g,l,m){g=Q(g).firstChild;var A=T(g),z=h.createSVGTransform();z.setTranslate(l,m);A.appendItem(z);
Ta(g)},Ta=this.recalculateDimensions=function(g){if(g==null)return null;var l=T(g);if(l&&l.numberOfItems>0){for(var m=l.numberOfItems;m--;){var A=l.getItem(m);if(A.type===0)l.removeItem(m);else if(A.type===1)svgedit.math.isIdentity(A.matrix)&&l.removeItem(m);else A.type===4&&A.angle===0&&l.removeItem(m)}if(l.numberOfItems===1&&ra(g))return null}if(!l||l.numberOfItems==0){g.removeAttribute("transform");return null}if(l){m=l.numberOfItems;for(var z=[];m--;){A=l.getItem(m);if(A.type===1)z.push([A.matrix,
m]);else if(z.length)z=[]}if(z.length===2){m=h.createSVGTransformFromMatrix(ca(z[1][0],z[0][0]));l.removeItem(z[0][1]);l.removeItem(z[1][1]);l.insertItemBefore(m,z[1][1])}m=l.numberOfItems;if(m>=2&&l.getItem(m-2).type===1&&l.getItem(m-1).type===2){z=h.createSVGTransform();A=ca(l.getItem(m-2).matrix,l.getItem(m-1).matrix);z.setMatrix(A);l.removeItem(m-2);l.removeItem(m-2);l.appendItem(z)}}switch(g.tagName){case "line":case "polyline":case "polygon":case "path":break;default:if(l.numberOfItems===1&&
l.getItem(0).type===1||l.numberOfItems===2&&l.getItem(0).type===1&&l.getItem(0).type===4)return null}var H=$(g).data("gsvg");m=new ta("Transform");var C={},v=null;A=[];switch(g.tagName){case "line":A=["x1","y1","x2","y2"];break;case "circle":A=["cx","cy","r"];break;case "ellipse":A=["cx","cy","rx","ry"];break;case "foreignObject":case "rect":case "image":A=["width","height","x","y"];break;case "use":case "text":case "tspan":A=["x","y"];break;case "polygon":case "polyline":v={};v.points=g.getAttribute("points");
z=g.points;var E=z.numberOfItems;C.points=Array(E);for(var J=0;J<E;++J){var F=z.getItem(J);C.points[J]={x:F.x,y:F.y}}break;case "path":v={};v.d=g.getAttribute("d");C.d=g.getAttribute("d")}if(A.length){C=$(g).attr(A);$.each(C,function(xa,ya){C[xa]=oa(xa,ya)})}else if(H)C={x:$(H).attr("x")||0,y:$(H).attr("y")||0};if(v==null){v=$.extend(true,{},C);$.each(v,function(xa,ya){v[xa]=oa(xa,ya)})}v.transform=Ua?Ua:"";if(g.tagName=="g"&&!H||g.tagName=="a"){z=svgedit.utilities.getBBox(g);var f={x:z.x+z.width/
2,y:z.y+z.height/2},q=O(z.x+z.width/2,z.y+z.height/2,ia(l).matrix);A=h.createSVGMatrix();if(z=ra(g)){J=z*Math.PI/180;E=Math.abs(J)>1.0E-10?Math.sin(J)/(1-Math.cos(J)):2/J;for(J=0;J<l.numberOfItems;++J){A=l.getItem(J);if(A.type==4){A=A.matrix;f.y=(E*A.e+A.f)/2;f.x=(A.e-E*A.f)/2;l.removeItem(J);break}}}J=A=H=0;var w=l.numberOfItems;if(w)var D=l.getItem(0).matrix;if(w>=3&&l.getItem(w-2).type==3&&l.getItem(w-3).type==2&&l.getItem(w-1).type==2){J=3;var G=l.getItem(w-3).matrix,L=l.getItem(w-2).matrix,U=
l.getItem(w-1).matrix;E=g.childNodes;for(F=E.length;F--;){var W=E.item(F);A=H=0;if(W.nodeType==1){var S=T(W);if(S){A=ia(S).matrix;H=ra(W);var X=Ua,Y=[];Ua=W.getAttribute("transform");if(H||ma(S)){var ka=h.createSVGTransform();ka.setMatrix(ca(G,L,U,A));S.clear();S.appendItem(ka);Y.push(ka)}else{H=ca(A.inverse(),U,A);ka=h.createSVGMatrix();ka.e=-H.e;ka.f=-H.f;A=ca(ka.inverse(),A.inverse(),G,L,U,A,H.inverse());var za=h.createSVGTransform(),fa=h.createSVGTransform(),Aa=h.createSVGTransform();za.setTranslate(H.e,
H.f);fa.setScale(A.a,A.d);Aa.setTranslate(ka.e,ka.f);S.appendItem(Aa);S.appendItem(fa);S.appendItem(za);Y.push(Aa);Y.push(fa);Y.push(za)}m.addSubCommand(Ta(W));Ua=X}}}l.removeItem(w-1);l.removeItem(w-2);l.removeItem(w-3)}else if(w>=3&&l.getItem(w-1).type==1){J=3;A=ia(l).matrix;ka=h.createSVGTransform();ka.setMatrix(A);l.clear();l.appendItem(ka)}else if((w==1||w>1&&l.getItem(1).type!=3)&&l.getItem(0).type==2){J=2;H=ia(l).matrix;l.removeItem(0);A=ia(l).matrix.inverse();A=ca(A,H);H=A.e;A=A.f;if(H!=0||
A!=0){E=g.childNodes;F=E.length;for(w=[];F--;){W=E.item(F);if(W.nodeType==1){if(W.getAttribute("clip-path")){X=W.getAttribute("clip-path");if(w.indexOf(X)===-1){pb(X,H,A);w.push(X)}}X=Ua;Ua=W.getAttribute("transform");if(S=T(W)){G=h.createSVGTransform();G.setTranslate(H,A);S.numberOfItems?S.insertItemBefore(G,0):S.appendItem(G);m.addSubCommand(Ta(W));S=g.getElementsByTagNameNS(d,"use");W="#"+W.id;for(G=S.length;G--;){L=S.item(G);if(W==la(L)){U=h.createSVGTransform();U.setTranslate(-H,-A);T(L).insertItemBefore(U,
0);m.addSubCommand(Ta(L))}}Ua=X}}}w=[];Ua=X}}else if(w==1&&l.getItem(0).type==1&&!z){J=1;A=l.getItem(0).matrix;E=g.childNodes;for(F=E.length;F--;){W=E.item(F);if(W.nodeType==1){X=Ua;Ua=W.getAttribute("transform");if(S=T(W)){H=ca(A,ia(S).matrix);w=h.createSVGTransform();w.setMatrix(H);S.clear();S.appendItem(w,0);m.addSubCommand(Ta(W));Ua=X;X=W.getAttribute("stroke-width");W.getAttribute("stroke")!=="none"&&!isNaN(X)&&W.setAttribute("stroke-width",X*((Math.abs(H.a)+Math.abs(H.d))/2))}}}l.clear()}else{if(z){f=
h.createSVGTransform();f.setRotate(z,q.x,q.y);l.numberOfItems?l.insertItemBefore(f,0):l.appendItem(f)}l.numberOfItems==0&&g.removeAttribute("transform");return null}if(J==2){if(z){q={x:f.x+D.e,y:f.y+D.f};f=h.createSVGTransform();f.setRotate(z,q.x,q.y);l.numberOfItems?l.insertItemBefore(f,0):l.appendItem(f)}}else if(J==3){A=ia(l).matrix;D=h.createSVGTransform();D.setRotate(z,f.x,f.y);D=D.matrix;f=h.createSVGTransform();f.setRotate(z,q.x,q.y);q=f.matrix.inverse();X=A.inverse();q=ca(X,q,D,A);H=q.e;A=
q.f;if(H!=0||A!=0){E=g.childNodes;for(F=E.length;F--;){W=E.item(F);if(W.nodeType==1){X=Ua;Ua=W.getAttribute("transform");S=T(W);G=h.createSVGTransform();G.setTranslate(H,A);S.numberOfItems?S.insertItemBefore(G,0):S.appendItem(G);m.addSubCommand(Ta(W));Ua=X}}}if(z)l.numberOfItems?l.insertItemBefore(f,0):l.appendItem(f)}}else{z=svgedit.utilities.getBBox(g);if(!z&&g.tagName!="path")return null;A=h.createSVGMatrix();if(H=ra(g)){f={x:z.x+z.width/2,y:z.y+z.height/2};q=O(z.x+z.width/2,z.y+z.height/2,ia(l).matrix);
J=H*Math.PI/180;E=Math.abs(J)>1.0E-10?Math.sin(J)/(1-Math.cos(J)):2/J;for(J=0;J<l.numberOfItems;++J){A=l.getItem(J);if(A.type==4){A=A.matrix;f.y=(E*A.e+A.f)/2;f.x=(A.e-E*A.f)/2;l.removeItem(J);break}}}J=0;w=l.numberOfItems;if(!svgedit.browser.isWebkit())if((D=g.getAttribute("fill"))&&D.indexOf("url(")===0){D=Q(D);X="pattern";if(D.tagName!==X)X="gradient";if(D.getAttribute(X+"Units")==="userSpaceOnUse"){A=ia(l).matrix;z=T(D);z=ia(z).matrix;A=ca(A,z);z="matrix("+[A.a,A.b,A.c,A.d,A.e,A.f].join(",")+
")";D.setAttribute(X+"Transform",z)}}if(w>=3&&l.getItem(w-2).type==3&&l.getItem(w-3).type==2&&l.getItem(w-1).type==2){J=3;A=ia(l,w-3,w-1).matrix;l.removeItem(w-1);l.removeItem(w-2);l.removeItem(w-3)}else if(w==4&&l.getItem(w-1).type==1){J=3;A=ia(l).matrix;ka=h.createSVGTransform();ka.setMatrix(A);l.clear();l.appendItem(ka);A=h.createSVGMatrix()}else if((w==1||w>1&&l.getItem(1).type!=3)&&l.getItem(0).type==2){J=2;D=l.getItem(0).matrix;X=ia(l,1).matrix;z=X.inverse();A=ca(z,D,X);l.removeItem(0)}else if(w==
1&&l.getItem(0).type==1&&!H){A=ia(l).matrix;switch(g.tagName){case "line":C=$(g).attr(["x1","y1","x2","y2"]);case "polyline":case "polygon":C.points=g.getAttribute("points");if(C.points){z=g.points;E=z.numberOfItems;C.points=Array(E);for(J=0;J<E;++J){F=z.getItem(J);C.points[J]={x:F.x,y:F.y}}}case "path":C.d=g.getAttribute("d");J=1;l.clear()}}else{J=4;if(H){f=h.createSVGTransform();f.setRotate(H,q.x,q.y);l.numberOfItems?l.insertItemBefore(f,0):l.appendItem(f)}l.numberOfItems==0&&g.removeAttribute("transform");
return null}if(J==1||J==2||J==3)cb(g,C,A);if(J==2){if(H){ma(l)||(q={x:f.x+A.e,y:f.y+A.f});f=h.createSVGTransform();f.setRotate(H,q.x,q.y);l.numberOfItems?l.insertItemBefore(f,0):l.appendItem(f)}}else if(J==3&&H){A=ia(l).matrix;D=h.createSVGTransform();D.setRotate(H,f.x,f.y);D=D.matrix;f=h.createSVGTransform();f.setRotate(H,q.x,q.y);q=f.matrix.inverse();X=A.inverse();q=ca(X,q,D,A);cb(g,C,q);if(H)l.numberOfItems?l.insertItemBefore(f,0):l.appendItem(f)}}l.numberOfItems==0&&g.removeAttribute("transform");
m.addSubCommand(new Ja(g,v));return m},ob=null,Pa=this.clearSelection=function(g){if(I[0]!=null)for(var l=I.length,m=0;m<l;++m){var A=I[m];if(A==null)break;Ea.releaseSelector(A);I[m]=null}g||N("selected",I)},sb=this.addToSelection=function(g,l){if(g.length!=0){for(var m=0;m<I.length;){if(I[m]==null)break;++m}for(var A=g.length;A--;){var z=g[A];if(z&&svgedit.utilities.getBBox(z)){if(z.tagName==="a"&&z.childNodes.length===1)z=z.firstChild;if(I.indexOf(z)==-1){I[m]=z;m++;z=Ea.requestSelector(z);I.length>
1&&z.showGrips(false)}}}N("selected",I);l||I.length==1?Ea.requestSelector(I[0]).showGrips(true):Ea.requestSelector(I[0]).showGrips(false);for(I.sort(function(H,C){if(H&&C&&H.compareDocumentPosition)return 3-(C.compareDocumentPosition(H)&6);else if(H==null)return 1});I[0]==null;)I.shift(0)}},Qa=this.selectOnly=function(g,l){Pa(true);sb(g,l)};this.removeFromSelection=function(g){if(I[0]!=null)if(g.length!=0){var l=Array(I.length);j=0;len=I.length;for(var m=0;m<len;++m){var A=I[m];if(A)if(g.indexOf(A)==
-1){l[j]=A;j++}else Ea.releaseSelector(A)}I=l}};this.selectAllInCurrentLayer=function(){var g=B().getCurrentLayer();if(g){Ca="select";Qa($(K||g).children())}};var Fb=this.getMouseTarget=function(g){if(g==null||g.target==null)return null;g=g.target;if(g.correspondingUseElement)g=g.correspondingUseElement;if(["http://www.w3.org/1998/Math/MathML","http://www.w3.org/1999/xhtml"].indexOf(g.namespaceURI)>=0&&g.id!="svgcanvas")for(;g.nodeName!="foreignObject";){g=g.parentNode;if(!g)return h}var l=B().getCurrentLayer();
if([h,b,o,l].indexOf(g)>=0)return h;if($(g).closest("#selectorParentGroup").length)return Ea.selectorParentGroup;for(;g.parentNode&&g.parentNode!==(K||l);)g=g.parentNode;return g};(function(){var g=null,l=null,m=null,A=null,z=null,H={},C={minx:null,miny:null,maxx:null,maxy:null};$(b).mousedown(function(v){if(!e.spaceKey){var E=v.button===2;ob=o.querySelector("g").getScreenCTM().inverse();var J=O(v.pageX,v.pageY,ob),F=J.x*s;J=J.y*s;v.preventDefault();if(E)Ca="select";F=F/s;J=J/s;var f=Fb(v);if(f.tagName===
"a"&&f.childNodes.length===1)f=f.firstChild;var q=A=l=F,w=z=m=J;if(c.gridSnapping){F=va(F);J=va(J);l=va(l);m=va(m)}if(f==Ea.selectorParentGroup&&I[0]!=null){f=v.target;var D=fb(f,"type");if(D=="rotate"){Ca="rotate";current_rotate_mode=fb(f,"dir")}else if(D=="resize"){Ca="resize";hb=fb(f,"dir")}f=I[0]}Ua=f.getAttribute("transform");D=T(f);switch(Ca){case "select":Ga=true;hb="none";if(E)Ga=false;if(f!=h){if(I.indexOf(f)==-1){v.shiftKey||Pa(true);sb([f]);vb=f;Ia.clear()}if(!E)for(E=0;E<I.length;++E)if(I[E]!=
null){var G=T(I[E]);G.numberOfItems?G.insertItemBefore(h.createSVGTransform(),0):G.appendItem(h.createSVGTransform())}}else if(!E){Pa();Ca="multiselect";if(sa==null)sa=Ea.getRubberBandBox();A*=s;z*=s;na(sa,{x:A,y:z,width:0,height:0,display:"inline"},100)}break;case "zoom":Ga=true;if(sa==null)sa=Ea.getRubberBandBox();na(sa,{x:q*s,y:q*s,width:0,height:0,display:"inline"},100);break;case "resize":Ga=true;l=F;m=J;H=svgedit.utilities.getBBox($("#selectedBox0")[0]);var L={};$.each(H,function(U,W){L[U]=
W/s});H=L;E=ra(f)?1:0;if(ma(D)){D.insertItemBefore(h.createSVGTransform(),E);D.insertItemBefore(h.createSVGTransform(),E);D.insertItemBefore(h.createSVGTransform(),E)}else{D.appendItem(h.createSVGTransform());D.appendItem(h.createSVGTransform());D.appendItem(h.createSVGTransform());if(svgedit.browser.supportsNonScalingStroke()){if(F=svgedit.browser.isWebkit())G=function(U){var W=U.getAttributeNS(null,"stroke");U.removeAttributeNS(null,"stroke");setTimeout(function(){U.setAttributeNS(null,"stroke",
W)},0)};f.style.vectorEffect="non-scaling-stroke";F&&G(f);J=f.getElementsByTagName("*");q=J.length;for(E=0;E<q;E++){J[E].style.vectorEffect="non-scaling-stroke";F&&G(J[E])}}}break;case "fhellipse":case "fhrect":case "fhpath":Ga=true;g=q+","+w+" ";G=M.stroke_width==0?1:M.stroke_width;R({element:"polyline",curStyles:true,attr:{points:g,id:ja(),fill:"none",opacity:M.opacity/2,"stroke-linecap":"round",style:"pointer-events:none"}});C.minx=q;C.maxx=q;C.miny=w;C.maxy=w;break;case "image":Ga=true;G=R({element:"image",
attr:{x:F,y:J,width:0,height:0,id:ja(),opacity:M.opacity/2,style:"pointer-events:inherit"}});ba(G,Ba);Eb(G);break;case "square":case "rect":Ga=true;l=F;m=J;R({element:"rect",curStyles:true,attr:{x:F,y:J,width:0,height:0,id:ja(),opacity:M.opacity/2}});break;case "line":Ga=true;G=M.stroke_width==0?1:M.stroke_width;R({element:"line",curStyles:true,attr:{x1:F,y1:J,x2:F,y2:J,id:ja(),stroke:M.stroke,"stroke-width":G,"stroke-dasharray":M.stroke_dasharray,"stroke-linejoin":M.stroke_linejoin,"stroke-linecap":M.stroke_linecap,
"stroke-opacity":M.stroke_opacity,fill:"none",opacity:M.opacity/2,style:"pointer-events:none"}});break;case "circle":Ga=true;R({element:"circle",curStyles:true,attr:{cx:F,cy:J,r:0,id:ja(),opacity:M.opacity/2}});break;case "ellipse":Ga=true;R({element:"ellipse",curStyles:true,attr:{cx:F,cy:J,rx:0,ry:0,id:ja(),opacity:M.opacity/2}});break;case "text":Ga=true;R({element:"text",curStyles:true,attr:{x:F,y:J,id:ja(),fill:Za.fill,"stroke-width":Za.stroke_width,"font-size":Za.font_size,"font-family":Za.font_family,
"text-anchor":"start","xml:space":"preserve",opacity:M.opacity}});break;case "path":case "pathedit":l*=s;m*=s;Ia.mouseDown(v,f,l,m);Ga=true;break;case "textedit":l*=s;m*=s;bb.mouseDown(v,f,l,m);Ga=true;break;case "rotate":Ga=true;e.undoMgr.beginUndoableChange("transform",I);document.getElementById("workarea").className="rotate"}G=lb("mouseDown",{event:v,start_x:l,start_y:m,selectedElements:I},true);$.each(G,function(U,W){if(W&&W.started)Ga=true});if(Ca)document.getElementById("workarea").className=
Ca=="resize"?v.target.style.cursor:Ca}}).mousemove(function(v){if(!(v.originalEvent.touches&&v.originalEvent.touches.length>1))if(Ga)if(!(v.button===1||e.spaceKey)){var E=I[0],J=O(v.pageX,v.pageY,ob),F=J.x*s;J=J.y*s;var f=pa(aa()),q=x=F/s,w=y=J/s;if(c.gridSnapping){x=va(x);y=va(y)}v.preventDefault();switch(Ca){case "select":if(I[0]!==null){q=x-l;var D=y-m;if(c.gridSnapping){q=va(q);D=va(D)}if(v.shiftKey){var G=Z(l,m,x,y);x=G.x;y=G.y}if(q!=0||D!=0){w=I.length;for(var L=0;L<w;++L){E=I[L];if(E==null)break;
var U=h.createSVGTransform();f=T(E);if(G){q=G.x-l;D=G.y-m}U.setTranslate(q,D);f.numberOfItems?f.replaceItem(U,0):f.appendItem(U);Ea.requestSelector(E).resize()}if(v.altKey)if(!e.addClones){e.addClones=e.cloneSelectedElements(0,0,U);e.removeClones=function(){e.addClones&&e.addClones.forEach(function(fa){fa.parentNode&&fa.parentNode.removeChild(fa);e.addClones=false})};window.addEventListener("keyup",e.removeClones)}N("transition",I)}}break;case "multiselect":q*=s;w*=s;na(sa,{x:Math.min(A,q),y:Math.min(z,
w),width:Math.abs(q-A),height:Math.abs(w-z)},100);f=[];q=[];G=nb();w=I.length;for(L=0;L<w;++L){D=G.indexOf(I[L]);if(D==-1)f.push(I[L]);else G[D]=null}w=G.length;for(L=0;L<w;++L)G[L]&&q.push(G[L]);f.length>0&&e.removeFromSelection(f);q.length>0&&sb(q);break;case "resize":f=T(E);q=(G=ma(f))?H:svgedit.utilities.getBBox(E);w=q.x;L=q.y;var W=q.width,S=q.height;q=x-l;D=y-m;if(c.gridSnapping){q=va(q);D=va(D);S=va(S);W=va(W)}if(U=ra(E)){var X=Math.sqrt(q*q+D*D);D=Math.atan2(D,q)-U*Math.PI/180;q=X*Math.cos(D);
D=X*Math.sin(D)}if(hb.indexOf("n")==-1&&hb.indexOf("s")==-1)D=0;if(hb.indexOf("e")==-1&&hb.indexOf("w")==-1)q=0;var Y=X=0,ka=S?(S+D)/S:1,za=W?(W+q)/W:1;if(hb.indexOf("n")>=0){ka=S?(S-D)/S:1;Y=S}if(hb.indexOf("w")>=0){za=W?(W-q)/W:1;X=W}q=h.createSVGTransform();D=h.createSVGTransform();W=h.createSVGTransform();if(c.gridSnapping){w=va(w);X=va(X);L=va(L);Y=va(Y)}q.setTranslate(-(w+X),-(L+Y));if(v.shiftKey)if(za==1)za=ka;else ka=za;D.setScale(za,ka);W.setTranslate(w+X,L+Y);if(G){G=U?1:0;f.replaceItem(q,
2+G);f.replaceItem(D,1+G);f.replaceItem(W,0+G)}else{G=f.numberOfItems;f.replaceItem(W,G-3);f.replaceItem(D,G-2);f.replaceItem(q,G-1)}Ea.requestSelector(E).resize();N("transition",I);break;case "zoom":q*=s;w*=s;na(sa,{x:Math.min(A*s,q),y:Math.min(z*s,w),width:Math.abs(q-A*s),height:Math.abs(w-z*s)},100);break;case "text":na(f,{x:x,y:y},1E3);break;case "line":if(c.gridSnapping){x=va(x);y=va(y)}q=x;G=y;if(v.shiftKey){G=Z(l,m,q,G);q=G.x;G=G.y}f.setAttributeNS(null,"x2",q);f.setAttributeNS(null,"y2",G);
break;case "foreignObject":case "square":case "rect":case "image":q=Math.abs(x-l);G=Math.abs(y-m);if(Ca=="square"||v.shiftKey){q=G=Math.max(q,G);w=l<x?l:l-q;L=m<y?m:m-G}else{w=Math.min(l,x);L=Math.min(m,y)}if(v.altKey){q*=2;G*=2;w=l-q/2;L=m-G/2}if(c.gridSnapping){q=va(q);G=va(G);w=va(w);L=va(L)}na(f,{width:q,height:G,x:w,y:L},1E3);break;case "circle":q=$(f).attr(["cx","cy"]);G=q.cx;w=q.cy;q=Math.sqrt((x-G)*(x-G)+(y-w)*(y-w));if(c.gridSnapping)q=va(q);f.setAttributeNS(null,"r",q);break;case "ellipse":q=
$(f).attr(["cx","cy"]);G=Math.abs(l+(x-l)/2);w=Math.abs(m+(y-m)/2);if(c.gridSnapping){x=va(x);G=va(G);y=va(y);w=va(w)}q=Math.abs(l-G);L=Math.abs(m-w);if(v.shiftKey){L=q;w=y>m?m+q:m-q}if(v.altKey){G=l;w=m;q=Math.abs(x-G);L=v.shiftKey?q:Math.abs(y-w)}f.setAttributeNS(null,"rx",q);f.setAttributeNS(null,"ry",L);f.setAttributeNS(null,"cx",G);f.setAttributeNS(null,"cy",w);break;case "fhellipse":case "fhrect":C.minx=Math.min(q,C.minx);C.maxx=Math.max(q,C.maxx);C.miny=Math.min(w,C.miny);C.maxy=Math.max(w,
C.maxy);case "fhpath":g+=+q+","+w+" ";f.setAttributeNS(null,"points",g);break;case "path":case "pathedit":x*=s;y*=s;if(c.gridSnapping){x=va(x);y=va(y);l=va(l);m=va(m)}if(v.shiftKey){if(G=svgedit.path.path){f=G.dragging?G.dragging[0]:l;G=G.dragging?G.dragging[1]:m}else{f=l;G=m}G=Z(f,G,x,y);x=G.x;y=G.y}if(sa&&sa.getAttribute("display")!=="none"){q*=s;w*=s;na(sa,{x:Math.min(A*s,q),y:Math.min(z*s,w),width:Math.abs(q-A*s),height:Math.abs(w-z*s)},100)}Ia.mouseMove(v,x,y);break;case "textedit":x*=s;y*=s;
bb.mouseMove(F,J);break;case "rotate":q=svgedit.utilities.getBBox(E);G=q.x+q.width/2;w=q.y+q.height/2;f=V(E);f=O(G,w,f);G=f.x;w=f.y;f=q.x;L=q.y;if(current_rotate_mode=="nw")f=q.x+q.width;if(current_rotate_mode=="se")L=q.y+q.height;if(current_rotate_mode=="sw"){f=q.x+q.width;L=q.y+q.height}compensation_angle=(Math.atan2(w-L,G-f)*(180/Math.PI)-90)%360;U=(Math.atan2(w-y,G-x)*(180/Math.PI)-90)%360;U+=compensation_angle;if(c.gridSnapping)U=va(U);if(v.shiftKey)U=Math.round(U/45)*45;e.setRotationAngle(U<
-180?360+U:U,true);N("transition",I)}lb("mouseMove",{event:v,mouse_x:F,mouse_y:J,selected:E})}}).click(function(v){v.preventDefault();return false}).dblclick(function(v){var E=v.target.parentNode,J=Fb(v),F=J.tagName;if(E!==K){if(F==="text"&&Ca!=="textedit"){v=O(v.pageX,v.pageY,ob);bb.select(J,v.x,v.y)}if((F==="g"||F==="a")&&ra(J)){Gb(J);J=I[0];Pa(true)}K&&Hb();E.tagName!=="g"&&E.tagName!=="a"||E===B().getCurrentLayer()||J===Ea.selectorParentGroup||Jb(J)}}).mouseup(function(v){e.addClones=false;window.removeEventListener("keyup",
e.removeClones);I=I.filter(Boolean);if(v.button!==2){var E=vb;vb=null;if(Ga){var J=O(v.pageX,v.pageY,ob),F=J.x*s;J=J.y*s;var f=F/s,q=J/s,w=pa(aa()),D=false;Ga=false;switch(Ca){case "resize":case "multiselect":if(sa!=null){sa.setAttribute("display","none");kb=[]}Ca="select";case "select":if(I[0]!=null){if(I.length==1){F=I[0];switch(F.tagName){case "g":case "use":case "image":case "foreignObject":break;default:$a.fill=F.getAttribute("fill");$a.fill_opacity=F.getAttribute("fill-opacity");$a.stroke=F.getAttribute("stroke");
$a.stroke_opacity=F.getAttribute("stroke-opacity");$a.stroke_width=F.getAttribute("stroke-width");$a.stroke_dasharray=F.getAttribute("stroke-dasharray");$a.stroke_linejoin=F.getAttribute("stroke-linejoin");$a.stroke_linecap=F.getAttribute("stroke-linecap")}if(F.tagName=="text"){Za.font_size=F.getAttribute("font-size");Za.font_family=F.getAttribute("font-family")}Ea.requestSelector(F).showGrips(true)}Da();A=A;z=z;F=Math.abs(q-z);if(F>1||F>1){v=I.length;for(F=0;F<v;++F){if(I[F]==null)break;I[F].firstChild||
Ea.requestSelector(I[F]).resize()}}else{F=v.target;if(I[0].nodeName==="path"&&I[1]==null)Ia.select(I[0]);else v.shiftKey&&E!=F&&e.removeFromSelection([F])}if(svgedit.browser.supportsNonScalingStroke())if(v=I[0]){v.removeAttribute("style");svgedit.utilities.walkTree(v,function(U){U.removeAttribute("style")})}}return;case "zoom":sa!=null&&sa.setAttribute("display","none");N("zoomed",{x:Math.min(A,f),y:Math.min(z,q),width:Math.abs(f-A),height:Math.abs(q-z),factor:v.altKey?0.5:2});return;case "fhpath":E=
w.getAttribute("points");q=E.indexOf(",");if(D=q>=0?E.indexOf(",",q+1)>=0:E.indexOf(" ",E.indexOf(" ")+1)>=0)w=Ia.smoothPolylineIntoPath(w);break;case "line":E=$(w).attr(["x1","x2","y1","y2"]);D=E.x1!=E.x2||E.y1!=E.y2;break;case "foreignObject":case "square":case "rect":case "image":E=$(w).attr(["width","height"]);D=E.width!=0||E.height!=0||Ca==="image";break;case "circle":D=w.getAttribute("r")!=0;break;case "ellipse":E=$(w).attr(["rx","ry"]);D=E.rx!=null||E.ry!=null;break;case "fhellipse":if(C.maxx-
C.minx>0&&C.maxy-C.miny>0){w=R({element:"ellipse",curStyles:true,attr:{cx:(C.minx+C.maxx)/2,cy:(C.miny+C.maxy)/2,rx:(C.maxx-C.minx)/2,ry:(C.maxy-C.miny)/2,id:aa()}});N("changed",[w]);D=true}break;case "fhrect":if(C.maxx-C.minx>0&&C.maxy-C.miny>0){w=R({element:"rect",curStyles:true,attr:{x:C.minx,y:C.miny,width:C.maxx-C.minx,height:C.maxy-C.miny,id:aa()}});N("changed",[w]);D=true}break;case "text":D=true;Qa([w]);bb.start(w);break;case "path":w=null;Ga=true;E=Ia.mouseUp(v,w,F,J);w=E.element;D=E.keep;
break;case "pathedit":D=true;w=null;Ia.mouseUp(v);break;case "textedit":D=false;w=null;bb.mouseUp(v,F,J);break;case "rotate":D=true;w=null;Ca="select";E=e.undoMgr.finishUndoableChange();E.isEmpty()||wa(E);Da();N("changed",I)}F=lb("mouseUp",{event:v,mouse_x:F,mouse_y:J},true);$.each(F,function(U,W){if(W){D=W.keep||D;w=W.element;Ga=W.started||Ga}});if(!D&&w!=null){B().releaseId(aa());w.parentNode.removeChild(w);w=null;for(F=v.target;F.parentNode.parentNode.tagName=="g";)F=F.parentNode;if((Ca!="path"||
!drawn_path)&&F.parentNode.id!="selectorParentGroup"&&F.id!="svgcanvas"&&F.id!="svgroot"){e.setMode("select");Qa([F],true)}}else if(w!=null){e.addedNew=true;v=0.2;var G;if(false.beginElement&&w.getAttribute("opacity")!=M.opacity){G=$(false).clone().attr({to:M.opacity,dur:v}).appendTo(w);try{G[0].beginElement()}catch(L){}}else v=0;setTimeout(function(){G&&G.remove();w.setAttribute("opacity",M.opacity);w.setAttribute("style","pointer-events:inherit");qa(w);if(Ca==="path")Ia.toEditMode(w);else c.selectNew&&
Qa([w],true);wa(new La(w));N("changed",[w])},v*1E3)}Ua=null}}});$(b).bind("mousewheel DOMMouseScroll",function(v){if(v.shiftKey){v.preventDefault();ob=o.getScreenCTM().inverse();var E=O(v.pageX,v.pageY,ob);E={x:E.x,y:E.y,width:0,height:0};if(v.wheelDelta)if(v.wheelDelta>=120)E.factor=2;else{if(v.wheelDelta<=-120)E.factor=0.5}else if(v.detail)if(v.detail>0)E.factor=0.5;else if(v.detail<0)E.factor=2;E.factor&&N("zoomed",E)}})})();var Eb=function(g){$(g).click(function(l){l.preventDefault()})},bb=e.textActions=
function(){function g(S){var X=J.value==="";$(J).focus();if(!arguments.length)if(X)S=0;else{if(J.selectionEnd!==J.selectionStart)return;S=J.selectionEnd}var Y;Y=w[S];X||J.setSelectionRange(S,S);F=pa("text_cursor");if(!F){F=document.createElementNS(d,"line");na(F,{id:"text_cursor",stroke:"#333","stroke-width":1});F=pa("selectorParentGroup").appendChild(F)}q||(q=setInterval(function(){var ka=F.getAttribute("display")==="none";F.setAttribute("display",ka?"inline":"none")},600));X=H(Y.x,D.y);Y=H(Y.x,
D.y+D.height);na(F,{x1:X.x,y1:X.y,x2:Y.x,y2:Y.y,visibility:"visible",display:"inline"});f&&f.setAttribute("d","M 0 0")}function l(S,X,Y){if(S===X)g(X);else{Y||J.setSelectionRange(S,X);f=pa("text_selectblock");if(!f){f=document.createElementNS(d,"path");na(f,{id:"text_selectblock",fill:"green",opacity:0.5,style:"pointer-events:none"});pa("selectorParentGroup").appendChild(f)}S=w[S];var ka=w[X];F.setAttribute("visibility","hidden");X=H(S.x,D.y);Y=H(S.x+(ka.x-S.x),D.y);var za=H(S.x,D.y+D.height);S=H(S.x+
(ka.x-S.x),D.y+D.height);na(f,{d:"M"+X.x+","+X.y+" L"+Y.x+","+Y.y+" "+S.x+","+S.y+" "+za.x+","+za.y+"z",display:"inline"})}}function m(S,X){var Y=h.createSVGPoint();Y.x=S;Y.y=X;if(w.length==1)return 0;Y=E.getCharNumAtPosition(Y);if(Y<0){Y=w.length-2;if(S<=w[0].x)Y=0}else if(Y>=w.length-2)Y=w.length-2;var ka=w[Y];S>ka.x+ka.width/2&&Y++;return Y}function A(S,X,Y){var ka=J.selectionStart;S=m(S,X);l(Math.min(ka,S),Math.max(ka,S),!Y)}function z(S,X){var Y={x:S,y:X};Y.x/=s;Y.y/=s;if(G){var ka=O(Y.x,Y.y,
G.inverse());Y.x=ka.x;Y.y=ka.y}return Y}function H(S,X){var Y={x:S,y:X};if(G){var ka=O(Y.x,Y.y,G);Y.x=ka.x;Y.y=ka.y}Y.x*=s;Y.y*=s;return Y}function C(S){l(0,E.textContent.length);$(this).unbind(S)}function v(S){if(W&&E){var X=O(S.pageX,S.pageY,ob);X=z(X.x*s,X.y*s);X=m(X.x,X.y);var Y=E.textContent,ka=Y.substr(0,X).replace(/[a-z0-9]+$/i,"").length;Y=Y.substr(X).match(/^[a-z0-9]+/i);l(ka,(Y?Y[0].length:0)+X);$(S.target).click(C);setTimeout(function(){$(S.target).unbind("click",C)},300)}}var E,J,F,f,
q,w=[],D,G,L,U,W;return{select:function(S,X,Y){E=S;bb.toEditMode(X,Y)},start:function(S){E=S;bb.toEditMode()},mouseDown:function(S,X,Y,ka){S=z(Y,ka);J.focus();g(m(S.x,S.y));L=Y;U=ka},mouseMove:function(S,X){var Y=z(S,X);A(Y.x,Y.y)},mouseUp:function(S,X,Y){var ka=z(X,Y);A(ka.x,ka.y,true);S.target!==E&&X<L+2&&X>L-2&&Y<U+2&&Y>U-2&&bb.toSelectMode(true)},setCursor:g,toEditMode:function(S,X){Qa([E],false);W=false;Ca="textedit";Ea.requestSelector(E).showGrips(false);Ea.requestSelector(E);bb.init();$(E).css("cursor",
"text");if(arguments.length){var Y=z(S,X);g(m(Y.x,Y.y))}else g();setTimeout(function(){W=true},300)},toSelectMode:function(S){Ca="select";clearInterval(q);q=null;f&&$(f).attr("display","none");F&&$(F).attr("visibility","hidden");$(E).css("cursor","move");if(S){Pa();$(E).css("cursor","move");N("selected",[E]);sb([E],true)}E&&!E.textContent.length&&e.deleteSelectedElements();$(J).blur();E=false},setInputElem:function(S){J=S},clear:function(){Ca=="textedit"&&bb.toSelectMode()},init:function(){if(E){if(!E.parentNode){E=
I[0];Ea.requestSelector(E).showGrips(false)}var S=E.textContent.length,X=E.getAttribute("transform");D=svgedit.utilities.getBBox(E);G=X?V(E):null;w=Array(S);J.focus();$(E).unbind("dblclick",v).dblclick(v);if(!S)var Y={x:D.x+D.width/2,width:0};for(X=0;X<S;X++){var ka=E.getStartPositionOfChar(X);Y=E.getEndPositionOfChar(X);if(!svgedit.browser.supportsGoodTextCharPos()){var za=e.contentW*s;ka.x-=za;Y.x-=za;ka.x/=s;Y.x/=s}w[X]={x:ka.x,y:D.y,width:Y.x-ka.x,height:D.height}}w.push({x:Y.x,width:0});l(J.selectionStart,
J.selectionEnd,true)}}}}(),Ia=e.pathActions=function(){var g=false,l,m,A;svgedit.path.Path.prototype.endChanges=function(C){if(svgedit.browser.isWebkit()){var v=this.elem;v.setAttribute("d",Ia.convertPath(v))}C=new Ja(this.elem,{d:this.last_d},C);wa(C);N("changed",[this.elem])};svgedit.path.Path.prototype.addPtsToSelection=function(C){$.isArray(C)||(C=[C]);for(var v=0;v<C.length;v++){var E=C[v],J=this.segs[E];J.ptgrip&&this.selected_pts.indexOf(E)==-1&&E>=0&&this.selected_pts.push(E)}this.selected_pts.sort();
v=this.selected_pts.length;for(C=Array(v);v--;){J=this.segs[this.selected_pts[v]];J.select(true);C[v]=J.ptgrip}Ia.canDeleteNodes=true;Ia.closed_subpath=this.subpathIsClosed(this.selected_pts[0]);N("selected",C)};var z=l=null,H=false;this.lastCtrlPoint=[0,0];return{mouseDown:function(C,v,E,J){if(Ca==="path"){mouse_x=E;mouse_y=J;E=mouse_x/s;v=mouse_y/s;J=pa("path_stretch_line");m=[E,v];if(c.gridSnapping){E=va(E);v=va(v);mouse_x=va(mouse_x);mouse_y=va(mouse_y)}if(!J){J=document.createElementNS(d,"path");
na(J,{id:"path_stretch_line",stroke:"#22C","stroke-width":"0.5",fill:"none"});J=pa("selectorParentGroup").appendChild(J)}J.setAttribute("display","inline");this.stretchy=J;var F=null;if(z){F=z.pathSegList;for(var f=F.numberOfItems,q=6/s,w=false;f;){f--;var D=F.getItem(f),G=D.x;D=D.y;if(E>=G-q&&E<=G+q&&v>=D-q&&v<=D+q){w=true;break}}q=aa();svgedit.path.removePath_(q);q=pa(q);G=F.numberOfItems;if(w){if(f<=1&&G>=2){E=F.getItem(0).x;v=F.getItem(0).y;f=svgedit.path.first_grip?svgedit.path.first_grip[0]/
s:F.getItem(0).x;w=svgedit.path.first_grip?svgedit.path.first_grip[1]/s:F.getItem(0).y;C=J.pathSegList.getItem(1);C=C.pathSegType===4?z.createSVGPathSegLinetoAbs(E,v):z.createSVGPathSegCurvetoCubicAbs(E,v,C.x1/s,C.y1/s,f,w);E=z.createSVGPathSegClosePath();F.appendItem(C);F.appendItem(E)}else if(G<3)return F=false;$(J).remove();element=q;z=null;Ga=false;if(g){svgedit.path.path.matrix&&cb(q,{},svgedit.path.path.matrix.inverse());E=q.getAttribute("d");J=$(svgedit.path.path.elem).attr("d");$(svgedit.path.path.elem).attr("d",
J+E);$(q).remove();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();svgedit.path.path.init();Ia.toEditMode(svgedit.path.path.elem);svgedit.path.path.selectPt();return false}}else{if(!$.contains(b,Fb(C))){console.log("Clicked outside canvas");return false}F=z.pathSegList.numberOfItems;f=z.pathSegList.getItem(F-1);q=f.x;f=f.y;if(C.shiftKey){v=Z(q,f,E,v);E=v.x;v=v.y}C=J.pathSegList.getItem(1);C=C.pathSegType===4?z.createSVGPathSegLinetoAbs(eb(E),eb(v)):z.createSVGPathSegCurvetoCubicAbs(eb(E),
eb(v),C.x1/s,C.y1/s,C.x2/s,C.y2/s);z.pathSegList.appendItem(C);E*=s;v*=s;J.setAttribute("d",["M",E,v,E,v].join(" "));J=svgedit.path.addCtrlGrip("1c1");C=svgedit.path.addCtrlGrip("0c2");q=svgedit.path.getCtrlLine(1);f=svgedit.path.getCtrlLine(2);J.setAttribute("cx",E);J.setAttribute("cy",v);C.setAttribute("cx",E);C.setAttribute("cy",v);q.setAttribute("x1",E);q.setAttribute("x2",E);q.setAttribute("y1",v);q.setAttribute("y2",v);f.setAttribute("x1",E);f.setAttribute("x2",E);f.setAttribute("y1",v);f.setAttribute("y2",
v);J=F;if(g)J+=svgedit.path.path.segs.length;svgedit.path.addPointGrip(J,E,v)}F=true}else{d_attr="M"+E+","+v+" ";z=R({element:"path",curStyles:true,attr:{d:d_attr,id:ja(),opacity:M.opacity/2}});J.setAttribute("d",["M",mouse_x,mouse_y,mouse_x,mouse_y].join(" "));J=g?svgedit.path.path.segs.length:0;svgedit.path.addPointGrip(J,mouse_x,mouse_y);svgedit.path.first_grip=null}}else if(svgedit.path.path){svgedit.path.path.storeD();q=C.target.id;if(q.substr(0,14)=="pathpointgrip_"){v=svgedit.path.path.cur_pt=
parseInt(q.substr(14));svgedit.path.path.dragging=[E,J];q=svgedit.path.path.segs[v];if(C.shiftKey)q.selected?svgedit.path.path.removePtFromSelection(v):svgedit.path.path.addPtsToSelection(v);else{if(svgedit.path.path.selected_pts.length<=1||!q.selected)svgedit.path.path.clearSelection();svgedit.path.path.addPtsToSelection(v)}}else if(q.indexOf("ctrlpointgrip_")==0){svgedit.path.path.dragging=[E,J];C=q.split("_")[1].split("c");v=C[0]-0;F=C=C[1]-0;f=svgedit.path.path.segs[v];svgedit.path.path.selectPt(v,
C);if(F==2){w=1;q=f.next}else{w=2;q=f.prev}if(!q)return;C=function(L,U){return Math.sqrt(Math.pow(L.x-U.x,2)+Math.pow(L.y-U.y,2))};v={x:f.item["x"+F],y:f.item["y"+F]};F=F==2?{x:f.item.x,y:f.item.y}:{x:q.item.x,y:q.item.y};f={x:q.item["x"+w],y:q.item["y"+w]};q=C(v,F);C=C(f,F);v=Math.abs(Math.round(Math.atan2(v.y-F.y,v.x-F.x)*(180/Math.PI),0)-Math.round(Math.atan2(f.y-F.y,f.x-F.x)*(180/Math.PI),0))==180;if(Math.abs(q-C)<5&&v){svgedit.path.setLinkControlPoints(true);svgedit.path.is_linked=true}else{svgedit.path.setLinkControlPoints(false);
svgedit.path.is_linked=false}}if(!svgedit.path.path.dragging){if(sa==null)sa=Ea.getRubberBandBox();na(sa,{x:E*s,y:J*s,width:0,height:0,display:"inline"},100)}}},mouseMove:function(C,v,E){H=true;var J=!C.altKey;if(Ca==="path"){if(z){var F=z.pathSegList,f=F.numberOfItems-1,q=svgedit.path.addCtrlGrip("1c1"),w=svgedit.path.addCtrlGrip("0c2");if(m){var D=w.getAttribute("cx")/s||0,G=w.getAttribute("cy")/s||0;q.setAttribute("cx",v);q.setAttribute("cy",E);q.setAttribute("display","inline");C=m[0];q=m[1];
F.getItem(f);var L=v/s,U=E/s;D=J?C+(C-L):D;J=J?q+(q-U):G;w.setAttribute("cx",D*s);w.setAttribute("cy",J*s);w.setAttribute("display","inline");w=svgedit.path.getCtrlLine(1);G=svgedit.path.getCtrlLine(2);na(w,{x1:v,y1:E,x2:C*s,y2:q*s,display:"inline"});na(G,{x1:D*s,y1:J*s,x2:C*s,y2:q*s,display:"inline"});if(f===0)A=[v,E];else{F=F.getItem(f-1);v=F.x;E=F.y;if(F.pathSegType===6){v+=v-F.x2;E+=E-F.y2}else if(A){v=A[0]/s;E=A[1]/s}svgedit.path.replacePathSeg(6,f,[C,q,this.lastCtrlPoint[0]/s,this.lastCtrlPoint[1]/
s,D,J],z)}}else if(J=this.stretchy){f=F.getItem(f);F=v;q=E;if(C.target.id==="pathpointgrip_0"&&svgedit.path.first_grip){F=svgedit.path.first_grip[0];q=svgedit.path.first_grip[1]}if(f.pathSegType===6)svgedit.path.replacePathSeg(6,1,[v,E,(this.lastCtrlPoint[0]/s||f.x+(f.x-f.x2))*s,(this.lastCtrlPoint[1]/s||f.y+(f.y-f.y2))*s,F,q],J);else A?svgedit.path.replacePathSeg(6,1,[v,E,A[0],A[1],v,E],J):svgedit.path.replacePathSeg(4,1,[v,E],J)}}}else if(svgedit.path.path.dragging){F=svgedit.path.getPointFromGrip({x:svgedit.path.path.dragging[0],
y:svgedit.path.path.dragging[1]},svgedit.path.path);C=svgedit.path.getPointFromGrip({x:v,y:E},svgedit.path.path);f=C.x-F.x;F=C.y-F.y;svgedit.path.path.dragging=[v,E];!J||!svgedit.path.is_linked?svgedit.path.setLinkControlPoints(false):svgedit.path.setLinkControlPoints(true);svgedit.path.path.dragctrl?svgedit.path.path.moveCtrl(f,F):svgedit.path.path.movePts(f,F)}else{svgedit.path.path.selected_pts=[];svgedit.path.path.eachSeg(function(){if(this.next||this.prev){var W=sa.getBBox(),S=svgedit.path.getGripPt(this);
W=svgedit.math.rectsIntersect(W,{x:S.x,y:S.y,width:0,height:0});this.select(W);W&&svgedit.path.path.selected_pts.push(this.index)}})}},mouseUp:function(C,v,E,J){var F=pa("ctrlpointgrip_1c1"),f=pa("ctrlpointgrip_0c2");this.lastCtrlPoint=F?[F.getAttribute("cx"),F.getAttribute("cy")]:[E,J];if(!svgedit.path.first_grip)svgedit.path.first_grip=f?[f.getAttribute("cx"),f.getAttribute("cy")]:[E,J];if(Ca==="path"){m=null;if(!z){v=pa(aa());Ga=false;A=null}return{keep:true,element:v}}if(svgedit.path.path.dragging){v=
svgedit.path.path.cur_pt;svgedit.path.path.dragging=false;svgedit.path.path.dragctrl=false;svgedit.path.path.update();H&&svgedit.path.path.endChanges("Move path point(s)");!C.shiftKey&&!H&&svgedit.path.path.selectPt(v)}else if(sa&&sa.getAttribute("display")!="none"){sa.setAttribute("display","none");sa.getAttribute("width")<=2&&sa.getAttribute("height")<=2&&Ia.toSelectMode(C.target)}else Ia.toSelectMode(C.target);H=false},toEditMode:function(C){svgedit.path.path=svgedit.path.getPath_(C);Ca="pathedit";
Pa();svgedit.path.path.show(true).update();svgedit.path.path.oldbbox=svgedit.utilities.getBBox(svgedit.path.path.elem);g=false},toSelectMode:function(C){var v=C==svgedit.path.path.elem;Ca="select";svgedit.path.path.show(false);l=false;Pa();svgedit.path.path.matrix&&svgedit.path.recalcRotatedPath();if(v){N("selected",[C]);sb([C],true)}},addSubPath:function(C){if(C){Ca="path";g=true}else{Ia.clear(true);Ia.toEditMode(svgedit.path.path.elem)}},select:function(C){if(l===C){Ia.toEditMode(C);Ca="pathedit"}else l=
C},reorient:function(){var C=I[0];if(C)if(ra(C)!=0){var v=new ta("Reorient path"),E={d:C.getAttribute("d"),transform:C.getAttribute("transform")};v.addSubCommand(new Ja(C,E));Pa();this.resetOrientation(C);wa(v);svgedit.path.getPath_(C).show(false).matrix=null;this.clear();sb([C],true);N("changed",I)}},clear:function(C){l=null;if(z){var v=pa(aa());$(pa("path_stretch_line")).remove();C&&$(v).remove();$(pa("pathpointgrip_container")).find("*").attr("display","none");z=A=null;Ga=false}else Ca=="pathedit"&&
this.toSelectMode();svgedit.path.path&&svgedit.path.path.init().show(false)},resetOrientation:function(C){if(C==null||C.nodeName!="path")return false;var v=T(C),E=ia(v).matrix;v.clear();C.removeAttribute("transform");v=C.pathSegList;for(var J=v.numberOfItems,F=0;F<J;++F){var f=v.getItem(F),q=f.pathSegType;if(q!=1){var w=[];$.each(["",1,2],function(D,G){var L=f["x"+G],U=f["y"+G];if(L!==undefined&&U!==undefined){L=O(L,U,E);w.splice(w.length,0,L.x,L.y)}});svgedit.path.replacePathSeg(q,F,w,C)}}a(C,E)},
zoomChange:function(){Ca=="pathedit"&&svgedit.path.path.update()},getNodePoint:function(){if(svgedit.path.path){var C=svgedit.path.path.segs[svgedit.path.path.selected_pts.length?svgedit.path.path.selected_pts[0]:1];return{x:C.item.x,y:C.item.y,type:C.type}}},linkControlPoints:function(C){svgedit.path.setLinkControlPoints(C)},clonePathNode:function(){svgedit.path.path.storeD();for(var C=svgedit.path.path.selected_pts,v=C.length,E=[];v--;){var J=C[v];svgedit.path.path.addSeg(J);E.push(J+v);E.push(J+
v+1)}svgedit.path.path.init().addPtsToSelection(E);svgedit.path.path.endChanges("Clone path node(s)")},opencloseSubPath:function(){var C=svgedit.path.path.selected_pts;if(C.length===1){var v=svgedit.path.path.elem,E=v.pathSegList,J=C[0],F=null,f=null;svgedit.path.path.eachSeg(function(G){if(this.type===2&&G<=J)f=this.item;if(G<=J)return true;if(this.type===2){F=G;return false}else if(this.type===1)return F=false});if(F==null)F=svgedit.path.path.segs.length-1;if(F!==false){var q=v.createSVGPathSegLinetoAbs(f.x,
f.y),w=v.createSVGPathSegClosePath();if(F==svgedit.path.path.segs.length){E.appendItem(q);E.appendItem(w)}else{svgedit.path.insertItemBefore(v,w,F);svgedit.path.insertItemBefore(v,q,F)}svgedit.path.path.init().selectPt(F+1)}else if(svgedit.path.path.segs[J].mate){E.removeItem(J);E.removeItem(J);svgedit.path.path.init().selectPt(J-1)}else{for(C=0;C<E.numberOfItems;C++){var D=E.getItem(C);if(D.pathSegType===2)q=C;else if(C===J)E.removeItem(q);else if(D.pathSegType===1&&J<C){w=C-1;E.removeItem(C);break}}for(C=
J-q-1;C--;)svgedit.path.insertItemBefore(v,E.getItem(q),w);v=E.getItem(q);svgedit.path.replacePathSeg(2,q,[v.x,v.y]);C=J;svgedit.path.path.init().selectPt(0)}}},deletePathNode:function(){if(Ia.canDeleteNodes){svgedit.path.path.storeD();for(var C=svgedit.path.path.selected_pts,v=C.length;v--;)svgedit.path.path.deleteSeg(C[v]);var E=function(){var J=svgedit.path.path.elem.pathSegList,F=J.numberOfItems,f=function(D,G){for(;G--;)J.removeItem(D)};if(F<=1)return true;for(;F--;){var q=J.getItem(F);if(q.pathSegType===
1){q=J.getItem(F-1);var w=J.getItem(F-2);if(q.pathSegType===2){f(F-1,2);E();break}else if(w.pathSegType===2){f(F-2,3);E();break}}else if(q.pathSegType===2)if(F>0){q=J.getItem(F-1).pathSegType;if(q===2){f(F-1,1);E();break}else if(q===1&&J.numberOfItems-1===F){f(F,1);E();break}}}return false};E();if(svgedit.path.path.elem.pathSegList.numberOfItems<=1){e.setMode("select");e.deleteSelectedElements()}else{svgedit.path.path.init();svgedit.path.path.clearSelection();if(window.opera){C=$(svgedit.path.path.elem);
C.attr("d",C.attr("d"))}svgedit.path.path.endChanges("Delete path node(s)")}}},smoothPolylineIntoPath:function(C){var v=C.points,E=v.numberOfItems;if(E>=4){var J=v.getItem(0),F=null;C=[];C.push(["M",J.x,",",J.y," C"].join(""));for(var f=1;f<=E-4;f+=3){var q=v.getItem(f),w=v.getItem(f+1),D=v.getItem(f+2);if(F)if((J=svgedit.path.smoothControlPoints(F,q,J))&&J.length==2){q=C[C.length-1].split(",");q[2]=J[0].x;q[3]=J[0].y;C[C.length-1]=q.join(",");q=J[1]}C.push([q.x,q.y,w.x,w.y,D.x,D.y].join(","));J=
D;F=w}for(C.push("L");f<E;++f){w=v.getItem(f);C.push([w.x,w.y].join(","))}C=C.join(" ");C=R({element:"path",curStyles:true,attr:{id:aa(),d:C,fill:"none"}})}return C},setSegType:function(C){svgedit.path.path.setSegType(C)},moveNode:function(C,v){var E=svgedit.path.path.selected_pts;if(E.length){svgedit.path.path.storeD();E=svgedit.path.path.segs[E[0]];var J={x:0,y:0};J[C]=v-E.item[C];E.move(J.x,J.y);svgedit.path.path.endChanges("Move path point")}},fixEnd:function(C){for(var v=C.pathSegList,E=v.numberOfItems,
J,F=0;F<E;++F){var f=v.getItem(F);if(f.pathSegType===2)J=f;if(f.pathSegType===1){f=v.getItem(F-1);if(f.x!=J.x||f.y!=J.y){v=C.createSVGPathSegLinetoAbs(J.x,J.y);svgedit.path.insertItemBefore(C,v,F);Ia.fixEnd(C);break}}}svgedit.browser.isWebkit()&&C.setAttribute("d",Ia.convertPath(C))},convertPath:function(C,v){for(var E=C.pathSegList,J=E.numberOfItems,F=0,f=0,q="",w=null,D=0;D<J;++D){var G=E.getItem(D),L=G.x||0,U=G.y||0,W=G.x1||0,S=G.y1||0,X=G.x2||0,Y=G.y2||0,ka=G.pathSegType,za=Ma[ka]["to"+(v?"Lower":
"Upper")+"Case"](),fa=function(Aa,xa,ya){xa=xa?" "+xa.join(" "):"";ya=ya?" "+svgedit.units.shortFloat(ya):"";$.each(Aa,function(Ha,ab){Aa[Ha]=svgedit.units.shortFloat(ab)});q+=za+Aa.join(" ")+xa+ya};switch(ka){case 1:q+="z";break;case 12:L-=F;case 13:if(v){F+=L;za="l"}else{L+=F;F=L;za="L"}fa([[L,f]]);break;case 14:U-=f;case 15:if(v){f+=U;za="l"}else{U+=f;f=U;za="L"}fa([[F,U]]);break;case 2:case 4:case 18:L-=F;U-=f;case 5:case 3:if(w&&E.getItem(D-1).pathSegType===1&&!v){F=w[0];f=w[1]}case 19:if(v){F+=
L;f+=U}else{L+=F;U+=f;F=L;f=U}if(ka===3)w=[F,f];fa([[L,U]]);break;case 6:L-=F;W-=F;X-=F;U-=f;S-=f;Y-=f;case 7:if(v){F+=L;f+=U}else{L+=F;W+=F;X+=F;U+=f;S+=f;Y+=f;F=L;f=U}fa([[W,S],[X,Y],[L,U]]);break;case 8:L-=F;W-=F;U-=f;S-=f;case 9:if(v){F+=L;f+=U}else{L+=F;W+=F;U+=f;S+=f;F=L;f=U}fa([[W,S],[L,U]]);break;case 10:L-=F;U-=f;case 11:if(v){F+=L;f+=U}else{L+=F;U+=f;F=L;f=U}fa([[G.r1,G.r2]],[G.angle,G.largeArcFlag?1:0,G.sweepFlag?1:0],[L,U]);break;case 16:L-=F;X-=F;U-=f;Y-=f;case 17:if(v){F+=L;f+=U}else{L+=
F;X+=F;U+=f;Y+=f;F=L;f=U}fa([[X,Y],[L,U]])}}return q}}}(),Ob=this.removeUnusedDefElems=function(){var g=o.getElementsByTagNameNS(d,"defs");if(!g||!g.length)return 0;for(var l=[],m=0,A=["fill","stroke","filter","marker-start","marker-mid","marker-end"],z=A.length,H=o.getElementsByTagNameNS(d,"*"),C=H.length,v=0;v<C;v++){for(var E=H[v],J=0;J<z;J++)if(E){var F=ha(E.getAttribute(A[J]));F&&l.push(F.substr(1))}(E=la(E))&&E.indexOf("#")===0&&l.push(E.substr(1))}g=$(g).find("linearGradient, radialGradient, filter, marker, svg, symbol");
defelem_ids=[];for(v=g.length;v--;){A=g[v];z=A.id;if(l.indexOf(z)<0){tb[z]=A;A.parentNode.removeChild(A);m++}}return m};this.svgCanvasToString=function(){for(;Ob()>0;);Ia.clear(true);$.each(o.childNodes,function(m,A){m&&A.nodeType===8&&A.data.indexOf("Created with")>=0&&o.insertBefore(A,o.firstChild)});if(K){Hb();Qa([K])}$("#canvasGrid").attr("display","none");var g=[];$(o).find("g:data(gsvg)").each(function(){for(var m=this.attributes,A=m.length,z=0;z<A;z++)if(m[z].nodeName=="id"||m[z].nodeName==
"style")A--;if(A<=0){m=this.firstChild;g.push(m);$(this).replaceWith(m)}});var l=this.svgToString(o,0);g.length&&$(g).each(function(){xb(this)});return l};this.svgToString=function(g,l){var m=[],A=svgedit.utilities.toXml,z=c.baseUnit,H=RegExp("^-?[\\d\\.]+"+z+"$");if(g){qa(g);var C=g.attributes,v,E,J=g.childNodes;for(E=0;E<l;E++)m.push(" ");m.push("<");m.push(g.nodeName);if(g.id==="svgcontent"){E=Ab();if(z!=="px"){E.w=svgedit.units.convertUnit(E.w,z)+z;E.h=svgedit.units.convertUnit(E.h,z)+z}m.push(' width="'+
E.w+'" height="'+E.h+'" xmlns="'+d+'"');var F={};$(g).find("*").andSelf().each(function(){$.each(this.attributes,function(D,G){var L=G.namespaceURI;if(L&&!F[L]&&Ka[L]!=="xmlns"&&Ka[L]!=="xml"){F[L]=true;m.push(" xmlns:"+Ka[L]+'="'+L+'"')}})});E=C.length;for(z=["width","height","xmlns","x","y","viewBox","id","overflow"];E--;){v=C.item(E);var f=A(v.nodeValue);if(v.nodeName.indexOf("xmlns:")!==0)if(f!=""&&z.indexOf(v.localName)==-1)if(!v.namespaceURI||Ka[v.namespaceURI]){m.push(" ");m.push(v.nodeName);
m.push('="');m.push(f);m.push('"')}}}else{if(g.nodeName==="defs"&&!g.firstChild)return;var q=["-moz-math-font-style","_moz-math-font-style"];for(E=C.length-1;E>=0;E--){v=C.item(E);f=A(v.nodeValue);if(!(q.indexOf(v.localName)>=0))if(f!="")if(f.indexOf("pointer-events")!==0)if(!(v.localName==="class"&&f.indexOf("se_")===0)){m.push(" ");if(v.localName==="d")f=Ia.convertPath(g,true);if(isNaN(f)){if(H.test(f))f=svgedit.units.shortFloat(f)+z}else f=svgedit.units.shortFloat(f);if(db.apply&&g.nodeName===
"image"&&v.localName==="href"&&db.images&&db.images==="embed"){var w=Ya[f];if(w)f=w}if(!v.namespaceURI||v.namespaceURI==d||Ka[v.namespaceURI]){m.push(v.nodeName);m.push('="');m.push(f);m.push('"')}}}}if(g.hasChildNodes()){m.push(">");l++;C=false;for(E=0;E<J.length;E++){z=J.item(E);switch(z.nodeType){case 1:m.push("\n");m.push(this.svgToString(J.item(E),l));break;case 3:z=z.nodeValue.replace(/^\s+|\s+$/g,"");if(z!=""){C=true;m.push(A(z)+"")}break;case 4:m.push("\n");m.push(Array(l+1).join(" "));m.push("<![CDATA[");
m.push(z.nodeValue);m.push("]]\>");break;case 8:m.push("\n");m.push(Array(l+1).join(" "));m.push("<!--");m.push(z.data);m.push("--\>")}}l--;if(!C){m.push("\n");for(E=0;E<l;E++)m.push(" ")}m.push("</");m.push(g.nodeName);m.push(">")}else m.push("/>")}return m.join("")};this.embedImage=function(g,l){$(new Image).load(function(){var m=document.createElement("canvas");m.width=this.width;m.height=this.height;m.getContext("2d").drawImage(this,0,0);try{var A=";svgedit_url="+encodeURIComponent(g);A=m.toDataURL().replace(";base64",
A+";base64");Ya[g]=A}catch(z){Ya[g]=false}Ba=g;l&&l(Ya[g])}).attr("src",g)};this.setGoodImage=function(g){Ba=g};this.open=function(){};this.save=function(g){Pa();g&&$.extend(db,g);db.apply=true;g=this.svgCanvasToString();if(svgedit.browser.supportsBlobs()){g=new Blob([g],{type:"image/svg+xml;charset=utf-8"});saveAs(g,"method-draw-image.svg",true)}else N("saved",g)};this.rasterExport=function(){Pa();var g=[],l={feGaussianBlur:Va.exportNoBlur,foreignObject:Va.exportNoforeignObject,"[stroke-dasharray]":Va.exportNoDashArray},
m=$(o);if(!("font"in $("<canvas>")[0].getContext("2d")))l.text=Va.exportNoText;$.each(l,function(A,z){m.find(A).length&&g.push(z)});l=this.svgCanvasToString();N("exported",{svg:l,issues:g})};this.getSvgString=function(){db.apply=false;return this.svgCanvasToString()};this.randomizeIds=function(){arguments.length>0&&arguments[0]==false?svgedit.draw.randomizeIds(false,B()):svgedit.draw.randomizeIds(true,B())};var Kb=this.uniquifyElems=function(g){var l={},m=["filter","linearGradient","pattern","radialGradient",
"symbol","textPath","use"];svgedit.utilities.walkTree(g,function(v){if(v.nodeType==1){if(v.id){v.id in l||(l[v.id]={elem:null,attrs:[],hrefs:[]});l[v.id].elem=v}$.each(ub,function(J,F){var f=v.getAttributeNode(F);if(f){var q=svgedit.utilities.getUrlFromAttr(f.value);if(q=q?q.substr(1):null){q in l||(l[q]={elem:null,attrs:[],hrefs:[]});l[q].attrs.push(f)}}});var E=svgedit.utilities.getHref(v);if(E&&m.indexOf(v.nodeName)>=0)if(E=E.substr(1)){E in l||(l[E]={elem:null,attrs:[],hrefs:[]});l[E].hrefs.push(v)}}});
for(var A in l)if(A){var z=l[A].elem;if(z){g=ja();z.id=g;z=l[A].attrs;for(var H=z.length;H--;){var C=z[H];C.ownerElement.setAttribute(C.name,"url(#"+g+")")}z=l[A].hrefs;for(H=z.length;H--;)svgedit.utilities.setHref(z[H],"#"+g)}}},zb=this.setUseData=function(g){var l=$(g);if(g.tagName!=="use")l=l.find("use");l.each(function(){var m=la(this).substr(1);if(m=pa(m)){$(this).data("ref",m);if(m.tagName=="symbol"||m.tagName=="svg")$(this).data("symbol",m).data("ref",m)}})},Lb=this.convertGradients=function(g){var l=
$(g).find("linearGradient, radialGradient");if(!l.length&&svgedit.browser.isWebkit())l=$(g).find("*").filter(function(){return this.tagName.indexOf("Gradient")>=0});l.each(function(){if($(this).attr("gradientUnits")==="userSpaceOnUse"){var m=$(o).find('[fill="url(#'+this.id+')"],[stroke="url(#'+this.id+')"]');if(m.length)if(m=svgedit.utilities.getBBox(m[0]))if(this.tagName==="linearGradient"){var A=$(this).attr(["x1","y1","x2","y2"]),z=this.gradientTransform.baseVal;if(z&&z.numberOfItems>0){var H=
ia(z).matrix;z=O(A.x1,A.y1,H);H=O(A.x2,A.y2,H);A.x1=z.x;A.y1=z.y;A.x2=H.x;A.y2=H.y;this.removeAttribute("gradientTransform")}$(this).attr({x1:(A.x1-m.x)/m.width,y1:(A.y1-m.y)/m.height,x2:(A.x2-m.x)/m.width,y2:(A.y2-m.y)/m.height});this.removeAttribute("gradientUnits")}}})},Pb=this.convertToGroup=function(g){g||(g=I[0]);var l=$(g),m=new ta,A;if(l.data("gsvg")){m=$(g.firstChild).attr(["x","y"]);$(g.firstChild.firstChild).unwrap();$(g).removeData("gsvg");A=T(g);var z=h.createSVGTransform();z.setTranslate(m.x,
m.y);A.appendItem(z);Ta(g);N("selected",[g])}else if(l.data("symbol")){g=l.data("symbol");A=l.attr("transform");z=l.attr(["x","y"]);var H=g.getAttribute("viewBox");if(H){H=H.split(" ");z.x-=+H[0];z.y-=+H[1]}A+=" translate("+(z.x||0)+","+(z.y||0)+")";z=l.prev();m.addSubCommand(new Ra(l[0],l[0].nextSibling,l[0].parentNode));l.remove();H=$(o).find("use:data(symbol)").length;l=k.createElementNS(d,"g");for(var C=g.childNodes,v=0;v<C.length;v++)l.appendChild(C[v].cloneNode(true));if(svgedit.browser.isGecko()){C=
$(ib()).children("linearGradient,radialGradient,pattern").clone();$(l).append(C)}A&&l.setAttribute("transform",A);A=g.parentNode;Kb(l);svgedit.browser.isGecko()&&$(ib()).append($(l).find("linearGradient,radialGradient,pattern"));l.id=ja();z.after(l);if(A){if(!H){z=g.nextSibling;A.removeChild(g);m.addSubCommand(new Ra(g,z,A))}m.addSubCommand(new La(l))}zb(l);svgedit.browser.isGecko()?Lb(ib()):Lb(l);svgedit.utilities.walkTreePost(l,function(E){try{Ta(E)}catch(J){console.log(J)}});$(l).find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=
ja()});Qa([l]);(g=Gb(l,true))&&m.addSubCommand(g);wa(m)}else console.log("Unexpected element to ungroup:",g)};this.setSvgString=function(g){try{var l=svgedit.utilities.text2xml(g);this.prepareSvg(l);var m=new ta("Change Source"),A=o.nextSibling,z=h.removeChild(o);m.addSubCommand(new Ra(z,A,h));o=k.adoptNode?k.adoptNode(l.documentElement):k.importNode(l.documentElement,true);h.appendChild(o);var H=$(o);e.current_drawing_=new svgedit.draw.Drawing(o,u);var C=B().getNonce();C?N("setnonce",C):N("unsetnonce");
H.find("image").each(function(){var G=this;Eb(G);var L=la(this);if(L.indexOf("data:")===0){var U=L.match(/svgedit_url=(.*?);/);if(U){var W=decodeURIComponent(U[1]);$(new Image).load(function(){G.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",W)}).attr("src",W)}}e.embedImage(L)});H.find("svg").each(function(){if(!$(this).closest("defs").length){Kb(this);var G=this.parentNode;if(G.childNodes.length===1&&G.nodeName==="g"){$(G).data("gsvg",this);G.id=G.id||ja()}else xb(this)}});H.find("linearGradient, radialGradient, pattern").appendTo(ib());
zb(H);Lb(H[0]);svgedit.utilities.walkTreePost(o,function(G){try{Ta(G)}catch(L){console.log(L)}});var v={id:"svgcontent",overflow:c.show_outside_canvas?"visible":"hidden"},E=false;if(H.attr("viewBox")){var J=H.attr("viewBox").split(" ");v.width=J[2];v.height=J[3]}else $.each(["width","height"],function(G,L){var U=H.attr(L);U||(U="100%");if((U+"").substr(-1)==="%")E=true;else v[L]=oa(L,U)});Bb();H.children().find("a,circle,ellipse,foreignObject,g,image,line,path,polygon,polyline,rect,svg,text,tspan,use").each(function(){if(!this.id)this.id=
ja()});if(E){var F=getStrokedBBox();v.width=F.width+F.x;v.height=F.height+F.y}if(v.width<=0)v.width=200;if(v.height<=0)v.height=200;H.attr(v);this.contentW=v.width;this.contentH=v.height;$("#canvas_width").val(this.contentW);$("#canvas_height").val(this.contentH);var f=$("#canvas_background");if(f.length){var q=f.attr("fill-opacity");q=q?parseInt(q)*100:100;fill=this.getPaint(f.attr("fill"),q,"canvas")}else fill=this.getPaint("none",100,"canvas");methodDraw.paintBox.canvas.setPaint(fill);m.addSubCommand(new La(o));
var w=H.attr(["width","height"]);m.addSubCommand(new Ja(h,w));s=1;svgedit.transformlist.resetListMap();Pa();svgedit.path.clearData();h.appendChild(Ea.selectorParentGroup);wa(m);N("changed",[o])}catch(D){console.log(D);return false}return true};this.getPaint=function(g,l,m){var A=null;if(g.indexOf("url(#")===0){g=(g=svgCanvas.getRefElem(g))?g.cloneNode(true):$("#"+m+"_color defs *")[0];A={alpha:l};A[g.tagName]=g}else A=g.indexOf("#")===0?{alpha:l,solidColor:g.substr(1)}:{alpha:l,solidColor:"none"};
return new $.jGraduate.Paint(A)};this.importSvgString=function(g){try{var l=svgedit.utilities.encode64(g.length+g).substr(0,32),m=false;if(qb[l])if($(qb[l].symbol).parents("#svgroot").length)m=true;var A=new ta("Import SVG");if(m)var z=qb[l].symbol,H=qb[l].xform;else{var C=svgedit.utilities.text2xml(g);this.prepareSvg(C);var v;v=k.adoptNode?k.adoptNode(C.documentElement):k.importNode(C.documentElement,true);Kb(v);var E=oa("width",v.getAttribute("width")),J=oa("height",v.getAttribute("height")),F=
v.getAttribute("viewBox"),f=F?F.split(" "):[0,0,E,J];for(g=0;g<4;++g)f[g]=+f[g];o.getAttribute("width");var q=+o.getAttribute("height");H=J>E?"scale("+q/3/f[3]+")":"scale("+q/3/f[2]+")";H="translate(0) "+H+" translate(0)";z=k.createElementNS(d,"symbol");var w=ib();for(svgedit.browser.isGecko()&&$(v).find("linearGradient, radialGradient, pattern").appendTo(w);v.firstChild;)z.appendChild(v.firstChild);var D=v.attributes;for(v=0;v<D.length;v++){var G=D[v];z.setAttribute(G.nodeName,G.nodeValue)}z.id=
ja();qb[l]={symbol:z,xform:H};ib().appendChild(z);A.addSubCommand(new La(z))}var L=k.createElementNS(d,"use");L.id=ja();ba(L,"#"+z.id);(K||B().getCurrentLayer()).appendChild(L);A.addSubCommand(new La(L));Pa();L.setAttribute("transform",H);Ta(L);$(L).data("symbol",z).data("ref",z);sb([L]);wa(A);N("changed",[o])}catch(U){console.log(U);return false}return true};var Bb=e.identifyLayers=function(){Hb();B().identifyLayers()};this.createLayer=function(g){var l=new ta("Create Layer");g=B().createLayer(g);
l.addSubCommand(new La(g));wa(l);Pa();N("changed",[g])};this.cloneLayer=function(g){var l=new ta("Duplicate Layer"),m=k.createElementNS(d,"g"),A=k.createElementNS(d,"title");A.textContent=g;m.appendChild(A);A=B().getCurrentLayer();$(A).after(m);A=A.childNodes;for(var z=0;z<A.length;z++){var H=A[z];H.localName!="title"&&m.appendChild(ga(H))}Pa();Bb();l.addSubCommand(new La(m));wa(l);e.setCurrentLayer(g);N("changed",[m])};this.deleteCurrentLayer=function(){var g=B().getCurrentLayer(),l=g.nextSibling,
m=g.parentNode;if(g=B().deleteCurrentLayer()){var A=new ta("Delete Layer");A.addSubCommand(new Ra(g,l,m));wa(A);Pa();N("changed",[m]);return true}return false};this.setCurrentLayer=function(g){(g=B().setCurrentLayer(svgedit.utilities.toXml(g)))&&Pa();return g};this.renameCurrentLayer=function(g){var l=B();if(l.current_layer){var m=l.current_layer;if(!e.setCurrentLayer(g)){for(var A=new ta("Rename Layer"),z=0;z<l.getNumLayers();++z)if(l.all_layers[z][1]==m)break;var H=l.getLayerName(z);l.all_layers[z][0]=
svgedit.utilities.toXml(g);var C=m.childNodes.length;for(z=0;z<C;++z){var v=m.childNodes.item(z);if(v&&v.tagName=="title"){for(;v.firstChild;)v.removeChild(v.firstChild);v.textContent=g;A.addSubCommand(new Ja(v,{"#text":H}));wa(A);N("changed",[m]);return true}}}l.current_layer=m}return false};this.setCurrentLayerPosition=function(g){var l=B();if(l.current_layer&&g>=0&&g<l.getNumLayers()){for(var m=0;m<l.getNumLayers();++m)if(l.all_layers[m][1]==l.current_layer)break;if(m==l.getNumLayers())return false;
if(m!=g){var A=null,z=l.current_layer.nextSibling;if(g>m){if(g<l.getNumLayers()-1)A=l.all_layers[g+1][1]}else A=l.all_layers[g][1];o.insertBefore(l.current_layer,A);wa(new Oa(l.current_layer,z,o));Bb();e.setCurrentLayer(l.getLayerName(g));return true}}return false};this.setLayerVisibility=function(g,l){var m=B(),A=m.getLayerVisibility(g),z=m.setLayerVisibility(g,l);if(z)wa(new Ja(z,{display:A?"inline":"none"},"Layer Visibility"));else return false;if(z==m.getCurrentLayer()){Pa();Ia.clear()}return true};
this.moveSelectedToLayer=function(g){for(var l=null,m=B(),A=0;A<m.getNumLayers();++A)if(m.getLayerName(A)==g){l=m.all_layers[A][1];break}if(!l)return false;g=new ta("Move Elements to Layer");m=I;for(A=m.length;A--;){var z=m[A];if(z){var H=z.nextSibling,C=z.parentNode;l.appendChild(z);g.addSubCommand(new Oa(z,H,C))}}wa(g);return true};this.mergeLayer=function(g){var l=new ta("Merge Layer"),m=B(),A=$(m.current_layer).prev()[0];if(A){for(l.addSubCommand(new Ra(m.current_layer,m.current_layer.nextSibling,
o));m.current_layer.firstChild;){var z=m.current_layer.firstChild;if(z.localName=="title"){l.addSubCommand(new Ra(z,z.nextSibling,m.current_layer));m.current_layer.removeChild(z)}else{var H=z.nextSibling;A.appendChild(z);l.addSubCommand(new Oa(z,H,m.current_layer))}}o.removeChild(m.current_layer);if(!g){Pa();Bb();N("changed",[o]);wa(l)}m.current_layer=A;return l}};this.mergeAllLayers=function(){var g=new ta("Merge all Layers"),l=B();for(l.current_layer=l.all_layers[l.getNumLayers()-1][1];$(o).children("g").length>
1;)g.addSubCommand(e.mergeLayer(true));Pa();Bb();N("changed",[o]);wa(g)};var Hb=this.leaveContext=function(){var g=ua.length;if(g){for(var l=0;l<g;l++){var m=ua[l],A=fb(m,"orig_opac");A!==1?m.setAttribute("opacity",A):m.removeAttribute("opacity");m.setAttribute("style","pointer-events: inherit")}ua=[];Pa(true);N("contextset",null)}K=null},Jb=this.setContext=function(g){Hb();if(typeof g==="string")g=pa(g);K=g;$(g).parentsUntil("#svgcontent").andSelf().siblings().each(function(){var l=this.getAttribute("opacity")||
1;fb(this,"orig_opac",l);this.setAttribute("opacity",l*0.33);this.setAttribute("style","pointer-events: none");ua.push(this)});Pa();N("contextset",K)};this.clear=function(){Ia.clear();Pa();e.clearSvgContentElement();e.current_drawing_=new svgedit.draw.Drawing(o);e.createLayer("Layer 1");e.undoMgr.resetUndoStack();Ea.initGroup();sa=Ea.getRubberBandBox();N("cleared")};this.linkControlPoints=Ia.linkControlPoints;this.getContentElem=function(){return o};this.getRootElem=function(){return h};this.getSelectedElems=
function(){return I};var Ab=this.getResolution=function(){var g=o.getAttribute("width")/s,l=o.getAttribute("height")/s;return{w:g,h:l,zoom:s}};this.getZoom=function(){return s};this.getVersion=function(){return"svgcanvas.js ($Rev: 2082 $)"};this.setUiStrings=function(g){$.extend(Va,g.notification)};this.setConfig=function(g){$.extend(c,g)};this.getTitle=function(g){if(g=g||I[0]){g=$(g).data("gsvg")||$(g).data("symbol")||g;g=g.childNodes;for(var l=0;l<g.length;l++)if(g[l].nodeName=="title")return g[l].textContent;
return""}};this.setGroupTitle=function(g){var l=I[0];l=$(l).data("gsvg")||l;var m=$(l).children("title"),A=new ta("Set Label");if(g.length)if(m.length){m=m[0];A.addSubCommand(new Ja(m,{"#text":m.textContent}));m.textContent=g}else{m=k.createElementNS(d,"title");m.textContent=g;$(l).prepend(m);A.addSubCommand(new La(m))}else{A.addSubCommand(new Ra(m[0],m.nextSibling,l));m.remove()}wa(A)};this.getDocumentTitle=function(){return e.getTitle(o)};this.setDocumentTitle=function(g){for(var l=o.childNodes,
m=false,A="",z=new ta("Change Image Title"),H=0;H<l.length;H++)if(l[H].nodeName=="title"){m=l[H];A=m.textContent;break}if(!m){m=k.createElementNS(d,"title");o.insertBefore(m,o.firstChild)}if(g.length)m.textContent=g;else m.parentNode.removeChild(m);z.addSubCommand(new Ja(m,{"#text":A}));wa(z)};this.getEditorNS=function(g){g&&o.setAttribute("xmlns:se","http://svg-edit.googlecode.com");return"http://svg-edit.googlecode.com"};this.setResolution=function(g,l){var m=Ab(),A=m.w;m=m.h;var z;if(g=="fit"){var H=
getStrokedBBox();if(H){z=new ta("Fit Canvas to Content");var C=rb();sb(C);var v=[],E=[];$.each(C,function(){v.push(H.x*-1);E.push(H.y*-1)});C=e.moveSelectedElements(v,E,true);z.addSubCommand(C);Pa();g=Math.round(H.width);l=Math.round(H.height)}else return false}if(g!=A||l!=m){z||(z=new ta("Change Image Dimensions"));g=oa("width",g);l=oa("height",l);o.setAttribute("width",g);o.setAttribute("height",l);this.contentW=g;this.contentH=l;z.addSubCommand(new Ja(o,{width:A,height:m}));o.setAttribute("viewBox",
[0,0,g/s,l/s].join(" "));z.addSubCommand(new Ja(o,{viewBox:["0 0",A,m].join(" ")}));wa(z);if(background=document.getElementById("canvas_background")){background.setAttribute("x",-1);background.setAttribute("y",-1);background.setAttribute("width",g+2);background.setAttribute("height",l+2)}N("changed",[o])}return[g,l]};this.getOffset=function(){return $(o).attr(["x","y"])};this.setBBoxZoom=function(g,l,m){var A=0.85,z=function(H){if(!H)return false;var C=Math.min(Math.round(l/H.width*100*A)/100,Math.round(m/
H.height*100*A)/100);e.setZoom(C);return{zoom:C,bbox:H}};if(typeof g=="object"){g=g;if(g.width==0||g.height==0){e.setZoom(g.zoom?g.zoom:s*g.factor);return{zoom:s,bbox:g}}return z(g)}switch(g){case "selection":if(!I[0])return;g=$.map(I,function(H){if(H)return H});g=getStrokedBBox(g);break;case "canvas":g=Ab();A=0.95;g={width:g.w,height:g.h,x:0,y:0};break;case "content":g=getStrokedBBox();break;case "layer":g=getStrokedBBox(rb(B().getCurrentLayer()));break;default:return}return z(g)};this.setZoom=function(g){var l=
Ab();o.setAttribute("viewBox","0 0 "+l.w/g+" "+l.h/g);s=g;$.each(I,function(m,A){A&&Ea.requestSelector(A).resize()});Ia.zoomChange();lb("zoomChanged",g)};this.getMode=function(){return Ca};this.setMode=function(g){Ia.clear();bb.clear();$("#workarea").attr("class",g);$a=I[0]&&I[0].nodeName=="text"?Za:M;Ca=g};this.getColor=function(g){return $a[g]};this.setColor=function(g,l,m){M[g]=l;$a[g+"_paint"]={type:"solidColor"};for(var A=[],z=I.length;z--;){var H=I[z];if(H)if(H.tagName=="g")svgedit.utilities.walkTree(H,
function(C){C.nodeName!="g"&&A.push(C)});else if(g=="fill")H.tagName!="polyline"&&H.tagName!="line"&&A.push(H);else A.push(H)}if(A.length>0)if(m)Cb(g,l,A);else{jb(g,l,A);N("changed",A)}};var ib=function(){var g=o.getElementsByTagNameNS(d,"defs");if(g.length>0)g=g[0];else{g=k.createElementNS(d,"defs");o.firstChild?o.insertBefore(g,o.firstChild.nextSibling):o.appendChild(g)}return g},Mb=this.setGradient=function(g){if(!(!$a[g+"_paint"]||$a[g+"_paint"].type=="solidColor")){var l=e[g+"Grad"],m=Ib(l),
A=ib();if(m)l=m;else{l=A.appendChild(k.importNode(l,true));l.id=ja()}e.setColor(g,"url(#"+l.id+")");if(g=="canvas")(g=document.getElementById("canvas_background"))&&g.setAttribute("fill","url(#"+l.id+")")}},Ib=function(g){var l=ib();l=$(l).find("linearGradient, radialGradient");for(var m=l.length,A=["r","cx","cy","fx","fy"];m--;){var z=l[m];if(g.tagName=="linearGradient"){if(g.getAttribute("x1")!=z.getAttribute("x1")||g.getAttribute("y1")!=z.getAttribute("y1")||g.getAttribute("x2")!=z.getAttribute("x2")||
g.getAttribute("y2")!=z.getAttribute("y2"))continue}else{var H=$(g).attr(A),C=$(z).attr(A),v=false;$.each(A,function(w,D){if(H[D]!=C[D])v=true});if(v)continue}var E=g.getElementsByTagNameNS(d,"stop"),J=z.getElementsByTagNameNS(d,"stop");if(E.length==J.length){for(var F=E.length;F--;){var f=E[F],q=J[F];if(f.getAttribute("offset")!=q.getAttribute("offset")||f.getAttribute("stop-opacity")!=q.getAttribute("stop-opacity")||f.getAttribute("stop-color")!=q.getAttribute("stop-color"))break}if(F==-1)return z}}return null};
this.setPaint=function(g,l){var m=new $.jGraduate.Paint(l);this.setPaintOpacity(g,m.alpha/100,true);$a[g+"_paint"]=m;switch(m.type){case "solidColor":if(m.solidColor!="none"&&m.solidColor!="#none")this.setColor(g,"#"+m.solidColor);else{this.setColor(g,"none");document.querySelector(g=="fill"?"#fill_color rect":"#stroke_color rect").setAttribute("fill","none")}break;case "linearGradient":case "radialGradient":e[g+"Grad"]=m[m.type];Mb(g)}};this.getStrokeWidth=function(){return $a.stroke_width};this.setStrokeWidth=
function(g){if(g==0&&["line","path"].indexOf(Ca)>=0)e.setStrokeWidth(1);else{$a.stroke_width=g;for(var l=[],m=I.length;m--;){var A=I[m];if(A)A.tagName=="g"?svgedit.utilities.walkTree(A,function(z){z.nodeName!="g"&&l.push(z)}):l.push(A)}if(l.length>0){jb("stroke-width",g,l);N("changed",I)}}};this.setStrokeAttr=function(g,l){M[g.replace("-","_")]=l;for(var m=[],A=I.length;A--;){var z=I[A];if(z)z.tagName=="g"?svgedit.utilities.walkTree(z,function(H){H.nodeName!="g"&&m.push(H)}):m.push(z)}if(m.length>
0){jb(g,l,m);N("changed",I)}};this.getStyle=function(){return M};this.getOpacity=function(){return M.opacity};this.setOpacity=function(g){M.opacity=g;jb("opacity",g)};this.getFillOpacity=function(){return M.fill_opacity};this.getStrokeOpacity=function(){return M.stroke_opacity};this.setPaintOpacity=function(g,l,m){M[g+"_opacity"]=l;m?Cb(g+"-opacity",l):jb(g+"-opacity",l)};this.getBlur=function(g){var l=0;if(g)if(g.getAttribute("filter"))if(g=pa(g.id+"_blur"))l=g.firstChild.getAttribute("stdDeviation");
return l};(function(){function g(){var z=e.undoMgr.finishUndoableChange();l.addSubCommand(z);wa(l);m=l=null}var l=null,m=null,A=false;e.setBlurNoUndo=function(z){if(m)if(z===0){Cb("filter","");A=true}else{var H=I[0];A&&Cb("filter","url(#"+H.id+"_blur)");if(svgedit.browser.isWebkit()){H.removeAttribute("filter");H.setAttribute("filter","url(#"+H.id+"_blur)")}Cb("stdDeviation",z,[m.firstChild]);e.setBlurOffsets(m,z)}else e.setBlur(z)};e.setBlurOffsets=function(z,H){if(H>3)na(z,{x:"-50%",y:"-50%",width:"200%",
height:"200%"},100);else if(!svgedit.browser.isWebkit()){z.removeAttribute("x");z.removeAttribute("y");z.removeAttribute("width");z.removeAttribute("height")}};e.setBlur=function(z,H){if(l)g();else{var C=I[0],v=C.id;m=pa(v+"_blur");z-=0;var E=new ta;if(m){if(z===0)m=null}else{var J=R({element:"feGaussianBlur",attr:{"in":"SourceGraphic",stdDeviation:z}});m=R({element:"filter",attr:{id:v+"_blur"}});m.appendChild(J);ib().appendChild(m);E.addSubCommand(new La(m))}J={filter:C.getAttribute("filter")};if(z===
0){C.removeAttribute("filter");E.addSubCommand(new Ja(C,J))}else{jb("filter","url(#"+v+"_blur)");E.addSubCommand(new Ja(C,J));e.setBlurOffsets(m,z);l=E;e.undoMgr.beginUndoableChange("stdDeviation",[m?m.firstChild:null]);if(H){e.setBlurNoUndo(z);g()}}}}})();this.getBold=function(){var g=true;I.filter(Boolean).forEach(function(l){if(l.getAttribute("font-weight")!="bold")g=false});return g};this.setBold=function(g){var l=I.filter(Boolean);l.forEach(function(m){if(m!=null&&m.tagName=="text")jb("font-weight",
g?"bold":"normal")});l[0].textContent||bb.setCursor()};this.getItalic=function(){var g=true;I.filter(Boolean).forEach(function(l){if(l.getAttribute("font-style")!="italic")g=false});return g};this.setItalic=function(g){var l=I.filter(Boolean);l.forEach(function(m){if(m!=null&&m.tagName=="text")jb("font-style",g?"italic":"normal")});l[0].textContent||bb.setCursor()};this.getFontFamily=function(){return Za.font_family};this.setFontFamily=function(g){Za.font_family=g;jb("font-family",g);I[0]&&!I[0].textContent&&
bb.setCursor()};this.setFontColor=function(g){Za.fill=g;jb("fill",g)};this.getFontSize=function(){return Za.fill};this.getFontSize=function(){return Za.font_size};this.setFontSize=function(g){Za.font_size=g;jb("font-size",g);I[0].textContent||bb.setCursor()};this.getText=function(){var g=I[0];if(g==null)return"";return g.textContent};this.setTextContent=function(g){jb("#text",g);bb.init(g);bb.setCursor()};this.setImageURL=function(g){var l=I[0];if(l){var m=$(l).attr(["width","height"]);m=!m.width||
!m.height;var A=la(l);if(A!==g)m=true;else if(!m)return;var z=new ta("Change Image URL");ba(l,g);z.addSubCommand(new Ja(l,{"#href":A}));m?$(new Image).load(function(){var H=$(l).attr(["width","height"]);$(l).attr({width:this.width,height:this.height});Ea.requestSelector(l).resize();z.addSubCommand(new Ja(l,H));wa(z);N("changed",[l])}).attr("src",g):wa(z)}};this.setLinkURL=function(g){var l=I[0];if(l){if(l.tagName!=="a"){l=$(l).parents("a");if(l.length)l=l[0];else return}var m=la(l);if(m!==g){var A=
new ta("Change Link URL");ba(l,g);A.addSubCommand(new Ja(l,{"#href":m}));wa(A)}}};this.elementsAreSame=function(g){return!g.length||g[0]==null?null:I.every(function(l){return l&&I[0]?l.nodeName==I[0].nodeName:null})};this.setRectRadius=function(g){e.elementsAreSame(I)&&I[0].tagName=="rect"&&I.forEach(function(l){var m=l.getAttribute("rx");if(m!=g){l.setAttribute("rx",g);l.setAttribute("ry",g);wa(new Ja(l,{rx:m,ry:m},"Radius"));N("changed",[l])}})};this.makeHyperlink=function(g){e.groupSelectedElements("a",
g)};this.removeHyperlink=function(){e.ungroupSelectedElement()};this.setSegType=function(g){Ia.setSegType(g)};this.convertToPath=function(g,l){if(g==null)$.each(I,function(W,S){S&&e.convertToPath(S)});else{if(!l)var m=new ta("Convert element to Path");var A=l?{}:{fill:M.fill,"fill-opacity":M.fill_opacity,stroke:M.stroke,"stroke-width":M.stroke_width,"stroke-dasharray":M.stroke_dasharray,"stroke-linejoin":M.stroke_linejoin,"stroke-linecap":M.stroke_linecap,"stroke-opacity":M.stroke_opacity,opacity:M.opacity,
visibility:"hidden"};$.each(["marker-start","marker-end","marker-mid","filter","clip-path"],function(){if(g.getAttribute(this))A[this]=g.getAttribute(this)});var z=R({element:"path",attr:A}),H=g.getAttribute("transform");H&&z.setAttribute("transform",H);var C=g.id,v=g.parentNode;g.nextSibling?v.insertBefore(z,g):v.appendChild(z);var E="",J=function(W){$.each(W,function(S,X){var Y=X[1];E+=X[0];for(var ka=0;ka<Y.length;ka+=2)E+=Y[ka]+","+Y[ka+1]+" "})},F=1.81;switch(g.tagName){case "ellipse":case "circle":var f=
$(g).attr(["rx","ry","cx","cy"]),q=f.cx,w=f.cy,D=f.rx;f=f.ry;if(g.tagName=="circle")D=f=$(g).attr("r");J([["M",[q-D,w]],["C",[q-D,w-f/F,q-D/F,w-f,q,w-f]],["C",[q+D/F,w-f,q+D,w-f/F,q+D,w]],["C",[q+D,w+f/F,q+D/F,w+f,q,w+f]],["C",[q-D/F,w+f,q-D,w+f/F,q-D,w]],["Z",[]]]);break;case "path":E=g.getAttribute("d");break;case "line":f=$(g).attr(["x1","y1","x2","y2"]);E="M"+f.x1+","+f.y1+"L"+f.x2+","+f.y2;break;case "polyline":case "polygon":E="M"+g.getAttribute("points");break;case "rect":f=$(g).attr(["rx",
"ry"]);D=f.rx;f=f.ry;var G=g.getBBox();q=G.x;w=G.y;var L=G.width;G=G.height;F=4-F;if(!D&&!f)J([["M",[q,w]],["L",[q+L,w]],["L",[q+L,w+G]],["L",[q,w+G]],["L",[q,w]],["Z",[]]]);else{f||(f=D);J([["M",[q,w+f]],["C",[q,w+f/F,q+D/F,w,q+D,w]],["L",[q+L-D,w]],["C",[q+L-D/F,w,q+L,w+f/F,q+L,w+f]],["L",[q+L,w+G-f]],["C",[q+L,w+G-f/F,q+L-D/F,w+G,q+L-D,w+G]],["L",[q+D,w+G]],["C",[q+D/F,w+G,q,w+G-f/F,q,w+G-f]],["L",[q,w+f]],["Z",[]]])}break;default:z.parentNode.removeChild(z)}E&&z.setAttribute("d",E);if(l){Ia.resetOrientation(z);
m=false;try{m=z.getBBox()}catch(U){}z.parentNode.removeChild(z);return m}else{if(H){H=T(z);ma(H)&&Ia.resetOrientation(z)}m.addSubCommand(new Ra(g,g.nextSibling,v));m.addSubCommand(new La(z));Pa();g.parentNode.removeChild(g);z.setAttribute("id",C);z.removeAttribute("visibility");sb([z],true);wa(m)}}};var Cb=this.changeSelectedAttributeNoUndo=function(g,l,m){Ca=="pathedit"&&Ia.moveNode(g,l);m=m||I;for(var A=m.length,z=["g","polyline","path"];A--;){var H=m[A];if(H!=null){Ca==="textedit"&&g!=="#text"&&
H.textContent.length&&bb.toSelectMode(H);if((g==="x"||g==="y")&&z.indexOf(H.tagName)>=0){var C=getStrokedBBox([H]);e.moveSelectedElements((g==="x"?l-C.x:0)*s,(g==="y"?l-C.y:0)*s,true)}else{C=g==="#text"?H.textContent:H.getAttribute(g);if(C==null)C="";if(C!==String(l)){if(g=="#text"){svgedit.utilities.getBBox(H);H.textContent=l}else g=="#href"?ba(H,l):H.setAttribute(g,l);I.indexOf(H)>=0&&setTimeout(function(){H.parentNode&&Ea.requestSelector(H).resize()},0);C=ra(H);if(C!=0&&g!="transform")for(var v=
T(H),E=v.numberOfItems;E--;)if(v.getItem(E).type==4){v.removeItem(E);var J=svgedit.utilities.getBBox(H),F=O(J.x+J.width/2,J.y+J.height/2,ia(v).matrix);J=F.x;F=F.y;var f=h.createSVGTransform();f.setRotate(C,J,F);v.insertItemBefore(f,E);break}}}}}},jb=this.changeSelectedAttribute=function(g,l,m){m=m||I;e.undoMgr.beginUndoableChange(g,m);Cb(g,l,m);g=e.undoMgr.finishUndoableChange();g.isEmpty()||wa(g)};this.deleteSelectedElements=function(){for(var g=new ta("Delete Elements"),l=I.length,m=[],A=0;A<l;++A){var z=
I[A];if(z==null)break;var H=z.parentNode,C=z;Ea.releaseSelector(C);svgedit.path.removePath_(C.id);if(H.tagName==="a"&&H.childNodes.length===1){C=H;H=H.parentNode}var v=C.nextSibling;C=H.removeChild(C);m.push(z);I[A]=null;g.addSubCommand(new Ra(C,v,H))}g.isEmpty()||wa(g);N("changed",m);Pa()};this.cutSelectedElements=function(){for(var g=new ta("Cut Elements"),l=I.length,m=[],A=0;A<l;++A){var z=I[A];if(z==null)break;var H=z.parentNode,C=z;Ea.releaseSelector(C);svgedit.path.removePath_(C.id);var v=C.nextSibling;
C=H.removeChild(C);m.push(z);I[A]=null;g.addSubCommand(new Ra(C,v,H))}g.isEmpty()||wa(g);N("changed",m);Pa();e.clipBoard=m};this.copySelectedElements=function(){e.clipBoard=$.merge([],I)};this.pasteElements=function(){var g=e.clipBoard,l=g.length;if(l){for(var m=[],A=new ta("Paste elements");l--;){var z=g[l];if(z){var H=ga(z);if(!pa(z.id))H.id=z.id;m.push(H);(K||B().getCurrentLayer()).appendChild(H);A.addSubCommand(new La(H))}}svgCanvas.clearSelection();setTimeout(function(){Qa(m)},100);wa(A);N("changed",
m)}};this.groupSelectedElements=function(g){g||(g="g");var l="";switch(g){case "a":l="Make hyperlink";var m="";if(arguments.length>1)m=arguments[1];break;default:g="g";l="Group Elements"}l=new ta(l);var A=R({element:g,attr:{id:ja()}});g==="a"&&ba(A,m);l.addSubCommand(new La(A));for(m=I.length;m--;){var z=I[m];if(z!=null){if(z.parentNode.tagName==="a"&&z.parentNode.childNodes.length===1)z=z.parentNode;var H=z.nextSibling,C=z.parentNode;A.appendChild(z);l.addSubCommand(new Oa(z,H,C))}}l.isEmpty()||
wa(l);Qa([A],true)};var Gb=this.pushGroupProperties=function(g,l){var m=g.childNodes,A=m.length,z=g.getAttribute("transform"),H=T(g),C=ia(H).matrix,v=new ta("Push group properties"),E=0,J=ra(g),F=$(g).attr(["filter","opacity"]),f,q;for(E=0;E<A;E++){var w=m[E];if(w.nodeType===1){if(F.opacity!==null&&F.opacity!==1){w.getAttribute("opacity");var D=Math.round((w.getAttribute("opacity")||1)*F.opacity*100)/100;jb("opacity",D,[w])}if(F.filter){var G=D=this.getBlur(w);q||(q=this.getBlur(g));if(D)D=q-0+(D-
0);else if(D===0)D=q;if(G)f=Q(w.getAttribute("filter"));else if(f){f=ga(f);ib().appendChild(f)}else f=Q(F.filter);f.id=w.id+"_"+(f.firstChild.tagName==="feGaussianBlur"?"blur":"filter");jb("filter","url(#"+f.id+")",[w]);if(D){jb("stdDeviation",D,[f.firstChild]);e.setBlurOffsets(f,D)}}D=T(w);if(~w.tagName.indexOf("Gradient"))D=null;if(D)if(w.tagName!=="defs")if(H.numberOfItems){if(J&&H.numberOfItems==1){var L=H.getItem(0).matrix,U=h.createSVGMatrix();if(G=ra(w))U=D.getItem(0).matrix;var W=svgedit.utilities.getBBox(w),
S=ia(D).matrix,X=O(W.x+W.width/2,W.y+W.height/2,S);W=J+G;S=h.createSVGTransform();S.setRotate(W,X.x,X.y);L=ca(L,U,S.matrix.inverse());G&&D.removeItem(0);if(W)D.numberOfItems?D.insertItemBefore(S,0):D.appendItem(S);if(L.e||L.f){G=h.createSVGTransform();G.setTranslate(L.e,L.f);D.numberOfItems?D.insertItemBefore(G,0):D.appendItem(G)}}else{G=w.getAttribute("transform");L={};L.transform=G?G:"";G=h.createSVGTransform();L=ia(D).matrix;U=L.inverse();L=ca(U,C,L);G.setMatrix(L);D.appendItem(G)}(w=Ta(w))&&v.addSubCommand(w)}}}if(z){L=
{};L.transform=z;g.setAttribute("transform","");g.removeAttribute("transform");v.addSubCommand(new Ja(g,L))}if(l&&!v.isEmpty())return v};this.ungroupSelectedElement=function(){var g=I[0];if($(g).data("gsvg")||$(g).data("symbol"))Pb(g);else if(g.tagName==="use"){var l=pa(la(g).substr(1));$(g).data("symbol",l).data("ref",l);Pb(g)}else{l=$(g).parents("a");if(l.length)g=l[0];if(g.tagName==="g"||g.tagName==="a"){l=new ta("Ungroup Elements");var m=Gb(g,true);m&&l.addSubCommand(m);m=g.parentNode;for(var A=
g.nextSibling,z=Array(g.childNodes.length),H=0;g.firstChild;){var C=g.firstChild,v=C.nextSibling,E=C.parentNode;if(C.tagName==="title"){l.addSubCommand(new Ra(C,C.nextSibling,E));E.removeChild(C)}else{z[H++]=C=m.insertBefore(C,A);l.addSubCommand(new Oa(C,v,E))}}Pa();A=g.nextSibling;g=m.removeChild(g);l.addSubCommand(new Ra(g,A,m));l.isEmpty()||wa(l);sb(z)}}};this.moveToTopSelectedElement=function(){var g=I.filter(Boolean).reverse(),l=new ta("Move to top");g.forEach(function(m){m=m;var A=m.parentNode,
z=m.nextSibling;m=m.parentNode.appendChild(m);if(z!=m.nextSibling){l.addSubCommand(new Oa(m,z,A,"top"));N("changed",[m])}l.isEmpty()||wa(l)})};this.moveToBottomSelectedElement=function(){var g=I.filter(Boolean).reverse(),l=new ta("Move to top");g.forEach(function(m){m=m;var A=m.parentNode,z=m.nextSibling,H=m.parentNode.firstChild;if(H.tagName=="title")H=H.nextSibling;if(H.tagName=="defs")H=H.nextSibling;m=m.parentNode.insertBefore(m,H);if(z!=m.nextSibling){l.addSubCommand(new Oa(m,z,A,"bottom"));
N("changed",[m])}});l.isEmpty()||wa(l)};this.moveUpDownSelected=function(g){var l=I.filter(Boolean);g=="Down"&&l.reverse();var m=new ta("Move "+g);l.forEach(function(A){kb=[];var z,H,C=$(nb(getStrokedBBox([A]))).toArray();g=="Down"&&C.reverse();$.each(C,function(){if(H){z=this;return false}else if(this==A)H=true});if(z){C=A.parentNode;var v=A.nextSibling;$(z)[g=="Down"?"before":"after"](A);if(v!=A.nextSibling){m.addSubCommand(new Oa(A,v,C,"Move "+g));N("changed",[A])}}});m.isEmpty()||wa(m)};this.moveSelectedElements=
function(g,l,m){if(g.constructor!=Array){g/=s;l/=s}m=m||true;for(var A=new ta("position"),z=I.length;z--;){var H=I[z];if(H!=null){var C=h.createSVGTransform(),v=T(H);g.constructor==Array?C.setTranslate(g[z],l[z]):C.setTranslate(g,l);v.numberOfItems?v.insertItemBefore(C,0):v.appendItem(C);(C=Ta(H))&&A.addSubCommand(C);Ea.requestSelector(H).resize()}}if(!A.isEmpty()){m&&wa(A);N("changed",I);return A}};this.cloneSelectedElements=function(g,l,m){for(var A=new ta("Clone Elements"),z=I.length,H=0;H<z;++H){var C=
I[H];if(C==null)break}z=I.slice(0,H);this.clearSelection(true);H=z.length;for(clones=[];H--;){C=z[H];var v=ga(z[H]),E=K||B().getCurrentLayer();if(m){tlist=T(v);tlist.removeItem(m);Ta(v);E.insertBefore(v,C)}else E.appendChild(v);clones.push(v);A.addSubCommand(new La(v))}if(!A.isEmpty()){sb(z.reverse());m||this.moveSelectedElements(g,l,false);wa(A)}return clones};this.alignSelectedElements=function(g,l){var m=[],A=Number.MAX_VALUE,z=Number.MIN_VALUE,H=Number.MAX_VALUE,C=Number.MIN_VALUE,v=Number.MIN_VALUE,
E=Number.MIN_VALUE,J=I.length;if(J){for(var F=0;F<J;++F){if(I[F]==null)break;m[F]=getStrokedBBox([I[F]]);switch(l){case "smallest":if((g=="l"||g=="c"||g=="r")&&(v==Number.MIN_VALUE||v>m[F].width)||(g=="t"||g=="m"||g=="b")&&(E==Number.MIN_VALUE||E>m[F].height)){A=m[F].x;H=m[F].y;z=m[F].x+m[F].width;C=m[F].y+m[F].height;v=m[F].width;E=m[F].height}break;case "largest":if((g=="l"||g=="c"||g=="r")&&(v==Number.MIN_VALUE||v<m[F].width)||(g=="t"||g=="m"||g=="b")&&(E==Number.MIN_VALUE||E<m[F].height)){A=m[F].x;
H=m[F].y;z=m[F].x+m[F].width;C=m[F].y+m[F].height;v=m[F].width;E=m[F].height}break;default:if(m[F].x<A)A=m[F].x;if(m[F].y<H)H=m[F].y;if(m[F].x+m[F].width>z)z=m[F].x+m[F].width;if(m[F].y+m[F].height>C)C=m[F].y+m[F].height}}if(l=="page"){H=A=0;z=e.contentW;C=e.contentH}v=Array(J);E=Array(J);for(F=0;F<J;++F){if(I[F]==null)break;var f=m[F];v[F]=0;E[F]=0;switch(g){case "l":v[F]=A-f.x;break;case "c":v[F]=(A+z)/2-(f.x+f.width/2);break;case "r":v[F]=z-(f.x+f.width);break;case "t":E[F]=H-f.y;break;case "m":E[F]=
(H+C)/2-(f.y+f.height/2);break;case "b":E[F]=C-(f.y+f.height)}}this.moveSelectedElements(v,E)}};this.contentW=Ab().w;this.contentH=Ab().h;this.updateCanvas=function(g,l){h.setAttribute("width",g);h.setAttribute("height",l);var m=$("#canvasBackground")[0],A=o.getAttribute("x"),z=o.getAttribute("y"),H=g/2-this.contentW*s/2,C=l/2-this.contentH*s/2;na(o,{width:this.contentW*s,height:this.contentH*s,x:H,y:C,viewBox:"0 0 "+this.contentW+" "+this.contentH});na(m,{width:o.getAttribute("width"),height:o.getAttribute("height"),
x:H,y:C});(m=pa("background_image"))&&na(m,{width:"100%",height:"100%"});Ea.selectorParentGroup.setAttribute("transform","translate("+H+","+C+")");return{x:H,y:C,old_x:A,old_y:z,d_x:H-A,d_y:C-z}};this.setBackground=function(g,l){var m=pa("canvasBackground"),A=$(m).find("rect")[0],z=pa("background_image");A.setAttribute("fill",g);if(l){if(!z){z=k.createElementNS(d,"image");na(z,{id:"background_image",width:"100%",height:"100%",preserveAspectRatio:"xMinYMin",style:"pointer-events:none"})}ba(z,l);m.appendChild(z)}else z&&
z.parentNode.removeChild(z)};this.cycleElement=function(g){var l=I[0],m=false,A=rb(K||B().getCurrentLayer());if(A.length){if(l==null){g=g?A.length-1:0;m=A[g]}else for(var z=A.length;z--;)if(A[z]==l){g=g?z-1:z+1;if(g>=A.length)g=0;else if(g<0)g=A.length-1;m=A[g];break}Qa([m],true);N("selected",I)}};this.clear();this.getPrivateMethods=function(){return{addCommandToHistory:wa,setGradient:Mb,addSvgElementFromJson:R,assignAttributes:na,BatchCommand:ta,call:N,ChangeElementCommand:Ja,copyElem:ga,ffClone:da,
findDefs:ib,findDuplicateGradient:Ib,getElem:pa,getId:aa,getIntersectionList:nb,getMouseTarget:Fb,getNextId:ja,getPathBBox:ea,getUrlFromAttr:ha,hasMatrixTransform:ma,identifyLayers:Bb,InsertElementCommand:La,isIdentity:svgedit.math.isIdentity,logMatrix:Sa,matrixMultiply:ca,MoveElementCommand:Oa,preventClickDefault:Eb,recalculateAllSelectedDimensions:Da,recalculateDimensions:Ta,remapElement:cb,RemoveElementCommand:Ra,removeUnusedDefElems:Ob,round:eb,runExtensions:lb,sanitizeSvg:Fa,SVGEditTransformList:svgedit.transformlist.SVGTransformList,
toString:toString,transformBox:svgedit.math.transformBox,transformListToTransform:ia,transformPoint:O,walkTree:svgedit.utilities.walkTree}}};(function(){function b(){n=new WebSocket("ws://192.168.2.102:9000","echo-protocol");n.onopen=function(){console.log("socket opened")};n.onerror=function(){console.log("socket open error.");setTimeout(b,3E3)};n.onmessage=function(a){console.log(a.data)}}window.WebSocket=window.WebSocket||window.MozWebSocket;var n;b();document.addEventListener("touchstart",touchHandler,true);document.addEventListener("touchmove",touchHandler,true);document.addEventListener("touchend",touchHandler,true);document.addEventListener("touchcancel",
touchHandler,true);if(!window.methodDraw)window.methodDraw=function(a){function d(u,B){var s=c.setSvgString(u)!==false;B=B||a.noop;s?B(true):a.alert(uiStrings.notification.errorLoadingSVG,function(){B(false)})}var c,p={},e=false;curConfig={canvas_expansion:1,dimensions:[580,400],initFill:{color:"fff",opacity:1},initStroke:{width:1.5,color:"000",opacity:1},initOpacity:1,imgPath:"images/",extPath:"extensions/",jGraduatePath:"lib/jgraduate/images/",extensions:[],initTool:"select",wireframe:false,colorPickerCSS:false,
gridSnapping:false,gridColor:"#000",baseUnit:"px",snappingStep:10,showRulers:svgedit.browser.isTouch()?false:true,show_outside_canvas:false,no_save_warning:true,initFont:"Helvetica, Arial, sans-serif"};uiStrings=p.uiStrings={common:{ok:"OK",cancel:"Cancel",key_up:"Up",key_down:"Down",key_backspace:"Backspace",key_del:"Del"},layers:{layer:"Layer"},notification:{invalidAttrValGiven:"Invalid value given",noContentToFitTo:"No content to fit to",dupeLayerName:"There is already a layer named that!",enterUniqueLayerName:"Please enter a unique layer name",
enterNewLayerName:"Please enter the new layer name",layerHasThatName:"Layer already has that name",QmoveElemsToLayer:'Move selected elements to layer "%s"?',QwantToClear:"<strong>Do you want to clear the drawing?</strong>\nThis will also erase your undo history",QwantToOpen:"Do you want to open a new file?\nThis will also erase your undo history",QerrorsRevertToSource:"There were parsing errors in your SVG source.\nRevert back to original SVG source?",QignoreSourceChanges:"Ignore changes made to SVG source?",
featNotSupported:"Feature not supported",enterNewImgURL:"Enter the new image URL",defsFailOnSave:"NOTE: Due to a bug in your browser, this image may appear wrong (missing gradients or elements). It will however appear correct once actually saved.",loadingImage:"Loading image, please wait...",saveFromBrowser:'Select "Save As..." in your browser to save this image as a %s file.',noteTheseIssues:"Also note the following issues: ",unsavedChanges:"There are unsaved changes.",enterNewLinkURL:"Enter the new hyperlink URL",
errorLoadingSVG:"Error: Unable to load SVG data",URLloadFail:"Unable to load from URL",retrieving:'Retrieving "%s" ...'}};var k={},h={};p.curConfig=curConfig;p.tool_scale=1;p.setConfig=function(u){a.extend(true,curConfig,u);if(u.extensions)curConfig.extensions=u.extensions};p.setCustomHandlers=function(u){p.ready(function(){if(u.open){a('#tool_open > input[type="file"]').remove();a("#tool_open").show();c.open=u.open}if(u.save){p.show_save_warning=false;c.bind("saved",u.save)}u.pngsave&&c.bind("exported",
u.pngsave);h=u})};p.randomizeIds=function(){c.randomizeIds(arguments)};p.init=function(){(function(){var f=window.opener;if(f)try{var q=f.document.createEvent("Event");q.initEvent("methodDrawReady",true,true);f.document.documentElement.dispatchEvent(q)}catch(w){}})();a("body").toggleClass("touch",svgedit.browser.isTouch());a("#canvas_width").val(curConfig.dimensions[0]);a("#canvas_height").val(curConfig.dimensions[1]);var u=function(){a.each(curConfig.extensions,function(){var f=this;a.getScript(curConfig.extPath+
f,function(q){if(!q){q=document.createElement("script");q.src=curConfig.extPath+f;document.querySelector("head").appendChild(q)}})})};document.location.protocol==="file:"?setTimeout(u,100):u();a.svgIcons(curConfig.imgPath+"svg_edit_icons.svg",{w:27,h:27,id_match:false,no_img:true,fallback_path:curConfig.imgPath,fallback:{logo:"logo.png",select:"select.png",select_node:"select_node.png",pencil:"pencil.png",pen:"line.png",rect:"square.png",ellipse:"ellipse.png",path:"path.png",text:"text.png",image:"image.png",
zoom:"zoom.png","delete":"delete.png",spapelib:"shapelib.png",node_delete:"node_delete.png",align_left:"align-left.png",align_center:"align-center.png",align_right:"align-right.png",align_top:"align-top.png",align_middle:"align-middle.png",align_bottom:"align-bottom.png",arrow_right:"flyouth.png",arrow_down:"dropdown.gif"},placement:{"#logo":"logo","#tool_select":"select","#tool_fhpath":"pencil","#tool_line":"pen","#tool_rect,#tools_rect_show":"rect","#tool_ellipse,#tools_ellipse_show":"ellipse",
"#tool_path":"path","#tool_text,#layer_rename":"text","#tool_image":"image","#tool_zoom":"zoom","#tool_node_clone":"node_clone","#tool_node_delete":"node_delete","#tool_add_subpath":"add_subpath","#tool_openclose_path":"open_path","#tool_alignleft, #tool_posleft":"align_left","#tool_aligncenter, #tool_poscenter":"align_center","#tool_alignright, #tool_posright":"align_right","#tool_aligntop, #tool_postop":"align_top","#tool_alignmiddle, #tool_posmiddle":"align_middle","#tool_alignbottom, #tool_posbottom":"align_bottom",
"#cur_position":"align","#zoomLabel":"zoom"},resize:{"#logo .svg_icon":15,".flyout_arrow_horiz .svg_icon":5,"#fill_bg .svg_icon, #stroke_bg .svg_icon":svgedit.browser.isTouch()?24:24,".palette_item:first .svg_icon":svgedit.browser.isTouch()?30:16,"#zoomLabel .svg_icon":16,"#zoom_dropdown .svg_icon":7},callback:function(){a(".toolbar_button button > svg, .toolbar_button button > img").each(function(){a(this).parent().prepend(this)});a(".tool_button, .tool_button_current").addClass("loaded");var f=
a("#tools_left");if(f.length!=0){f.offset();f.outerHeight()}a(".tools_flyout").each(function(){var q=a("#"+this.id+"_show"),w=q.attr("data-curopt");if(!q.children("svg, img").length){w=a(w).children().clone();if(w.length){w[0].removeAttribute("style");q.append(w)}}});methodDraw.runCallbacks();setTimeout(function(){a(".flyout_arrow_horiz:empty").each(function(){a(this).append(a.getSvgIcon("arrow_right").width(5).height(5))})},1)}});a("#rulers").on("dblclick",function(f){a("#base_unit_container").css({top:f.pageY-
10,left:f.pageX-50,display:"block"})});a("#base_unit_container").on("mouseleave mouseenter",function(){t=setTimeout(function(){a("#base_unit_container").fadeOut(500)},200);event.type=="mouseover"&&clearTimeout(t)});a("#base_unit").on("change",function(){savePreferences()});p.canvas=c=new a.SvgCanvas(document.getElementById("svgcanvas"),curConfig);p.show_save_warning=false;p.paintBox={fill:null,stroke:null,canvas:null};u=navigator.platform.indexOf("Mac")>=0;var B=navigator.userAgent.indexOf("AppleWebKit")>=
0,s=u?"meta+":"ctrl+",K=c.pathActions,P=c.undoMgr,M=svgedit.utilities,I=curConfig.imgPath+"placeholder.svg",R=a("#workarea"),T=a("#cmenu_canvas"),O=null,ca=1,ma="toolbars",ia="";u||a(".shortcut").each(function(){var f=a(this).text();a(this).text(f.split("\u2318").join("Ctrl+"))});(function(){a("#dialog_container").draggable({cancel:"#dialog_content, #dialog_buttons *",containment:"window"});var f=a("#dialog_box"),q=a("#dialog_buttons"),w=function(D,G,L,U){a("#dialog_content").html("<p>"+G.replace(/\n/g,
"</p><p>")+"</p>").toggleClass("prompt",D=="prompt");q.empty();var W=a('<input type="button" value="'+uiStrings.common.ok+'">').appendTo(q);D!="alert"&&a('<input type="button" value="'+uiStrings.common.cancel+'">').appendTo(q).on("click touchstart",function(){f.hide();L(false)});if(D=="prompt"){var S=a('<input type="text">').prependTo(q);S.val(U||"");S.bind("keydown","return",function(){W.trigger("click touchstart")})}D=="process"&&W.hide();f.show();W.on("click touchstart",function(){f.hide();var X=
D=="prompt"?S.val():true;L&&L(X)}).focus();D=="prompt"&&S.focus()};a.alert=function(D,G){w("alert",D,G)};a.confirm=function(D,G){w("confirm",D,G)};a.process_cancel=function(D,G){w("process",D,G)};a.prompt=function(D,G,L){w("prompt",D,L,G)}})();var Z=function(){var f=a(".tool_button_current");if(f.length&&f[0].id!=="tool_select"){f.removeClass("tool_button_current").addClass("tool_button");a("#tool_select").addClass("tool_button_current").removeClass("tool_button")}c.setMode("select")},V=null,oa=false,
ha=false,la="",ba=function(f,q){var w=c.getResolution(),D=R;a("#svgcanvas").position();if(D=c.setBBoxZoom(q,D.width()-15,D.height()-15)){var G=D.zoom;D=D.bbox;if(G<0.001)va({value:0.1});else{typeof animatedZoom!="undefined"&&f.cancelAnimationFrame(animatedZoom);var L=Date.now(),U=G-w.zoom;a("#zoom");var W=w.zoom,S=function(){var X=(Date.now()-L)/500;X=Math.pow(X-1,3)+1;c.setZoom(W+U*X);v();if(X<1&&X>-0.9)f.animatedZoom=requestAnimationFrame(S);else{a("#zoom").val(parseInt(G*100));a("option","#zoom_select").removeAttr("selected");
a("option[value="+parseInt(G*100)+"]","#zoom_select").attr("selected","selected")}};S();c.getMode()=="zoom"&&D.width&&Z();Jb()}}};a("#cur_context_panel").delegate("a","click",function(){var f=a(this);f.attr("data-root")?c.leaveContext():c.setContext(f.text());c.clearSelection();return false});var ea=function(){p.paintBox.fill.prep();p.paintBox.stroke.prep()},ra={},pa=function(f){a.each(f,function(q,w){var D=a(q).children(),G=q+"_show",L=a(G),U=false;D.addClass("tool_button").unbind("click mousedown mouseup").each(function(X){var Y=
w[X];ra[Y.sel]=Y.fn;if(Y.isDefault)U=X;X=function(ka){var za=Y;if(ka.type==="keydown"){var fa=a(za.parent+"_show").hasClass("tool_button_current"),Aa=a(za.parent+"_show").attr("data-curopt");a.each(f[Y.parent],function(ya,Ha){if(Ha.sel==Aa)za=!ka.shiftKey||!fa?Ha:f[Y.parent][ya+1]||f[Y.parent][0]})}if(a(this).hasClass("disabled"))return false;Va(G)&&za.fn();var xa=za.icon?a.getSvgIcon(za.icon,true):a(za.sel).children().eq(0).clone();xa[0].setAttribute("width",L.width());xa[0].setAttribute("height",
L.height());L.children(":not(.flyout_arrow_horiz)").remove();L.append(xa).attr("data-curopt",za.sel)};a(this).mouseup(X);Y.key&&a(document).bind("keydown",Y.key[0]+" shift+"+Y.key[0],X)});if(U)L.attr("data-curopt",w[U].sel);else L.attr("data-curopt")||L.attr("data-curopt",w[0].sel);var W,S=a(G).position();a(q).css({left:S.left+34,top:S.top+77});L.mousedown(function(X){a("#workarea").one("mousedown",function(){a("#tools_shapelib").hide()});a("#tools_shapelib").is(":visible")&&Va(G,false);if(L.hasClass("disabled"))return false;
var Y=a(q),ka=S.left+34,za=Y.width()*-1,fa=Y.data("shown_popop")?200:0;W=setTimeout(function(){L.data("isLibrary")?Y.css("left",ka).show():Y.css("left",za).show().animate({left:ka},50);Y.data("shown_popop",true)},fa);X.preventDefault()}).mouseup(function(){clearTimeout(W);var X=a(this).attr("data-curopt");if(L.data("isLibrary")&&a(G.replace("_show","")).is(":visible"))Va(G,true);else Va(G)&&X in ra&&ra[X]()})});Ka()},na=function(f,q){return a("<div>",{"class":"tools_flyout",id:f}).appendTo("#svg_editor").append(q)},
qa=function(){a(".tools_flyout").each(function(){var f=a("#"+this.id+"_show"),q=f.offset();f=f.outerWidth();a(this).css({left:(q.left+f)*ca,top:q.top})})},Ka=function(){a(".tools_flyout").each(function(){var f=a("#"+this.id+"_show");if(!f.data("isLibrary")){var q=[];a(this).children().each(function(){q.push(this.title)});f[0].title=q.join(" / ")}})},Fa,Oa=function(f,q,w){var D=null;if(f.indexOf("url(#")===0){f=(f=c.getRefElem(f))?f.cloneNode(true):a("#"+w+"_color defs *")[0];D={alpha:q};D[f.tagName]=
f}else D=f.indexOf("#")===0?{alpha:q,solidColor:f.substr(1)}:{alpha:q,solidColor:"none"};return new a.jGraduate.Paint(D)},La=c.getResolution();if(curConfig.baseUnit!=="px"){La.w=svgedit.units.convertUnit(La.w)+curConfig.baseUnit;La.h=svgedit.units.convertUnit(La.h)+curConfig.baseUnit}var Ra=function(f){c.createLayer("background");cur_shape=c.addSvgElementFromJson({element:"rect",attr:{x:-1,y:-1,width:La.w+2,height:La.h+2,stroke:"none",id:"canvas_background",opacity:1,fill:f||"#fff",style:"pointer-events:none"}});
c.setCurrentLayer("Layer 1");c.setCurrentLayerPosition("1")};document.getElementById("canvas_background")||Ra();document.getElementById("canvas_background").getAttribute("fill");var Ja=p.setImageURL=function(f){f||(f=I);c.setImageURL(f);a("#image_url").val(f)},ta=function(){var f=V;if(f!=null&&!f.parentNode)f=null;if(oa&&oa[0]!=null&&!oa[0].parentNode)oa=false;var q=c.getCurrentDrawing().getCurrentLayerName(),w=c.getMode(),D=curConfig.baseUnit!=="px"?curConfig.baseUnit:null,G=w=="pathedit";if(G){a(".context_panel").hide();
a("#path_node_panel").show();a("#stroke_panel").hide();q=K.getNodePoint();a("#tool_add_subpath").removeClass("push_button_pressed").addClass("tool_button");a("#tool_node_delete").toggleClass("disabled",!K.canDeleteNodes);Mb("#tool_openclose_path",K.closed_subpath?"open_path":"close_path");if(q){G=a("#seg_type");if(D){q.x=svgedit.units.convertUnit(q.x);q.y=svgedit.units.convertUnit(q.y)}a("#path_node_x").val(Math.round(q.x));a("#path_node_y").val(Math.round(q.y));if(q.type){G.val(q.type).removeAttr("disabled");
a("#seg_type_label").html(q.type==4?"Straight":"Curve")}else G.val(4).attr("disabled","disabled")}a("#tools_top").removeClass("multiselected");a("#stroke_panel").hide();a("#canvas_panel").hide()}else{var L=a("#cmenu_canvas li");a(".context_panel").hide();a(".menu_item","#edit_menu").addClass("disabled");a(".menu_item","#object_menu").addClass("disabled");if(oa){oa=oa.filter(Boolean);(f=c.elementsAreSame(oa)?oa[0]:null)&&a("#tools_top").addClass("multiselected")}if(!f&&!oa){a("#tools_top").removeClass("multiselected");
a("#stroke_panel").hide();a("#canvas_panel").show()}if(f!=null){a("#stroke_panel").show();var U=f.nodeName,W=c.getRotationAngle(f);a("#angle").val(Math.round(W));W=c.getBlur(f);a("#blur").val(W);if(!G&&w!="pathedit"){a("#selected_panel").show();a(".action_selected").removeClass("disabled");var S,X;if(["g","polyline","path"].indexOf(U)>=0)if(w=c.getStrokedBBox([f])){S=w.x;X=w.y}if(D){S=svgedit.units.convertUnit(S);X=svgedit.units.convertUnit(X)}a("#"+U+"_x").val(Math.round(S));a("#"+U+"_y").val(Math.round(X));
if(U==="polyline"){a("#path_x").val(Math.round(S));a("#path_y").val(Math.round(X))}["image","text","path","g","use"].indexOf(U)==-1&&a(".action_path_convert_selected").removeClass("disabled");U==="path"&&a(".action_path_selected").removeClass("disabled")}D=null;if(Y==="a"){D=c.getHref(f);a("#g_panel").show()}if(f.parentNode.tagName==="a")if(!a(f).siblings().length){a("#a_panel").show();D=c.getHref(f.parentNode)}a("#tool_make_link, #tool_make_link").toggle(!D);D&&a("#link_url").val(D);D={g:[],a:[],
rect:["rx","width","height","x","y"],image:["width","height","x","y"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],line:["x1","y1","x2","y2"],text:["x","y"],use:[],path:[]};var Y=f.tagName;a(f).data("gsvg")&&a("#g_panel").show();if(Y=="path"||Y=="polyline")a("#path_panel").show();if(D[Y]){D=D[Y];a("#"+Y+"_panel").show();Y=="rect"?a("#cornerRadiusLabel").show():a("#cornerRadiusLabel").hide();a.each(D,function(ka,za){var fa=f.getAttribute(za);if(curConfig.baseUnit!=="px"&&f[za])fa=svgedit.units.convertUnit(f[za].baseVal.value);
var Aa=document.getElementById(Y+"_"+za);Aa.value=Math.round(fa)||0;Aa.getAttribute("data-cursor")==="true"&&a.fn.dragInput.updateCursor(Aa)});if(Y=="text"){D=f.getAttribute("font-family");document.getElementById("font_family_dropdown").selectedIndex=3;a("#text_panel").css("display","inline");a("#tool_italic").toggleClass("active",c.getItalic());a("#tool_bold").toggleClass("active",c.getBold());a("#font_family").val(D);a("#font_size").val(f.getAttribute("font-size"));a("#text").val(f.textContent);
a("#preview_font").text(D.split(",")[0].replace(/'/g,"")).css("font-family",D);c.addedNew&&setTimeout(function(){a("#text").focus().select()},100)}else if(Y=="image")Ja(c.getHref(f));else if(Y==="g"||Y==="use"){a("#container_panel").show();a(".action_group_selected").removeClass("disabled");c.getTitle()}}L[(Y==="g"?"en":"dis")+"ableContextMenuItems"]("#ungroup");L[(Y==="g"||!oa?"dis":"en")+"ableContextMenuItems"]("#group")}if(oa){a("#multiselected_panel").show();a(".action_multi_selected").removeClass("disabled");
L.enableContextMenuItems("#group").disableContextMenuItems("#ungroup")}f||L.disableContextMenuItems("#delete,#cut,#copy,#group,#ungroup,#move_front,#move_up,#move_down,#move_back");P.getUndoStackSize()>0?a("#tool_undo").removeClass("disabled"):a("#tool_undo").addClass("disabled");P.getRedoStackSize()>0?a("#tool_redo").removeClass("disabled"):a("#tool_redo").addClass("disabled");c.addedNew=false;if(f&&!G||oa){a("#selLayerNames").removeAttr("disabled").val(q);T.enableContextMenuItems("#delete,#cut,#copy,#move_front,#move_up,#move_down,#move_back")}}};
a("#text").on("focus",function(){});a("#text").on("blur",function(){});c.bind("selected",function(f,q){var w=c.getMode();w==="select"&&Z();if(w==="pathedit")return ta();V=q.length==1||q[1]==null?q[0]:null;q=q.filter(Boolean);oa=q.length>=2?q:false;if(c.elementsAreSame(oa))V=oa[0];if(V!=null){a("#multiselected_panel").hide();if(V!=null)switch(V.tagName){case "use":a(".context_panel").hide();a("#use_panel").show();break;case "image":a(".context_panel").hide();a("#image_panel").show();break;case "foreignObject":a(".context_panel").hide();
break;case "g":case "a":w=null;for(var D=V.getElementsByTagName("*"),G=0,L=D.length;G<L;G++){var U=D[G].getAttribute("stroke-width");if(G===0)w=U;else if(w!==U)w=null}a("#stroke_width").val(w===null?"0":w);ta();break;default:a("#stroke_width").val(V.getAttribute("stroke-width")||0);w=V.getAttribute("stroke-dasharray")||"none";a("option","#stroke_style").removeAttr("selected");a('#stroke_style option[value="'+w+'"]').attr("selected","selected");a("#stroke_style").trigger("change");a.fn.dragInput.updateCursor(a("#stroke_width")[0]);
a.fn.dragInput.updateCursor(a("#blur")[0])}if(V!=null){w=(V.getAttribute("opacity")||1)*100;a("#group_opacity").val(w);a.fn.dragInput.updateCursor(a("#group_opacity")[0])}oa.length&&a("#tools_top").addClass("multiselected")}else if(oa.length){a(".context_panel").hide();a("#tools_top").removeClass("multiselected");a("#multiselected_panel").show()}else{a(".context_panel").hide();a("#canvas_panel").show();a("#tools_top").removeClass("multiselected")}c.runExtensions("selectedChanged",{elems:q,selectedElement:V,
multiselected:oa})});c.bind("transition",function(f,q){var w=c.getMode(),D=q[0];if(D){oa=q.length>=2&&q[1]!=null?q:null;if(!oa)switch(w){case "rotate":w=c.getRotationAngle(D);a("#angle").val(Math.round(w));rotateCursor(w);a("#tool_reorient").toggleClass("disabled",w==0)}c.runExtensions("elementTransition",{elems:q})}});c.bind("changed",function(f,q){var w=c.getMode();w==="select"&&Z();for(var D=0;D<q.length;++D){var G=q[D];if(G&&G.tagName==="svg")v();else if(G&&V&&V.parentNode==null)V=G}p.show_save_warning=
true;ta();if(V&&w==="select"){p.paintBox.fill.update();p.paintBox.stroke.update()}c.runExtensions("elementChanged",{elems:q})});c.bind("saved",function(f,q){p.show_save_warning=false;q='<?xml version="1.0"?>\n'+q;var w=navigator.userAgent;if(~w.indexOf("MSIE"))Ab(0,true);else{var D=f.open("data:image/svg+xml;base64,"+M.encode64(q)),G=a.pref("save_notice_done");if(G!=="all"){var L=uiStrings.notification.saveFromBrowser.replace("%s","SVG");if(w.indexOf("Gecko/")!==-1)if(q.indexOf("<defs")!==-1){L+=
"\n\n"+uiStrings.notification.defsFailOnSave;a.pref("save_notice_done","all");G="all"}else a.pref("save_notice_done","part");else a.pref("save_notice_done","all");G!=="part"&&D.alert(L)}}});c.bind("exported",function(f,q){var w=q.issues;a("#export_canvas").length||a("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var D=a("#export_canvas")[0];D.width=c.contentW;D.height=c.contentH;canvg(D,q.svg,{renderCallback:function(){var G=D.toDataURL("image/png");O.location.href=G;if(a.pref("export_notice_done")!==
"all"){G=uiStrings.notification.saveFromBrowser.replace("%s","PNG");if(w.length)G+="\n\n"+uiStrings.notification.noteTheseIssues+"\n \u2022 "+w.join("\n \u2022 ");a.pref("export_notice_done","all");O.alert(G)}}})});c.bind("zoomed",ba);c.bind("contextset",function(f,q){var w="";if(q){var D="";w='<a href="#" data-root="y">'+c.getCurrentDrawing().getCurrentLayerName()+"</a>";a(q).parentsUntil("#svgcontent > g").andSelf().each(function(){if(this.id){D+=" > "+this.id;w+=this!==q?' > <a href="#">'+this.id+
"</a>":" > "+this.id}});la=D}else la=null;a("#cur_context_panel").toggle(!!q).html(w)});c.bind("extension_added",function(f,q){function w(){if(Fa){clearTimeout(Fa);Fa=null}G||(Fa=setTimeout(function(){G=true;jb(k.iconsize)},50))}var D=false,G=false,L=true,U=function(){if(q.callback&&!D&&L){D=true;q.callback()}},W=[];q.context_tools&&a.each(q.context_tools,function(za,fa){var Aa=fa.container_id?' id="'+fa.container_id+'"':"",xa=a("#"+fa.panel);xa.length||(xa=a("<div>",{id:fa.panel}).appendTo("#tools_top").hide());
switch(fa.type){case "tool_button":var ya='<div class="tool_button">'+fa.id+"</div>",Ha=a(ya).appendTo(xa);fa.events&&a.each(fa.events,function(Na,mb){a(Ha).bind(Na,mb)});break;case "select":ya="<label"+Aa+'><select id="'+fa.id+'">';a.each(fa.options,function(Na,mb){ya+='<option value="'+Na+'"'+(Na==fa.defval?" selected":"")+">"+mb+"</option>"});ya+="</select></label>";var ab=a(ya).appendTo(xa).find("select");a.each(fa.events,function(Na,mb){a(ab).bind(Na,mb)});break;case "button-select":ya='<div id="'+
fa.id+'" class="dropdown toolset" title="'+fa.title+'"><div id="cur_'+fa.id+'" class="icon_label"></div><button></button></div>';Aa=a('<ul id="'+fa.id+'_opts"></ul>').appendTo("#option_lists");fa.colnum&&Aa.addClass("optcols"+fa.colnum);a(ya).appendTo(xa).children();W.push({elem:"#"+fa.id,list:"#"+fa.id+"_opts",title:fa.title,callback:fa.events.change,cur:"#cur_"+fa.id});break;case "input":ya="<label"+Aa+'><span id="'+fa.id+'_label">'+fa.label+':</span><input id="'+fa.id+'" title="'+fa.title+'" size="'+
(fa.size||"4")+'" value="'+(fa.defval||"")+'" type="text"/></label>';var Xa=a(ya).appendTo(xa).find("input");fa.spindata&&Xa.SpinButton(fa.spindata);fa.events&&a.each(fa.events,function(Na,mb){Xa.bind(Na,mb)})}});if(q.buttons){var S={},X={},Y=q.svgicons,ka={};a.each(q.buttons,function(za,fa){for(var Aa,xa=fa.id,ya=za;a("#"+xa).length;)xa=fa.id+"_"+ ++ya;if(Y){S[xa]=fa.icon;ya=fa.svgicon?fa.svgicon:fa.id;if(fa.type=="app_menu")X["#"+xa+" > div"]=ya;else X["#"+xa]=ya}else Aa=fa.type=="menu"?"":a('<img src="'+
fa.icon+'">');var Ha,ab;switch(fa.type){case "mode_flyout":case "mode":Ha="tool_button";if(fa.cls)Ha+=" "+fa.cls;ab="#tools_left";break;case "context":Ha="tool_button";ab="#"+fa.panel;a(ab).length||a("<div>",{id:fa.panel}).appendTo("#tools_top");break;case "menu":Ha="menu_item tool_button";ab="#"+(fa.after||fa.panel);break;case "app_menu":Ha="";ab=fa.parent||"#main_menu ul";a(ab).length||a("<div>",{id:fa.panel}).appendTo("#tools_top")}var Xa=a(fa.list||fa.type=="app_menu"?"<li/>":"<div/>").attr("id",
xa).attr("title",fa.title).addClass(Ha);if(!fa.includeWith&&!fa.list){if("position"in fa)a(ab).children().eq(fa.position).before(Xa);else fa.type!="menu"||!fa.after?Xa.appendTo(ab):a(ab).after(Xa);if(fa.type=="mode_flyout"){ya=a(Xa);Ha=ya.parent();if(!ya.parent().hasClass("tools_flyout")){var Na=ya[0].id.replace("tool_","tools_"),mb=ya.clone().attr("id",Na+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));ya.before(mb);Ha=na(Na,ya);Ha.data("isLibrary",true);mb.data("isLibrary",true)}X["#"+
Na+"_show"]=fa.id;xa=ka["#"+Ha[0].id]=[{sel:"#"+xa,fn:fa.events.click,icon:fa.id,isDefault:true},yb]}else if(fa.type=="app_menu"||fa.type=="menu")Xa.append(fa.title)}else if(fa.list){Xa.addClass("push_button");a("#"+fa.list+"_opts").append(Xa);if(fa.isDefault){a("#cur_"+fa.list).append(Xa.children().clone());ya=fa.svgicon?fa.svgicon:fa.id;X["#cur_"+fa.list]=ya}}else if(fa.includeWith){ab=fa.includeWith;ya=a(ab.button);Ha=ya.parent();if(!ya.parent().hasClass("tools_flyout")){Na=ya[0].id.replace("tool_",
"tools_");mb=ya.clone().attr("id",Na+"_show").append(a("<div>",{"class":"flyout_arrow_horiz"}));ya.before(mb);Ha=na(Na,ya)}var yb=H.getButtonData(ab.button);if(ab.isDefault)X["#"+Na+"_show"]=fa.id;xa=ka["#"+Ha[0].id]=[{sel:"#"+xa,fn:fa.events.click,icon:fa.id,key:fa.key,isDefault:fa.includeWith?fa.includeWith.isDefault:0},yb];Na="position"in ab?ab.position:"last";yb=Ha.children().length;if(!isNaN(Na)&&Na>=0&&Na<yb)Ha.children().eq(Na).before(Xa);else{Ha.append(Xa);xa.reverse()}}Y||Xa.append(Aa);fa.list||
a.each(fa.events,function(Db,Nb){if(Db=="click")if(fa.type=="mode"){fa.includeWith?Xa.bind(Db,Nb):Xa.bind(Db,function(){Va(Xa)&&Nb()});if(fa.key){a(document).bind("keydown",fa.key,Nb);fa.title&&Xa.attr("title",fa.title+" ["+fa.key+"]")}}else Xa.bind(Db,Nb);else Xa.bind(Db,Nb)});pa(ka)});a.each(W,function(){Wa(this.elem,this.list,this.callback,{seticon:true})});if(Y)L=false;a.svgIcons(Y,{w:27,h:27,id_match:false,no_img:!B,fallback:S,placement:X,callback:function(){k.iconsize&&k.iconsize!="m"&&w();
L=true;U()}})}U()});c.textActions.setInputElem(a("#text")[0]);var wa='<div class="palette_item transparent" data-rgb="none"></div>                <div class="palette_item black" data-rgb="#000000"></div>                <div class="palette_item white" data-rgb="#ffffff"></div>';["#444444","#482816","#422C10","#3B2F0E","#32320F","#293414","#1F361B","#153723","#0C372C","#083734","#0E353B","#1A333F","#273141","#332D40","#3E2A3C","#462735","#4B252D","#4D2425","#4C261D","#666666","#845335","#7B572D","#6F5C2A",
"#62612C","#546433","#46673D","#396849","#306856","#2D6862","#33666C","#426373","#535F75","#645A73","#74556D","#805064","#884D58","#8B4D4B","#894F3F","#999999","#C48157","#B8874D","#A98E49","#97944B","#849854","#729C62","#619E73","#559E84","#529D94","#5B9BA2","#6D97AB","#8391AE","#9A8AAB","#AF84A3","#BF7E96","#C97A86","#CE7975","#CC7C65","#BBBBBB","#FFB27C","#FABA6F","#E6C36A","#CFCA6D","#B8D078","#A0D58A","#8CD79F","#7DD8B5","#7AD6CA","#84D3DB","#9ACEE6","#B6C7EA","#D3BEE7","#EDB6DC","#FFAFCC","#FFAAB8",
"#FFA9A2","#FFAC8D","#DDDDDD","#FFE7A2","#FFF093","#FFFA8D","#FFFF91","#EEFF9F","#D1FFB4","#B9FFCE","#A8FFE9","#A4FFFF","#B1FFFF","#CBFFFF","#EDFFFF","#FFF5FF","#FFEBFF","#FFE2FF","#FFDCEC","#FFDBD2","#FFDFB8"].forEach(function(f){wa+='<div class="palette_item" style="background-color: '+f+';" data-rgb="'+f+'"></div>'});a("#palette").append(wa);var Ea=a("#tool_angle_indicator");a("#tool_reorient");rotateCursor=function(f){f="rotate("+f+"deg)";Ea.css({"-webkit-transform":f,"-moz-transform":f,"-o-transform":f,
"-ms-transform":f,transform:f})};var va=function(f){var q=f.value/100;if(q<0.001)f.value=0.1;else{f=c.getZoom();var w=R;ba(window,{width:0,height:0,x:(w[0].scrollLeft+w.width()/2)/f,y:(w[0].scrollTop+w.height()/2)/f,zoom:q},true)}};a("#stroke_style").change(function(){c.setStrokeAttr("stroke-dasharray",a(this).val());a("#stroke_style_label").html(this.options[this.selectedIndex].text);window.opera&&a("<p/>").hide().appendTo("body").remove()});a("#seg_type").change(function(){c.setSegType(a(this).val());
a("#seg_type_label").html(this.options[this.selectedIndex].text)});a("select").change(function(){a(this).blur()});a("#font_family").change(function(){c.setFontFamily(this.value)});a("#text").keyup(function(){c.setTextContent(this.value)});changeAttribute=function(f){var q=f.getAttribute("data-attr"),w=f.getAttribute("data-multiplier")||1;w=parseFloat(w);w=f.value*w;if(!svgedit.units.isValidUnit(q,w,V)){a.alert(uiStrings.notification.invalidAttrValGiven);f.value=V.getAttribute(q);return false}c.changeSelectedAttributeNoUndo(q,
w)};picking=false;a(document).on("mouseup",function(){picking=false});a("#palette").on("mousemove mousedown touchstart touchmove",".palette_item",function(f){f.preventDefault();if(f.type=="mousedown")picking=true;if(picking){var q=a("#tool_stroke").hasClass("active"),w=q?"stroke":"fill",D=a(this).attr("data-rgb"),G=null,L=true;if(f.type=="mousedown")L=false;if(D==="transparent"||D==="initial"||D==="#none"){D="none";G=new a.jGraduate.Paint}else G=new a.jGraduate.Paint({alpha:100,solidColor:D.substr(1)});
p.paintBox[w].setPaint(G);if(q){c.setColor("stroke",D,L);D!="none"&&c.getStrokeOpacity()!=1&&c.setPaintOpacity("stroke",1)}else{c.setColor("fill",D,L);D!="none"&&c.getFillOpacity()!=1&&c.setPaintOpacity("fill",1)}}}).bind("contextmenu",function(f){f.preventDefault()});a("#toggle_stroke_tools").toggle(function(){a(".stroke_tool").css("display","table-cell");a(this).addClass("expanded");l()},function(){a(".stroke_tool").css("display","none");a(this).removeClass("expanded");l()});var Va=function(f,q){if(a(f).hasClass("disabled"))return false;
if(a(f).parent().hasClass("tools_flyout"))return true;var w=w||"normal";q||a(".tools_flyout").fadeOut(w);a("#styleoverrides").text("");a(".tool_button_current").removeClass("tool_button_current").addClass("tool_button");a(f).addClass("tool_button_current").removeClass("tool_button");return true};(function(){var f=null,q=null,w=R[0],D=false,G=false;a("#svgcanvas").on("mousemove mouseup touchend",function(L){if(D!==false){w.scrollLeft-=L.clientX-f;w.scrollTop-=L.clientY-q;f=L.clientX;q=L.clientY;if(L.type===
"mouseup"||L.type==="touchend")D=false;return false}}).on("mousedown touchmove",function(L){if(L.button===1||G===true||L.originalEvent.touches&&L.originalEvent.touches.length>=2){D=true;f=L.clientX;q=L.clientY;return false}});a(window).mouseup(function(){D=false});a(document).bind("keydown","space",function(L){L.preventDefault();c.spaceKey=G=true}).bind("keyup","space",function(L){L.preventDefault();c.spaceKey=G=false}).bind("keydown","alt",function(){c.getMode()==="zoom"&&R.addClass("out")}).bind("keyup",
"alt",function(){c.getMode()==="zoom"&&R.removeClass("out")})})();var ub=a(".menu"),fb=function(f){f.target.style.background="#fff";setTimeout(function(){f.target.style.background="#ddd"},50);setTimeout(function(){f.target.style.background="#fff"},150);setTimeout(function(){f.target.style.background="#ddd"},200);setTimeout(function(){f.target.style.background=""},200);setTimeout(function(){a("#menu_bar").removeClass("active")},220);return false};a(".menu_item").on("mousedown touchstart",function(f){fb(f)});
a("svg, body").on("mousedown  touchstart",function(f){if(!(f.target.nodeName&&f.target.nodeName.toLowerCase()==="input"))if(!a(f.target).hasClass("menu_title")&&!a(f.target).parent().hasClass("menu_title"))!a(f.target).hasClass("disabled")&&a(f.target).hasClass("menu_item")?fb(f):a("#menu_bar").removeClass("active")});a("#workarea").on("mousewheel",function(f,q,w,D){if(f.altKey||f.ctrlKey){f.preventDefault();zoom=parseInt(a("#zoom").val());a("#zoom").val(parseInt(zoom+D*(f.altKey?10:5))).change()}});
a(".menu_title").on("mousedown",function(){a("#tools_shapelib").hide();a("#menu_bar").toggleClass("active");ub.removeClass("open");a(this).parent().addClass("open")}).on("mouseover",function(){ub.removeClass("open");a(this).parent().addClass("open")});p.addDropDown=function(f,q,w){if(a(f).length!=0){var D=a(f).find("button"),G=a(f).find("ul").attr("id",a(f)[0].id+"-list");w||a("#option_lists").append(G);var L=false;w&&a(f).addClass("dropup");G.find("li").bind("mouseup",q);a(window).mouseup(function(){if(!L){D.removeClass("down");
G.hide()}L=false});D.bind("mousedown",function(){if(D.hasClass("down")){D.removeClass("down");G.hide()}else{D.addClass("down");if(!w){var U=a(f).offset();G.css({top:U.top,left:U.left-110})}G.show();L=true}}).hover(function(){L=true}).mouseout(function(){L=false})}};var Wa=function(f,q,w,D){var G=a(f);q=a(q);var L=false,U=D.dropUp;U&&a(f).addClass("dropup");q.find("li").bind("mouseup",function(){if(D.seticon){Mb("#cur_"+G[0].id,a(this).children());a(this).addClass("current").siblings().removeClass("current")}w.apply(this,
arguments)});a(window).mouseup(function(){if(!L){G.removeClass("down");q.hide();q.css({top:0,left:0})}L=false});q.height();a(f).bind("mousedown",function(){var W=a(f).offset();if(U){W.top-=q.height();W.left+=8}else W.top+=a(f).height();a(q).offset(W);if(G.hasClass("down")){G.removeClass("down");q.hide();q.css({top:0,left:0})}else{G.addClass("down");q.show();L=true;return false}}).hover(function(){L=true}).mouseout(function(){L=false});D.multiclick&&q.mousedown(function(){L=true})};a("#font_family_dropdown").change(function(){var f=
this.options[this.selectedIndex].value,q=this.options[this.selectedIndex].text;a("#preview_font").html(q).css("font-family",f);a("#font_family").val(f).change()});a("div","#position_opts").each(function(){this.addEventListener("mouseup",function(){var f=this.id.replace("tool_pos","").charAt(0);c.alignSelectedElements(f,"page")})});(function(){var f,q=function(){a(f).blur()};a("#svg_editor").find("button, select, input:not(#text)").focus(function(){f=this;ma="toolbars";R.mousedown(q)}).blur(function(){ma=
"canvas";R.unbind("mousedown",q);c.getMode()=="textedit"&&a("#text").focus()})})();var Ya=function(){Va("#tool_select")&&c.setMode("select")},Ba=function(){Va("#tool_fhpath")&&c.setMode("fhpath")},ua=function(){Va("#tool_line")&&c.setMode("line")},db=function(){Va("#tool_rect")&&c.setMode("rect")},Ga=function(){Va("#tool_ellipse")&&c.setMode("ellipse")},Ua=function(){Va("#tool_image")&&c.setMode("image")},Ca=function(){Va("#tool_zoom")&&c.setMode("zoom")},hb=function(){if(Va("#tool_zoom")){zb();Z()}},
qb=function(){Va("#tool_text")&&c.setMode("text")},Za=function(){Va("#tool_path")&&c.setMode("path")},$a=function(){if(V!=null||oa)c.deleteSelectedElements();K.getNodePoint()&&K.deletePathNode()},vb=function(){if(V!=null||oa){Qa(a("#edit_menu"));c.cutSelectedElements()}},sa=function(){if(V!=null||oa){Qa(a("#edit_menu"));c.copySelectedElements()}},kb=function(){Qa(a("#edit_menu"));var f=c.getZoom(),q=(R[0].scrollLeft+R.width()/2)/f-c.contentW;f=(R[0].scrollTop+R.height()/2)/f-c.contentH;c.pasteElements("point",
q,f)},gb=function(){if(V!=null){Qa(a("#object_menu"));c.moveToTopSelectedElement()}},tb=function(){if(V!=null){Qa(a("#object_menu"));c.moveToBottomSelectedElement()}},lb=function(){if(V!=null){Qa(a("#object_menu"));c.moveUpDownSelected("Up")}},eb=function(){if(V!=null){Qa(a("#object_menu"));c.moveUpDownSelected("Down")}},nb=function(f){if(V!=null){Qa(a("#object_menu"));c.moveUpDownSelected(f)}},rb=function(){if(V!=null){c.convertToPath();var f=c.getSelectedElems();c.selectorManager.requestSelector(f[0]).reset(f[0]);
c.selectorManager.requestSelector(f[0]).selectorRect.setAttribute("display","none");c.setMode("pathedit");K.toEditMode(f[0]);c.clearSelection();ta()}},wb=function(){V!=null&&K.reorient()},xb=function(){if(V!=null||oa)a.prompt(uiStrings.notification.enterNewLinkURL,"http://",function(f){f&&c.makeHyperlink(f)})},ga=function(f,q){if(V!=null||oa){if(curConfig.gridSnapping){var w=c.getZoom()*curConfig.snappingStep;f*=w;q*=w}a("input").blur();c.moveSelectedElements(f,q)}},aa=function(){},ja=function(){K.getNodePoint()&&
K.clonePathNode()},N=function(){K.getNodePoint()&&K.deletePathNode()},Q=function(){var f=a("#tool_add_subpath"),q=!f.hasClass("push_button_pressed");q?f.addClass("push_button_pressed").removeClass("tool_button"):f.removeClass("push_button_pressed").addClass("tool_button");K.addSubPath(q)},da=function(){K.opencloseSubPath()},Da=function(){c.cycleElement(1)},Ma=function(){c.cycleElement(0)},Sa=function(f,q){if(!(V==null||oa)){f||(q*=-1);var w=a("#angle").val()*1+q;c.setRotationAngle(w);ta()}},cb=function(){var f=
curConfig.dimensions;a.confirm(uiStrings.notification.QwantToClear,function(q){if(q){Z();c.deleteSelectedElements();c.clear();c.setResolution(f[0],f[1]);v(true);Ra();zb();ta();ea();c.runExtensions("onNewDocument")}})},pb=function(){c.setBold(!c.getBold());ta()},Ta=function(){c.setItalic(!c.getItalic());ta()},ob=function(){if(!h.pngsave){var f=uiStrings.notification.loadingImage;O=window.open("data:text/html;charset=utf-8,<title>"+f+"</title><h1>"+f+"</h1>")}window.canvg?c.rasterExport():a.getScript("canvg/rgbcolor.js",
function(){a.getScript("canvg/canvg.js",function(){c.rasterExport()})})},Pa=function(){c.open()},sb=function(){},Qa=function(f){var q=f.prev();q.css({background:"white",color:"black"});setTimeout(function(){q.removeAttr("style")},200)},Fb=function(){if(P.getUndoStackSize()>0){Qa(a("#edit_menu"));P.undo()}},Eb=function(){if(P.getRedoStackSize()>0){Qa(a("#edit_menu"));P.redo()}},bb=function(){if(oa){Qa(a("#object_menu"));c.groupSelectedElements()}else if(V){Qa(a("#object_menu"));c.ungroupSelectedElement()}},
Ia=function(){Qa(a("#edit_menu"));c.cloneSelectedElements(20,20)},Ob=function(){var f=this.id.replace("tool_align","").charAt(0);c.alignSelectedElements(f,a("#align_relative_to").val())},Kb=function(){var f=document.querySelector("#tool_stroke rect");a("#tool_stroke").toggleClass("active");a("#tool_fill").toggleClass("active");var q=document.querySelector("#tool_fill rect"),w=q.getAttribute("fill"),D=f.getAttribute("fill");f=parseFloat(f.getAttribute("stroke-opacity"));if(isNaN(f))f=100;q=parseFloat(q.getAttribute("fill-opacity"));
if(isNaN(q))q=100;D=Oa(D,f,"stroke");w=Oa(w,q,"fill");p.paintBox.fill.setPaint(D,true);p.paintBox.stroke.setPaint(w,true)},zb=function(f){var q=c.getResolution();f=f?q.zoom*f:1;a("#zoom").val(f*100);c.setZoom(f);Jb();v(true)},Lb=function(){Qa(a("#view_menu"));!a("#tool_wireframe").hasClass("push_button_pressed")?a("#tool_wireframe").addClass("push_button_pressed"):a("#tool_wireframe").removeClass("push_button_pressed");R.toggleClass("wireframe");if(!A){var f=a("#wireframe_rules");f.length?f.empty():
a('<style id="wireframe_rules"></style>').appendTo("head");Jb()}},Pb=function(){Qa(a("#view_menu"));var f=!a("#tool_snap").hasClass("push_button_pressed");f?a("#tool_snap").addClass("push_button_pressed"):a("#tool_snap").removeClass("push_button_pressed");curConfig.gridSnapping=f},Bb=function(){window.self!=window.top&&top.exit_fullscreen()},Hb=function(){Qa(a("#view_menu"));if(a("#tool_rulers").hasClass("push_button_pressed")){a("#tool_rulers").removeClass("push_button_pressed");a("#show_rulers").attr("checked",
false);curConfig.showRulers=false}else{a("#tool_rulers").addClass("push_button_pressed");a("#show_rulers").attr("checked",true);curConfig.showRulers=true}a("#rulers").toggle(!!curConfig.showRulers)},Jb=function(){if(!A){var f="#workarea.wireframe #svgcontent * { stroke-width: "+1/c.getZoom()+"px; }";a("#wireframe_rules").text(R.hasClass("wireframe")?f:"")}},Ab=function(f,q){if(!ha){Qa(a("#view_menu"));ha=true;a("#save_output_btns").toggle(!!q);a("#tool_source_back").toggle(!q);var w=ia=c.getSvgString();
a("#svg_source_textarea").val(w);a("#svg_source_editor").fadeIn();a("#svg_source_textarea").focus().select()}},ib=function(){if(ha){if(c.setSvgString(a("#svg_source_textarea").val())){c.clearSelection();g();zb();ea()}else a.confirm(uiStrings.notification.QerrorsRevertToSource,function(f){if(!f)return false;c.clearSelection();g();zb();ea()});Z()}},Mb=p.setIcon=function(f,q){var w=typeof q==="string"?a.getSvgIcon(q,true):q.clone();w?a(f).find("img").replaceWith(w):console.log("NOTE: Icon image missing: "+
q)},Ib;Ib=function(){var f=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,q=document.getElementsByTagName("script")[0],w;for(w in q.style)if(f.test(w))return w.match(f)[0];if("WebkitOpacity"in q.style)return"Webkit";if("KhtmlOpacity"in q.style)return"Khtml";return""}();var Cb=function(f,q){Ib.toLowerCase();var w=["top","left","bottom","right"];f.each(function(){for(var D=a(this),G=D.outerWidth()*(q-1),L=D.outerHeight()*(q-1),U=0;U<4;U++){var W=w[U],S=D.data("orig_margin-"+W);if(S==null){S=parseInt(D.css("margin-"+
W));D.data("orig_margin-"+W,S)}S=S*q;if(W==="right")S+=G;else if(W==="bottom")S+=L;D.css("margin-"+W,S)}})},jb=p.setIconSize=function(f,q){if(!(f==k.size&&!q)){var w=a("#tools_top .toolset, #editor_panel > *, #history_panel > *,        #main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,        #g_panel > *, #tool_font_size > *, .tools_flyout"),D=1;D=typeof f=="number"?f:{s:0.75,m:1,l:1.25,xl:1.5}[f];p.tool_scale=ca=D;qa();var G=w.parents(":hidden");G.css("visibility","hidden").show();
Cb(w,D);G.css("visibility","visible").hide();w=a("#tool_size_rules");if(w.length)w.empty();else w=a('<style id="tool_size_rules"></style>').appendTo("head");if(f!="m"){var L="";a.each(cssResizeRules,function(U,W){U="#svg_editor "+U.replace(/,/g,", #svg_editor");L+=U+"{";a.each(W,function(S,X){if(typeof X==="number")var Y=X*D+"px";else if(X[f]||X.all)Y=X[f]||X.all;L+=S+":"+Y+";"});L+="}"});G="-"+Ib.toLowerCase()+"-";L+="#tools_top .toolset, #editor_panel > *, #history_panel > *,        #main_button, #tools_left > *, #path_node_panel > *, #multiselected_panel > *,        #g_panel > *, #tool_font_size > *, .tools_flyout{"+
G+"transform: scale("+D+");} #svg_editor div.toolset .toolset {"+G+"transform: scale(1); margin: 1px !important;} #svg_editor .ui-slider {"+G+"transform: scale("+1/D+");}";w.text(L)}qa()}},Gb=function(){a("#dialog_box").hide();if(ha){if(ha)ia!==a("#svg_source_textarea").val()?a.confirm(uiStrings.notification.QignoreSourceChanges,function(f){f&&g()}):g();l()}else la&&c.leaveContext()},g=function(){a("#svg_source_editor").hide();ha=false;a("#svg_source_textarea").blur()};a(window).width();a(window).height();
var l=a.noop;a(window).resize(function(){v()});(function(){R.scroll(function(){if(a("#ruler_x").length!=0)a("#ruler_x")[0].scrollLeft=R[0].scrollLeft;if(a("#ruler_y").length!=0)a("#ruler_y")[0].scrollTop=R[0].scrollTop})})();a("#url_notice").click(function(){a.alert(this.title)});a("#change_image_url").click(function(){var f=c.getHref(V);f=f.indexOf("data:")===0?"":f;a.prompt(uiStrings.notification.enterNewImgURL,f,function(q){q&&Ja(q)})});var m=function(f){var q=f[0].id=="stroke_color"?"stroke":
"fill",w=f[0].id=="canvas_color";if(w)q="canvas";var D=p.paintBox[q].paint;f=q=="stroke"?"Pick a Stroke Paint and Opacity":"Pick a Fill Paint and Opacity";w=w?{right:175,top:50}:{left:50,bottom:50};a("#color_picker").draggable({cancel:".jGraduate_tabs, .jGraduate_colPick, .jGraduate_gradPick, .jPicker",containment:"window"}).removeAttr("style").css(w).jGraduate({paint:D,window:{pickerTitle:f},images:{clientPath:curConfig.jGraduatePath},newstop:"inverse"},function(G){D=new a.jGraduate.Paint(G);p.paintBox[q].setPaint(D);
c.setPaint(q,D);a("#color_picker").hide()},function(){a("#color_picker").hide()})};u=function(f,q){var w=document.getElementById("canvas_background"),D={color:"fff",opacity:1};if(q=="stroke")D=curConfig.initStroke;if(q=="fill")D=curConfig.initFill;if(q=="canvas"&&w)if(w=w.getAttribute("fill").match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))D={color:("0"+parseInt(w[1],10).toString(16)).slice(-2)+("0"+parseInt(w[2],10).toString(16)).slice(-2)+("0"+parseInt(w[3],10).toString(16)).slice(-2),opacity:1};w=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><rect width="100%" height="100%"          fill="#'+
D.color+'" opacity="'+D.opacity+'"/>          <defs><linearGradient id="gradbox_"/></defs></svg>',"text/xml").documentElement;w=a(f)[0].appendChild(document.importNode(w,true));q==="canvas"?w.setAttribute("width",60.5):w.setAttribute("width","100%");this.rect=w.firstChild;this.defs=w.getElementsByTagName("defs")[0];this.grad=this.defs.firstChild;this.paint=new a.jGraduate.Paint({solidColor:D.color});this.type=q;this.setPaint=function(G,L){this.paint=G;var U="none",W=G.type,S=G.alpha/100;switch(W){case "solidColor":U=
G[W]=="none"||G[W]=="one"?"none":"#"+G[W];break;case "linearGradient":case "radialGradient":this.defs.removeChild(this.grad);this.grad=this.defs.appendChild(G[W]);U="url(#"+(this.grad.id="gradbox_"+this.type)+")"}this.rect.setAttribute("fill",U);this.rect.setAttribute("opacity",S);if(this.type=="canvas")if(W=document.getElementById("canvas_background")){La=c.getResolution();W.setAttribute("x",-1);W.setAttribute("y",-1);W.setAttribute("width",La.w+2);W.setAttribute("height",La.h+2);U.indexOf("url")==
-1&&W.setAttribute("fill",U)}else Ra(U);if(L){c.setColor(this.type,U,true);c.setPaintOpacity(this.type,S,true)}};this.update=function(G){if(V){var L=this.type;switch(V.tagName){case "use":case "image":case "foreignObject":return;case "g":case "a":for(var U=null,W=V.getElementsByTagName("*"),S=0,X=W.length;S<X;S++){var Y=W[S].getAttribute(L);if(S===0)U=Y;else if(U!==Y){U=null;break}}if(U===null){W=null;return}W=U;U=1;break;default:U=parseFloat(V.getAttribute(L+"-opacity"));if(isNaN(U))U=1;W=L==="fill"?
"black":"none";W=V.getAttribute(L)||W}if(G){c.setColor(L,W,true);c.setPaintOpacity(L,U,true)}U*=100;this.setPaint(Oa(W,U,L))}};this.prep=function(){switch(this.paint.type){case "linearGradient":case "radialGradient":var G=new a.jGraduate.Paint({copy:this.paint});c.setPaint(q,G)}}};p.paintBox.fill=new u("#fill_color","fill");p.paintBox.stroke=new u("#stroke_color","stroke");p.paintBox.canvas=new u("#canvas_color","canvas");a("#stroke_width").val(curConfig.initStroke.width);a("#group_opacity").val(curConfig.initOpacity*
100);u=p.paintBox.fill.rect.cloneNode(false);u.setAttribute("style","vector-effect:non-scaling-stroke");var A=u.style.vectorEffect==="non-scaling-stroke";u.removeAttribute("style");u=p.paintBox.fill.rect.ownerDocument.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");typeof u.stdDeviationX==="undefined"&&a("#tool_blur").hide();a(u).remove();setTimeout(function(){c.embedImage("images/placeholder.svg",function(f){if(!f){a("#image_save_opts [value=embed]").attr("disabled","disabled");a("#image_save_opts input").val(["ref"]);
k.img_save="ref";a("#image_opt_embed").css("color","#666").attr("title",uiStrings.notification.featNotSupported)}})},1E3);a("#tool_fill").click(function(){if(a("#tool_fill").hasClass("active"))m(a("#fill_color"));else{a("#tool_fill").addClass("active");a("#tool_stroke").removeClass("active")}});a("#tool_stroke").on("click",function(){if(a("#tool_stroke").hasClass("active"))m(a("#stroke_color"));else{a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active")}});a("#tool_canvas").on("click touchstart",
function(){m(a("#canvas_color"))});a("#tool_stroke").on("touchstart",function(){a("#tool_stroke").addClass("active");a("#tool_fill").removeClass("active");m(a("#stroke_color"))});a("#tool_fill").on("touchstart",function(){a("#tool_fill").addClass("active");a("#tool_stroke").removeClass("active");m(a("#fill_color"))});a("#zoom_select").on("change",function(){var f=this.options[this.selectedIndex].text;f=f.split("%")[0];a("#zoom").val(f).trigger("change")});a(".push_button").mousedown(function(){a(this).hasClass("disabled")||
a(this).addClass("push_button_pressed").removeClass("push_button")}).mouseout(function(){a(this).removeClass("push_button_pressed").addClass("push_button")}).mouseup(function(){a(this).removeClass("push_button_pressed").addClass("push_button")});a(window).bind("load resize",function(){R.css("line-height",R.height()+"px")});var z=function(){var f=a("#canvas_width"),q=a("#canvas_height"),w=f.val(),D=q.val();if(w!="fit"&&!svgedit.units.isValidUnit("width",w)){a.alert(uiStrings.notification.invalidAttrValGiven);
f.parent().addClass("error");return false}f.parent().removeClass("error");if(D!="fit"&&!svgedit.units.isValidUnit("height",D)){a.alert(uiStrings.notification.invalidAttrValGiven);q.parent().addClass("error");return false}q.parent().removeClass("error");if(!c.setResolution(w,D)){a.alert(uiStrings.notification.noContentToFitTo);w=c.getResolution();f.val(w.w);q.val(w.h);return false}v()};a("#resolution").change(function(){var f=a("#canvas_width")[0],q=a("#canvas_height")[0];if(this.selectedIndex)if(this.value==
"content"){f.value="fit";q.value="fit";z();var w=c.getResolution();f.value=w.w;q.value=w.h}else{var D=this.value.split("x");D[0]=parseInt(D[0]);D[1]=parseInt(D[1]);var G=D[0]-f.value,L=D[1]-q.value,U=Date.now(),W=function(){var S=(Date.now()-U)/1E3;S=Math.pow(S-1,3)+1;f.value=(D[0]-G+S*G).toFixed(0);q.value=(D[1]-L+S*L).toFixed(0);z();if(S>=1){S=c.getResolution();a("#canvas_width").val(S.w.toFixed());a("#canvas_height").val(S.h.toFixed());a("#resolution_label").html("<div class='pull'>"+S.w+"<span>\u00d7</span></br>"+
S.h+"</div>")}else requestAnimationFrame(W)};W()}else{a("#resolution_label").html("Custom");f.removeAttribute("readonly");f.focus();f.select();if(f.value=="fit"){f.value=100;q.value=100}}});a("#zoom").change(function(){va(this)});a("input,select").attr("autocomplete","off");var H=function(){var f=[{sel:"#tool_select",fn:Ya,evt:"click",key:["V",true]},{sel:"#tool_fhpath",fn:Ba,evt:"click",key:["Q",true]},{sel:"#tool_line",fn:ua,evt:"click",key:["L",true]},{sel:"#tool_rect",fn:db,evt:"click",key:["R",
true],icon:"rect"},{sel:"#tool_ellipse",fn:Ga,evt:"mouseup",key:["C",true],icon:"ellipse"},{sel:"#tool_path",fn:Za,evt:"click",key:["P",true]},{sel:"#tool_text",fn:qb,evt:"click",key:["T",true]},{sel:"#tool_image",fn:Ua,evt:"mouseup"},{sel:"#tool_zoom",fn:Ca,evt:"mouseup",key:["Z",true]},{sel:"#tool_clear",fn:cb,evt:"mouseup",key:[s+"N",true]},{sel:"#tool_save",fn:function(){if(ha)ib();else{Qa(a("#file_menu"));c.save({images:k.img_save,round_digits:6})}},evt:"mouseup",key:[s+"S",true]},{sel:"#tool_reload",
fn:function(){if(ha)ib();else{Qa(a("#file_menu"));var w=c.getSvgString();n.readyState!=WebSocket.OPEN&&b();n.send(w)}},evt:"mouseup",key:[s+"E",true]},{sel:"#tool_export",fn:ob,evt:"mouseup"},{sel:"#tool_open",fn:Pa,evt:"mouseup"},{sel:"#tool_import",fn:sb,evt:"mouseup"},{sel:"#tool_source",fn:Ab,evt:"click",key:[s+"U",true]},{sel:"#tool_wireframe",fn:Lb,evt:"click"},{sel:"#tool_snap",fn:Pb,evt:"click"},{sel:"#tool_rulers",fn:Hb,evt:"click"},{sel:"#tool_source_cancel,#svg_source_overlay,#tool_docprops_cancel,#tool_prefs_cancel",
fn:Gb,evt:"click",key:["esc",false,false],hidekey:true},{sel:"#tool_source_save",fn:ib,evt:"click"},{sel:"#tool_delete,#tool_delete_multi",fn:$a,evt:"click",key:["del/backspace",true]},{sel:"#tool_reorient",fn:wb,evt:"click"},{sel:"#tool_node_link",fn:aa,evt:"change"},{sel:"#tool_node_clone",fn:ja,evt:"click"},{sel:"#tool_node_delete",fn:N,evt:"click"},{sel:"#tool_openclose_path",fn:da,evt:"click"},{sel:"#tool_add_subpath",fn:Q,evt:"click"},{sel:"#tool_move_top",fn:gb,evt:"click",key:s+"shift+up"},
{sel:"#tool_move_bottom",fn:tb,evt:"click",key:s+"shift+down"},{sel:"#tool_move_up",fn:lb,evt:"click",key:[s+"up",true]},{sel:"#tool_move_down",fn:eb,evt:"click",key:[s+"down",true]},{sel:"#tool_topath",fn:rb,evt:"click"},{sel:"#tool_make_link,#tool_make_link_multi",fn:xb,evt:"click"},{sel:"#tool_clone,#tool_clone_multi",fn:Ia,evt:"click",key:[s+"D",true]},{sel:"#tool_group",fn:bb,evt:"click",key:[s+"G",true]},{sel:"#tool_ungroup",fn:bb,evt:"click",key:s+"shift+G"},{sel:"#tool_unlink_use",fn:bb,evt:"click"},
{sel:"[id^=tool_align]",fn:Ob,evt:"click"},{sel:"#tool_undo",fn:Fb,evt:"click",key:s+"z"},{sel:"#tool_redo",fn:Eb,evt:"click",key:["y",true]},{sel:"#tool_cut",fn:vb,evt:"click",key:[s+"x",true]},{sel:"#tool_copy",fn:sa,evt:"click",key:s+"c"},{sel:"#tool_paste",fn:kb,evt:"click",key:s+"v"},{sel:"#tool_switch",fn:Kb,evt:"click",key:["x",true]},{sel:"#tool_bold",fn:pb,evt:"mousedown",key:[s+"B",true]},{sel:"#tool_italic",fn:Ta,evt:"mousedown",key:[s+"I",true]},{sel:"#copy_save_done",fn:Gb,evt:"click"},
{key:"ctrl+left",fn:function(){Sa(0,1)}},{key:"ctrl+right",fn:function(){Sa(1,1)}},{key:"ctrl+shift+left",fn:function(){Sa(0,5)}},{key:"ctrl+shift+right",fn:function(){Sa(1,5)}},{key:"shift+O",fn:Ma},{key:"shift+P",fn:Da},{key:[s+"+",true],fn:function(){zb(2)}},{key:[s+"-",true],fn:function(){zb(0.5)}},{key:["up",true],fn:function(){ga(0,-1)}},{key:["down",true],fn:function(){ga(0,1)}},{key:["left",true],fn:function(){ga(-1,0)}},{key:["right",true],fn:function(){ga(1,0)}},{key:"shift+up",fn:function(){ga(0,
-10)}},{key:"shift+down",fn:function(){ga(0,10)}},{key:"shift+left",fn:function(){ga(-10,0)}},{key:"shift+right",fn:function(){ga(10,0)}},{key:["alt+up",true],fn:function(){c.cloneSelectedElements(0,-1)}},{key:["alt+down",true],fn:function(){c.cloneSelectedElements(0,1)}},{key:["alt+left",true],fn:function(){c.cloneSelectedElements(-1,0)}},{key:["alt+right",true],fn:function(){c.cloneSelectedElements(1,0)}},{key:["alt+shift+up",true],fn:function(){c.cloneSelectedElements(0,-10)}},{key:["alt+shift+down",
true],fn:function(){c.cloneSelectedElements(0,10)}},{key:["alt+shift+left",true],fn:function(){c.cloneSelectedElements(-10,0)}},{key:["alt+shift+right",true],fn:function(){c.cloneSelectedElements(10,0)}},{key:s+"A",fn:function(){c.selectAllInCurrentLayer()}},{key:"I",fn:function(){var w=a(".tool_button_current");if(w.length&&w[0].id!=="tool_eyedropper"){w.removeClass("tool_button_current").addClass("tool_button");a("#tool_eyedropper").addClass("tool_button_current").removeClass("tool_button")}c.setMode("eyedropper")}},
{key:s+"shift+z",fn:Eb},{key:"esc",fn:Bb}],q={"4/Shift+4":"#tools_rect_show","5/Shift+5":"#tools_ellipse_show"};return{setAll:function(){var w={};a.each(f,function(D,G){if(G.sel){var L=a(G.sel);if(L.length==0)return true;if(G.evt){if(svgedit.browser.isTouch()&&G.evt==="click")G.evt="mousedown";L[G.evt](G.fn)}if(G.parent&&a(G.parent+"_show").length!=0){var U=a(G.parent);U.length||(U=na(G.parent.substr(1)));U.append(L);a.isArray(w[G.parent])||(w[G.parent]=[]);w[G.parent].push(G)}}if(G.key){var W=G.fn,
S=false;if(a.isArray(G.key)){U=G.key[0];if(G.key.length>1)S=G.key[1]}else U=G.key;U+="";svgedit.browser.isMac&&U.indexOf("+")!=-1&&U.split("+")[0]=="ctrl"&&U.replace("ctrl","cmd");a.each(U.split("/"),function(Y,ka){a(document).bind("keydown",ka,function(za){W();S&&za.preventDefault();return false})});if(G.sel&&!G.hidekey&&L.attr("title")){var X=L.attr("title").split("[")[0]+" ("+U+")";q[U]=G.sel;L.parents("#main_menu").length||L.attr("title",X)}}});pa(w);a(window).bind("keydown","tab",function(D){if(ma===
"canvas"){D.preventDefault();Da()}}).bind("keydown","shift+tab",function(D){if(ma==="canvas"){D.preventDefault();Ma()}});a("#tool_zoom").dblclick(hb)},setTitles:function(){a.each(q,function(w,D){var G=a(D).parents("#main_menu").length;a(D).each(function(){var L=G?a(this).text().split(" [")[0]:this.title.split(" [")[0],U="";a.each(w.split("/"),function(W,S){var X=S.split("+"),Y="";if(X.length>1){Y=X[0]+"+";S=X[1]}U+=(W?"/":"")+Y+(uiStrings["key_"+S]||S)});if(G)this.lastChild.textContent=L+" ["+U+"]";
else this.title=L+" ["+U+"]"})})},getButtonData:function(w){var D;a.each(f,function(G,L){if(L.sel===w)D=L});return D}}}();H.setAll();p.ready(function(){var f=curConfig.initTool,q=a("#tools_left, #svg_editor .tools_flyout"),w=q.find("#tool_"+f);f=q.find("#"+f);(w.length?w:f.length?f:a("#tool_select")).click().mouseup();curConfig.wireframe&&a("#tool_wireframe").click();curConfig.showlayers&&toggleSidePanel();a("#rulers").toggle(!!curConfig.showRulers)});a("#canvas_height").dragInput({min:10,max:null,
step:10,callback:z,cursor:false,dragAdjust:0.1});a("#canvas_width").dragInput({min:10,max:null,step:10,callback:z,cursor:false,dragAdjust:0.1});a("#rect_width").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});
a("#ellipse_rx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#ellipse_ry").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_height").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cx").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_cy").dragInput({min:1,max:null,step:1,callback:changeAttribute,cursor:false});a("#circle_r").dragInput({min:1,max:null,step:1,callback:changeAttribute,
cursor:false});a("#image_height").dragInput({min:0,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#selected_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_node_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_width").dragInput({min:null,
max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_x2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y1").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#line_y2").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#path_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});
a("#path_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#g_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,
cursor:false});a("#text_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#text_x").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#image_y").dragInput({min:null,max:null,step:1,callback:changeAttribute,cursor:false});a("#rect_rx").dragInput({min:0,max:100,step:1,callback:changeAttribute,cursor:true});a("#stroke_width").dragInput({min:0,max:99,step:1,callback:function(f){var q=f.value;if(q==0&&V&&["line","polyline"].indexOf(V.nodeName)>=
0)q=f.value=1;c.setStrokeWidth(q)},cursor:true,smallStep:0.1,start:1.5});a("#angle").dragInput({min:-180,max:180,step:1,callback:function(f){c.setRotationAngle(f.value,true);rotateCursor(f.value);a("#tool_reorient").toggleClass("disabled",f.value==0)},cursor:false,dragAdjust:0.5});a("#font_size").dragInput({min:1,max:250,step:1,callback:function(f){c.setFontSize(f.value)},cursor:true,stepfunc:function(f,q){var w=f.value-0,D=w+q,G=D>=w;if(q===0)return w;return w>=24?G?Math.round(w*1.1):Math.round(w/
1.1):w<=1?G?w*2:w/2:D},dragAdjust:0.15});a("#group_opacity").dragInput({min:0,max:100,step:5,callback:changeAttribute,cursor:true,start:100});a("#blur").dragInput({min:0,max:10,step:0.1,callback:function(f,q){val=f.value;a("#blur").val(val);q?c.setBlur(val,true):c.setBlurNoUndo(val)},cursor:true,start:0});a("#zoom").val(c.getZoom()*100);a("#workarea").contextMenu({menu:"cmenu_canvas",inSpeed:0},function(f){switch(f){case "delete":$a();break;case "cut":vb();break;case "copy":sa();break;case "paste":c.pasteElements();
break;case "paste_in_place":c.pasteElements("in_place");break;case "group":c.groupSelectedElements();break;case "ungroup":c.ungroupSelectedElement();break;case "move_front":gb();break;case "move_up":nb("Up");break;case "move_down":nb("Down");break;case "move_back":tb();break;default:svgedit.contextmenu&&svgedit.contextmenu.hasCustomHandler(f)&&svgedit.contextmenu.getCustomHandler(f).call()}});a(".contextMenu li").mousedown(function(f){f.preventDefault()});a("#cmenu_canvas li").disableContextMenu();
T.enableContextMenuItems("#delete,#cut,#copy");window.onbeforeunload=function(){if(P.getUndoStackSize()===0)p.show_save_warning=false;if(!curConfig.no_save_warning&&p.show_save_warning)return uiStrings.notification.unsavedChanges};p.openPrep=function(f){a("#main_menu").hide();P.getUndoStackSize()===0?f(true):a.confirm(uiStrings.notification.QwantToOpen,f)};if(window.FileReader){u=function(f){f.stopPropagation();f.preventDefault();a("#workarea").removeAttr("style");a("#main_menu").hide();var q=null;
if(q=f.type=="drop"?f.dataTransfer.files[0]:this.files[0])if(q.type.indexOf("image")!=-1)if(q.type.indexOf("svg")!=-1){f=new FileReader;f.onloadend=function(w){c.importSvgString(w.target.result,true);c.ungroupSelectedElement();c.ungroupSelectedElement();c.groupSelectedElements();c.alignSelectedElements("m","page");c.alignSelectedElements("c","page")};f.readAsText(q)}else{f=new FileReader;f.onloadend=function(w){insertNewImage=function(U,W){var S=c.addSvgElementFromJson({element:"image",attr:{x:0,
y:0,width:U,height:W,id:c.getNextId(),style:"pointer-events:inherit"}});c.setHref(S,w.target.result);c.selectOnly([S]);c.alignSelectedElements("m","page");c.alignSelectedElements("c","page");ta()};var D=100,G=100,L=new Image;L.src=w.target.result;document.body.appendChild(L);L.onload=function(){D=L.offsetWidth;G=L.offsetHeight;insertNewImage(D,G);document.body.removeChild(L)}};f.readAsDataURL(q)}};R=a("#workarea");R[0].addEventListener("dragenter",function(f){f.stopPropagation();f.preventDefault();
R.css({"-webkit-transform":"scale3d(1.1,1.1,1)","-moz-transform":"scale3d(1.1,1.1,1)","-o-transform":"scale(1.1)","-ms-transform":"scale3d(1.1,1.1,1)",transform:"scale3d(1.1,1.1,1)"})},false);R[0].addEventListener("dragover",function(f){f.stopPropagation();f.preventDefault()},false);R[0].addEventListener("dragleave",function(f){R.removeAttr("style");f.stopPropagation();f.preventDefault()},false);R[0].addEventListener("drop",u,false);var C=a('<input type="file">').change(function(){var f=this;p.openPrep(function(q){if(q){c.clear();
if(f.files.length==1){q=new FileReader;q.onloadend=function(w){d(w.target.result);v()};q.readAsText(f.files[0])}}})});a("#tool_open").show().prepend(C);u=a('<input type="file">').change(u);a("#tool_import").show().prepend(u)}var v=p.updateCanvas=function(f,q){var w=R.width(),D=R.height(),G=w,L=D,U=c.getZoom(),W=R,S=a("#svgcanvas"),X={x:W[0].scrollLeft+G/2,y:W[0].scrollTop+L/2},Y=curConfig.canvas_expansion;w=Math.max(G,c.contentW*U*Y);D=Math.max(L,c.contentH*U*Y);w==G&&D==L?R.css("overflow","hidden"):
R.css("overflow","scroll");Y=S.height()/2;var ka=S.width()/2;S.width(w).height(D);var za=D/2,fa=w/2,Aa=c.updateCanvas(w,D),xa=fa/ka;w=w/2-G/2;D=D/2-L/2;if(q){q.x+=Aa.x;q.y+=Aa.y}else q={x:fa+(X.x-ka)*xa,y:za+(X.y-Y)*xa};if(f)if(c.contentW>W.width()){R[0].scrollLeft=Aa.x-10;R[0].scrollTop=Aa.y-10}else{W[0].scrollLeft=w;W[0].scrollTop=D}else{W[0].scrollLeft=q.x-G/2;W[0].scrollTop=q.y-L/2}if(curConfig.showRulers){G=S;U=U;document.getElementById("workarea");document.getElementById("title_show");U||(U=
c.getZoom());G||(G=a("#svgcanvas"));L=c.getContentElem();W=svgedit.units.getTypeMap()[curConfig.baseUnit];for(S=0;S<2;S++){ka=(X=S===0)?"x":"y";xa=X?"width":"height";Y=L.getAttribute(ka)-0;ka=a("#ruler_"+ka+" canvas:first");$hcanv=ka.clone();ka.replaceWith($hcanv);w=$hcanv[0];za=ka=G[xa]()*2;w.parentNode.style[xa]=za+"px";fa=0;var ya;Aa=w.getContext("2d");Aa.fillStyle="rgb(200,0,0)";Aa.fillRect(0,0,w.width,w.height);$hcanv.siblings().remove();if(ka>=3E4){var Ha=parseInt(ka/3E4)+1;ya=Array(Ha);ya[0]=
Aa;for(D=1;D<Ha;D++){w[xa]=3E4;var ab=w.cloneNode(true);w.parentNode.appendChild(ab);ya[D]=ab.getContext("2d")}ab[xa]=ka%3E4;ka=3E4}w[xa]=ka;xa=W*U;var Xa=50/xa;w=1;for(D=0;D<E.length;D++){w=Ha=E[D];if(Xa<=Ha)break}Xa=w*xa;Aa.font="normal 9px 'Lucida Grande', sans-serif";Aa.fillStyle="#777";for(var Na=Y/xa%w*xa,mb=Na-Xa;Na<za;Na+=Xa){mb+=Xa;D=Math.round(Na)+0.5;if(X){Aa.moveTo(D,15);Aa.lineTo(D,0)}else{Aa.moveTo(15,D);Aa.lineTo(0,D)}Ha=(mb-Y)/xa;if(w>=1)D=Math.round(Ha);else{D=(w+"").split(".")[1].length;
D=Ha.toFixed(D)-0}if(D!==0&&D!==1E3&&D%1E3===0)D=D/1E3+"K";if(X){Aa.fillText(D,Na+2,8);Aa.fillStyle="#777"}else{Ha=(D+"").split("");for(D=0;D<Ha.length;D++){Aa.fillText(Ha[D],1,Na+9+D*9);Aa.fillStyle="#777"}}Ha=Xa/10;for(D=1;D<10;D++){var yb=Math.round(Na+Ha*D)+0.5;if(ya&&yb>ka){fa++;Aa.stroke();if(fa>=ya.length){D=10;Na=za;continue}Aa=ya[fa];Na-=3E4;yb=Math.round(Na+Ha*D)+0.5}var Db=D%2?12:10;if(X){Aa.moveTo(yb,15);Aa.lineTo(yb,Db)}else{Aa.moveTo(15,yb);Aa.lineTo(Db,yb)}}}Aa.strokeStyle="#666";Aa.stroke()}R.scroll()}},
E=[];for(u=0.1;u<1E5;u*=10){E.push(1*u);E.push(2*u);E.push(5*u)}v(true);try{var J=function(f){if(window.JSON&&JSON.stringify)return JSON.stringify(f);var q=arguments.callee;if(typeof f=="boolean"||typeof f=="number")return f+"";else if(typeof f=="string")return'"'+f.replace(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(G){return"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)})+'"';else if(f.length){for(var w=
0;w<f.length;w++)f[w]=q(f[w]);return"["+f.join(",")+"]"}else{w=[];for(var D in f)w.push(q(D)+":"+q(f[D]));return"{"+w.join(",")+"}"}};window.addEventListener("message",function(f){var q=parseInt(f.data.substr(0,f.data.indexOf(";")));try{f.source.postMessage("SVGe"+q+";"+J(eval(f.data)),"*")}catch(w){f.source.postMessage("SVGe"+q+";error:"+w.message,"*")}},false)}catch(F){window.embed_error=F}a(function(){window.svgCanvas=c;c.ready=methodDraw.ready});p.setLang=function(f,q){a.pref("lang",f);a("#lang_select").val(f);
if(q){c.runExtensions("langChanged",f);Ka();a.each({"#stroke_color":"#tool_stroke .icon_label, #tool_stroke .color_block","#fill_color":"#tool_fill label, #tool_fill .color_block","#linejoin_miter":"#cur_linejoin","#linecap_butt":"#cur_linecap"},function(w,D){a(D).attr("title",a(w)[0].title)});a("#multiselected_panel div[id^=tool_align]").each(function(){a("#tool_pos"+this.id.substr(10))[0].title=this.title})}}};var o=[];p.ready=function(u){e?u():o.push(u)};p.runCallbacks=function(){a.each(o,function(){this()});
e=true};p.loadFromString=function(u){p.ready(function(){d(u)})};p.loadFromURL=function(u,B){B||(B={});var s=B.cache,K=B.callback;p.ready(function(){a.ajax({url:u,dataType:"text",cache:!!s,success:function(P){d(P,K)},error:function(P,M,I){P.status!=404&&P.responseText?d(P.responseText,K):a.alert(uiStrings.notification.URLloadFail+": \n"+I+"",K)}})})};p.loadFromDataURI=function(u){p.ready(function(){var B=u.substring(26);d(svgedit.utilities.decode64(B))})};p.addExtension=function(){var u=arguments;
a(function(){c&&c.addExtension.apply(this,u)})};return p}(jQuery);$(methodDraw.init)})();$.fn.dragInput=function(b){return this.each(function(){this.repeating=false;this.dragCfg={min:b&&!isNaN(parseFloat(b.min))?Number(b.min):null,max:b&&!isNaN(parseFloat(b.max))?Number(b.max):null,step:b&&Number(b.step)?b.step:1,stepfunc:b&&b.stepfunc?b.stepfunc:false,dragAdjust:b&&b.dragAdjust?b.dragAdjust:1,height:70,cursor:b&&b.cursor?Boolean(b.cursor):false,start:b&&b.start?Number(b.start):0,_btn_width:20,_direction:null,_delay:null,_repeat:null,callback:b&&b.callback?b.callback:null};this.dragCfg.smallStep=
b&&b.smallStep?b.smallStep:this.dragCfg.step/2;var n=this.dragCfg.dragAdjust,a=$(this).parent(),d=$(this),c=this.dragCfg.height,p=this.dragCfg.min,e=this.dragCfg.max,k=this.dragCfg.step,h=e-p>0?(e-p)/k:200,o=h/c*k,u=0,B=this.getAttribute("data-attr"),s=methodDraw.canvas,K=svgedit.browser.isTouch(),P=true,M=h&&this.dragCfg.cursor?$("<div class='draginput_cursor' />").appendTo(a):false;d.attr("readonly","readonly");M&&!isNaN(this.dragCfg.start)&&M.css("top",this.dragCfg.start*-1/o+c);this.adjustValue=
function(I,R){var T;I=parseFloat(I);T=isNaN(this.value)?this.dragCfg.reset:$.isFunction(this.dragCfg.stepfunc)?this.dragCfg.stepfunc(this,I):Number((Number(this.value)+Number(I)).toFixed(5));if(e!==null)T=Math.min(T,e);if(p!==null)T=Math.max(T,p);M&&this.updateCursor(T);this.value=T;a.attr("data-value",T);$.isFunction(this.dragCfg.callback)&&this.dragCfg.callback(this,R)};a.toggleClass("draginput",a.is("label"));this.move=function(I,R,T){if(K)I=I.originalEvent.touches[0];if(u===0)u=R;R=(I.pageY-u)*
-1;u=I.pageY;T=R*o*n;this.adjustValue(T.toFixed(k<1?1:0))};this.stop=function(){var I=s.getSelectedElems();$("body").removeClass("dragging");a.removeClass("active");P=true;$(window).unbind("mousemove.draginput touchmove.draginput mouseup.draginput touchend.draginput");u=0;if(I[0]){I=s.undoMgr.finishUndoableChange();I.isEmpty()||s.undoMgr.addCommandToHistory(I)}this.adjustValue(0,P)};this.updateCursor=function(){var I=parseFloat(this.value)*-1/o+c;M.css("top",I)};this.launch=function(I){var R=s.getSelectedElems();
if(K)I=I.originalEvent.touches[0];var T=I.pageY,O=this.value,ca=this;s.undoMgr.beginUndoableChange(B,R);$("body").addClass("dragging");a.addClass("active");$(window).bind("mousemove.draginput touchmove.draginput",function(ma){ca.move(ma,T,parseFloat(O))});$(window).bind("mouseup.draginput touchend.draginput",function(){ca.stop()})};$(this).attr("readonly","readonly").attr("data-scale",o).attr("data-domain",c).attr("data-cursor",M!=false).bind("mousedown touchstart",function(I){this.blur();this.launch(I)}).bind("dblclick taphold",
function(){this.removeAttribute("readonly","readonly");this.focus();this.select()}).keydown(function(I){switch(I.keyCode){case 13:this.adjustValue(0);this.blur()}}).focus(function(){this.getAttribute("readonly")==="readonly"&&this.blur()}).blur(function(){this.setAttribute("readonly","readonly")}).bind("mousewheel",function(I,R,T,O){R=s.getSelectedElems();P&&s.undoMgr.beginUndoableChange(B,R);P=false;clearTimeout(window.undoTimeout);window.undoTimeout=setTimeout(function(){ca.stop()},200);var ca=
this;if(O>0)this.adjustValue(this.dragCfg.step);else O<0&&this.adjustValue(-this.dragCfg.step);I.preventDefault()})})};$.fn.dragInput.updateCursor=function(b){var n=parseFloat(b.value),a=parseFloat(b.getAttribute("data-scale")),d=parseFloat(b.getAttribute("data-domain"));n=n*-1/a+d+"px";b=b.parentNode.lastChild;if(b.className=="draginput_cursor")b.style.top=n};svgedit=svgedit||{};
(function(){var b=this;if(!svgedit.contextmenu)svgedit.contextmenu={};b.contextMenuExtensions={};methodDraw.ready(function(){for(menuItem in contextMenuExtensions){var n=contextMenuExtensions[menuItem];Object.keys(b.contextMenuExtensions).length==0&&$("#cmenu_canvas").append("<li class='separator'>");var a=n.shortcut||"";$("#cmenu_canvas").append("<li class='disabled'><a href='#"+n.id+"'>"+n.label+"<span class='shortcut'>"+a+"</span></a></li>")}});svgedit.contextmenu.resetCustomMenus=function(){b.contextMenuExtensions=
{}};svgedit.contextmenu.add=function(n){if(n&&n.id&&n.label&&n.action&&typeof n.action=="function")if(n.id in b.contextMenuExtensions)console.error('Cannot add extension "'+n.id+'", an extension by that name already exists"');else{console.log("Registed contextmenu item: {id:"+n.id+", label:"+n.label+"}");b.contextMenuExtensions[n.id]=n}else console.error("Menu items must be defined and have at least properties: id, label, action, where action must be a function")};svgedit.contextmenu.hasCustomHandler=
function(n){return b.contextMenuExtensions[n]&&true};svgedit.contextmenu.getCustomHandler=function(n){return b.contextMenuExtensions[n].action}})();(function(b,n){function a(c){return!b(c).parents().andSelf().filter(function(){return b.curCSS(this,"visibility")==="hidden"||b.expr.filters.hidden(this)}).length}function d(c,p){var e=c.nodeName.toLowerCase();if("area"===e){e=c.parentNode;var k=e.name;if(!c.href||!k||e.nodeName.toLowerCase()!=="map")return false;e=b("img[usemap=#"+k+"]")[0];return!!e&&a(e)}return(/input|select|textarea|button|object/.test(e)?!c.disabled:"a"==e?c.href||p:p)&&a(c)}b.ui=b.ui||{};b.ui.version||(b.extend(b.ui,{version:"1.8.17",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),b.fn.extend({propAttr:b.fn.prop||b.fn.attr,_focus:b.fn.focus,focus:function(c,p){return typeof c=="number"?this.each(function(){var e=
this;setTimeout(function(){b(e).focus();p&&p.call(e)},c)}):this._focus.apply(this,arguments)},scrollParent:function(){var c;b.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?c=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(b.curCSS(this,"position",1))&&/(auto|scroll)/.test(b.curCSS(this,"overflow",1)+b.curCSS(this,"overflow-y",1)+b.curCSS(this,"overflow-x",1))}).eq(0):c=this.parents().filter(function(){return/(auto|scroll)/.test(b.curCSS(this,
"overflow",1)+b.curCSS(this,"overflow-y",1)+b.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!c.length?b(document):c},zIndex:function(c){if(c!==n)return this.css("zIndex",c);if(this.length){c=b(this[0]);for(var p;c.length&&c[0]!==document;){p=c.css("position");if(p==="absolute"||p==="relative"||p==="fixed"){p=parseInt(c.css("zIndex"),10);if(!isNaN(p)&&p!==0)return p}c=c.parent()}}return 0},disableSelection:function(){return this.bind((b.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(c){c.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),b.each(["Width","Height"],function(c,p){function e(u,B,s,K){b.each(k,function(){B-=parseFloat(b.curCSS(u,"padding"+this,true))||0;s&&(B-=parseFloat(b.curCSS(u,"border"+this+"Width",true))||0);K&&(B-=parseFloat(b.curCSS(u,"margin"+this,true))||0)});return B}var k=p==="Width"?["Left","Right"]:["Top","Bottom"],h=p.toLowerCase(),o={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,
outerWidth:b.fn.outerWidth,outerHeight:b.fn.outerHeight};b.fn["inner"+p]=function(u){if(u===n)return o["inner"+p].call(this);return this.each(function(){b(this).css(h,e(this,u)+"px")})};b.fn["outer"+p]=function(u,B){if(typeof u!="number")return o["outer"+p].call(this,u);return this.each(function(){b(this).css(h,e(this,u,true,B)+"px")})}}),b.extend(b.expr[":"],{data:function(c,p,e){return!!b.data(c,e[3])},focusable:function(c){return d(c,!isNaN(b.attr(c,"tabindex")))},tabbable:function(c){var p=b.attr(c,
"tabindex"),e=isNaN(p);return(e||p>=0)&&d(c,!e)}}),b(function(){var c=document.body,p=c.appendChild(p=document.createElement("div"));b.extend(p.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});b.support.minHeight=p.offsetHeight===100;b.support.selectstart="onselectstart"in p;c.removeChild(p).style.display="none"}),b.extend(b.ui,{plugin:{add:function(c,p,e){c=b.ui[c].prototype;for(var k in e){c.plugins[k]=c.plugins[k]||[];c.plugins[k].push([p,e[k]])}},call:function(c,p,e){if((p=c.plugins[p])&&
c.element[0].parentNode)for(var k=0;k<p.length;k++)c.options[p[k][0]]&&p[k][1].apply(c.element,e)}},contains:function(c,p){return document.compareDocumentPosition?c.compareDocumentPosition(p)&16:c!==p&&c.contains(p)},hasScroll:function(c,p){if(b(c).css("overflow")==="hidden")return false;var e=p&&p==="left"?"scrollLeft":"scrollTop",k=false;if(c[e]>0)return true;c[e]=1;k=c[e]>0;c[e]=0;return k},isOverAxis:function(c,p,e){return c>p&&c<p+e},isOver:function(c,p,e,k,h,o){return b.ui.isOverAxis(c,e,h)&&
b.ui.isOverAxis(p,k,o)}}))})(jQuery);
(function(b,n){if(b.cleanData){var a=b.cleanData;b.cleanData=function(c){for(var p=0,e;(e=c[p])!=null;p++)try{b(e).triggerHandler("remove")}catch(k){}a(c)}}else{var d=b.fn.remove;b.fn.remove=function(c,p){return this.each(function(){p||(!c||b.filter(c,[this]).length)&&b("*",this).add([this]).each(function(){try{b(this).triggerHandler("remove")}catch(e){}});return d.call(b(this),c,p)})}}b.widget=function(c,p,e){var k=c.split(".")[0],h;c=c.split(".")[1];h=k+"-"+c;e||(e=p,p=b.Widget);b.expr[":"][h]=
function(o){return!!b.data(o,c)};b[k]=b[k]||{};b[k][c]=function(o,u){arguments.length&&this._createWidget(o,u)};p=new p;p.options=b.extend(true,{},p.options);b[k][c].prototype=b.extend(true,p,{namespace:k,widgetName:c,widgetEventPrefix:b[k][c].prototype.widgetEventPrefix||c,widgetBaseClass:h},e);b.widget.bridge(c,b[k][c])};b.widget.bridge=function(c,p){b.fn[c]=function(e){var k=typeof e=="string",h=Array.prototype.slice.call(arguments,1),o=this;e=!k&&h.length?b.extend.apply(null,[true,e].concat(h)):
e;if(k&&e.charAt(0)==="_")return o;k?this.each(function(){var u=b.data(this,c),B=u&&b.isFunction(u[e])?u[e].apply(u,h):u;if(B!==u&&B!==n){o=B;return false}}):this.each(function(){var u=b.data(this,c);u?u.option(e||{})._init():b.data(this,c,new p(e,this))});return o}};b.Widget=function(c,p){arguments.length&&this._createWidget(c,p)};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(c,p){b.data(p,this.widgetName,this);this.element=b(p);this.options=
b.extend(true,{},this.options,this._getCreateOptions(),c);var e=this;this.element.bind("remove."+this.widgetName,function(){e.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(c,p){var e=c;if(arguments.length===0)return b.extend({},this.options);if(typeof c=="string"){if(p===n)return this.options[c];e={};e[c]=p}this._setOptions(e);return this},_setOptions:function(c){var p=this;b.each(c,function(e,k){p._setOption(e,k)});return this},_setOption:function(c,p){this.options[c]=p;c==="disabled"&&this.widget()[p?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
p);return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(c,p,e){var k,h=this.options[c];e=e||{};p=b.Event(p);p.type=(c===this.widgetEventPrefix?c:this.widgetEventPrefix+c).toLowerCase();p.target=this.element[0];if(c=p.originalEvent)for(k in c)k in p||(p[k]=c[k]);this.element.trigger(p,e);return!(b.isFunction(h)&&h.call(this.element[0],p,e)===false||p.isDefaultPrevented())}}})(jQuery);
(function(b){var n=false;b(document).mouseup(function(){n=false});b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(d){return a._mouseDown(d)}).bind("click."+this.widgetName,function(d){if(true===b.data(d.target,a.widgetName+".preventClickEvent")){b.removeData(d.target,a.widgetName+".preventClickEvent");d.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(a){if(!n){this._mouseStarted&&this._mouseUp(a);this._mouseDownEvent=a;var d=this,c=a.which==1,p=typeof this.options.cancel=="string"&&a.target.nodeName?b(a.target).closest(this.options.cancel).length:false;if(!c||p||!this._mouseCapture(a))return true;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=true},this.options.delay));if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=this._mouseStart(a)!==
false;if(!this._mouseStarted){a.preventDefault();return true}}true===b.data(a.target,this.widgetName+".preventClickEvent")&&b.removeData(a.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(e){return d._mouseMove(e)};this._mouseUpDelegate=function(e){return d._mouseUp(e)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.preventDefault();return n=true}},_mouseMove:function(a){if(b.browser.msie&&
!(document.documentMode>=9)&&!a.button)return this._mouseUp(a);if(this._mouseStarted){this._mouseDrag(a);return a.preventDefault()}this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==false,this._mouseStarted?this._mouseDrag(a):this._mouseUp(a));return!this._mouseStarted},_mouseUp:function(a){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&
(this._mouseStarted=false,a.target==this._mouseDownEvent.target&&b.data(a.target,this.widgetName+".preventClickEvent",true),this._mouseStop(a));return false},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
(function(b){b.widget("ui.draggable",b.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){this.options.helper=="original"&&
!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(n){var a=this.options;
if(this.helper||a.disabled||b(n.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(n);if(!this.handle)return false;a.iframeFix&&b(a.iframeFix===true?"iframe":a.iframeFix).each(function(){b('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(b(this).offset()).appendTo("body")});return true},_mouseStart:function(n){var a=this.options;this.helper=
this._createHelper(n);this._cacheHelperProportions();b.ui.ddmanager&&(b.ui.ddmanager.current=this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};b.extend(this.offset,{click:{left:n.pageX-this.offset.left,top:n.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});
this.originalPosition=this.position=this._generatePosition(n);this.originalPageX=n.pageX;this.originalPageY=n.pageY;a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt);a.containment&&this._setContainment();if(this._trigger("start",n)===false){this._clear();return false}this._cacheHelperProportions();b.ui.ddmanager&&!a.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,n);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(n,true);b.ui.ddmanager&&b.ui.ddmanager.dragStart(this,n);return true},
_mouseDrag:function(n,a){this.position=this._generatePosition(n);this.positionAbs=this._convertPositionTo("absolute");if(!a){var d=this._uiHash();if(this._trigger("drag",n,d)===false){this._mouseUp({});return false}this.position=d.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";b.ui.ddmanager&&b.ui.ddmanager.drag(this,n);return false},_mouseStop:function(n){var a=
false;b.ui.ddmanager&&!this.options.dropBehaviour&&(a=b.ui.ddmanager.drop(this,n));this.dropped&&(a=this.dropped,this.dropped=false);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!a||this.options.revert=="valid"&&a||this.options.revert===true||b.isFunction(this.options.revert)&&this.options.revert.call(this.element,a)){var d=this;b(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),
function(){d._trigger("stop",n)!==false&&d._clear()})}else this._trigger("stop",n)!==false&&this._clear();return false},_mouseUp:function(n){this.options.iframeFix===true&&b("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});b.ui.ddmanager&&b.ui.ddmanager.dragStop(this,n);return b.ui.mouse.prototype._mouseUp.call(this,n)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(n){var a=!this.options.handle||
!b(this.options.handle,this.element).length?true:false;b(this.options.handle,this.element).find("*").andSelf().each(function(){this==n.target&&(a=true)});return a},_createHelper:function(n){var a=this.options;n=b.isFunction(a.helper)?b(a.helper.apply(this.element[0],[n])):a.helper=="clone"?this.element.clone().removeAttr("id"):this.element;n.parents("body").length||n.appendTo(a.appendTo=="parent"?this.element[0].parentNode:a.appendTo);n[0]!=this.element[0]&&!/(fixed|absolute)/.test(n.css("position"))&&
n.css("position","absolute");return n},_adjustOffsetFromHelper:function(n){typeof n=="string"&&(n=n.split(" "));b.isArray(n)&&(n={left:+n[0],top:+n[1]||0});"left"in n&&(this.offset.click.left=n.left+this.margins.left);"right"in n&&(this.offset.click.left=this.helperProportions.width-n.right+this.margins.left);"top"in n&&(this.offset.click.top=n.top+this.margins.top);"bottom"in n&&(this.offset.click.top=this.helperProportions.height-n.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=
this.helper.offsetParent();var n=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(n.left+=this.scrollParent.scrollLeft(),n.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&b.browser.msie)n={top:0,left:0};return{top:n.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:n.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var n=this.element.position();return{top:n.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:n.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),
10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var n=this.options;n.containment=="parent"&&(n.containment=this.helper[0].parentNode);if(n.containment=="document"||n.containment=="window")this.containment=[n.containment=="document"?0:b(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,n.containment=="document"?0:b(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,
(n.containment=="document"?0:b(window).scrollLeft())+b(n.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(n.containment=="document"?0:b(window).scrollTop())+(b(n.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(n.containment)&&n.containment.constructor!=Array){n=b(n.containment);var a=n[0];if(a){n.offset();var d=b(a).css("overflow")!=
"hidden";this.containment=[(parseInt(b(a).css("borderLeftWidth"),10)||0)+(parseInt(b(a).css("paddingLeft"),10)||0),(parseInt(b(a).css("borderTopWidth"),10)||0)+(parseInt(b(a).css("paddingTop"),10)||0),(d?Math.max(a.scrollWidth,a.offsetWidth):a.offsetWidth)-(parseInt(b(a).css("borderLeftWidth"),10)||0)-(parseInt(b(a).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(a.scrollHeight,a.offsetHeight):a.offsetHeight)-(parseInt(b(a).css("borderTopWidth"),
10)||0)-(parseInt(b(a).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=n}}else n.containment.constructor==Array&&(this.containment=n.containment)},_convertPositionTo:function(n,a){a||(a=this.position);var d=n=="absolute"?1:-1,c=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,p=/(html|body)/i.test(c[0].tagName);return{top:a.top+
this.offset.relative.top*d+this.offset.parent.top*d-(b.browser.safari&&b.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():p?0:c.scrollTop())*d),left:a.left+this.offset.relative.left*d+this.offset.parent.left*d-(b.browser.safari&&b.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():p?0:c.scrollLeft())*d)}},_generatePosition:function(n){var a=this.options,d=this.cssPosition=="absolute"&&
(this.scrollParent[0]==document||!b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,c=/(html|body)/i.test(d[0].tagName),p=n.pageX,e=n.pageY;if(this.originalPosition){var k;if(this.containment){if(this.relative_container){k=this.relative_container.offset();k=[this.containment[0]+k.left,this.containment[1]+k.top,this.containment[2]+k.left,this.containment[3]+k.top]}else k=this.containment;n.pageX-this.offset.click.left<k[0]&&(p=k[0]+this.offset.click.left);
n.pageY-this.offset.click.top<k[1]&&(e=k[1]+this.offset.click.top);n.pageX-this.offset.click.left>k[2]&&(p=k[2]+this.offset.click.left);n.pageY-this.offset.click.top>k[3]&&(e=k[3]+this.offset.click.top)}if(a.grid){e=a.grid[1]?this.originalPageY+Math.round((e-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY;e=k?e-this.offset.click.top<k[1]||e-this.offset.click.top>k[3]?e-this.offset.click.top<k[1]?e+a.grid[1]:e-a.grid[1]:e:e;p=a.grid[0]?this.originalPageX+Math.round((p-this.originalPageX)/
a.grid[0])*a.grid[0]:this.originalPageX;p=k?p-this.offset.click.left<k[0]||p-this.offset.click.left>k[2]?p-this.offset.click.left<k[0]?p+a.grid[0]:p-a.grid[0]:p:p}}return{top:e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(b.browser.safari&&b.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():c?0:d.scrollTop()),left:p-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(b.browser.safari&&b.browser.version<
526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():c?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(n,a,d){d=d||this._uiHash();b.ui.plugin.call(this,n,[a,d]);n=="drag"&&(this.positionAbs=this._convertPositionTo("absolute"));return b.Widget.prototype._trigger.call(this,n,a,
d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});b.extend(b.ui.draggable,{version:"1.8.17"});b.ui.plugin.add("draggable","connectToSortable",{start:function(n,a){var d=b(this).data("draggable"),c=d.options,p=b.extend({},a,{item:d.element});d.sortables=[];b(c.connectToSortable).each(function(){var e=b.data(this,"sortable");e&&!e.options.disabled&&(d.sortables.push({instance:e,shouldRevert:e.options.revert}),
e.refreshPositions(),e._trigger("activate",n,p))})},stop:function(n,a){var d=b(this).data("draggable"),c=b.extend({},a,{item:d.element});b.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=true,this.instance.cancelHelperRemoval=false,this.shouldRevert&&(this.instance.options.revert=true),this.instance._mouseStop(n),this.instance.options.helper=this.instance.options._helper,d.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):
(this.instance.cancelHelperRemoval=false,this.instance._trigger("deactivate",n,c))})},drag:function(n,a){var d=b(this).data("draggable"),c=this;b.each(d.sortables,function(){this.instance.positionAbs=d.positionAbs;this.instance.helperProportions=d.helperProportions;this.instance.offset.click=d.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=b(c).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",
true),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return a.helper[0]},n.target=this.instance.currentItem[0],this.instance._mouseCapture(n,true),this.instance._mouseStart(n,true,true),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,
d._trigger("toSortable",n),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(n)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=true,this.instance.options.revert=false,this.instance._trigger("out",n,this.instance._uiHash(this.instance)),this.instance._mouseStop(n,true),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&
this.instance.placeholder.remove(),d._trigger("fromSortable",n),d.dropped=false)})}});b.ui.plugin.add("draggable","cursor",{start:function(){var n=b("body"),a=b(this).data("draggable").options;n.css("cursor")&&(a._cursor=n.css("cursor"));n.css("cursor",a.cursor)},stop:function(){var n=b(this).data("draggable").options;n._cursor&&b("body").css("cursor",n._cursor)}});b.ui.plugin.add("draggable","opacity",{start:function(n,a){var d=b(a.helper),c=b(this).data("draggable").options;d.css("opacity")&&(c._opacity=
d.css("opacity"));d.css("opacity",c.opacity)},stop:function(n,a){var d=b(this).data("draggable").options;d._opacity&&b(a.helper).css("opacity",d._opacity)}});b.ui.plugin.add("draggable","scroll",{start:function(){var n=b(this).data("draggable");n.scrollParent[0]!=document&&n.scrollParent[0].tagName!="HTML"&&(n.overflowOffset=n.scrollParent.offset())},drag:function(n){var a=b(this).data("draggable"),d=a.options,c=false;if(a.scrollParent[0]!=document&&a.scrollParent[0].tagName!="HTML"){if(!d.axis||
d.axis!="x")a.overflowOffset.top+a.scrollParent[0].offsetHeight-n.pageY<d.scrollSensitivity?a.scrollParent[0].scrollTop=c=a.scrollParent[0].scrollTop+d.scrollSpeed:n.pageY-a.overflowOffset.top<d.scrollSensitivity&&(a.scrollParent[0].scrollTop=c=a.scrollParent[0].scrollTop-d.scrollSpeed);if(!d.axis||d.axis!="y")a.overflowOffset.left+a.scrollParent[0].offsetWidth-n.pageX<d.scrollSensitivity?a.scrollParent[0].scrollLeft=c=a.scrollParent[0].scrollLeft+d.scrollSpeed:n.pageX-a.overflowOffset.left<d.scrollSensitivity&&
(a.scrollParent[0].scrollLeft=c=a.scrollParent[0].scrollLeft-d.scrollSpeed)}else{if(!d.axis||d.axis!="x")n.pageY-b(document).scrollTop()<d.scrollSensitivity?c=b(document).scrollTop(b(document).scrollTop()-d.scrollSpeed):b(window).height()-(n.pageY-b(document).scrollTop())<d.scrollSensitivity&&(c=b(document).scrollTop(b(document).scrollTop()+d.scrollSpeed));if(!d.axis||d.axis!="y")n.pageX-b(document).scrollLeft()<d.scrollSensitivity?c=b(document).scrollLeft(b(document).scrollLeft()-d.scrollSpeed):
b(window).width()-(n.pageX-b(document).scrollLeft())<d.scrollSensitivity&&(c=b(document).scrollLeft(b(document).scrollLeft()+d.scrollSpeed))}c!==false&&b.ui.ddmanager&&!d.dropBehaviour&&b.ui.ddmanager.prepareOffsets(a,n)}});b.ui.plugin.add("draggable","snap",{start:function(){var n=b(this).data("draggable"),a=n.options;n.snapElements=[];b(a.snap.constructor!=String?a.snap.items||":data(draggable)":a.snap).each(function(){var d=b(this),c=d.offset();this!=n.element[0]&&n.snapElements.push({item:this,
width:d.outerWidth(),height:d.outerHeight(),top:c.top,left:c.left})})},drag:function(n,a){for(var d=b(this).data("draggable"),c=d.options,p=c.snapTolerance,e=a.offset.left,k=e+d.helperProportions.width,h=a.offset.top,o=h+d.helperProportions.height,u=d.snapElements.length-1;u>=0;u--){var B=d.snapElements[u].left,s=B+d.snapElements[u].width,K=d.snapElements[u].top,P=K+d.snapElements[u].height;if(B-p<e&&e<s+p&&K-p<h&&h<P+p||B-p<e&&e<s+p&&K-p<o&&o<P+p||B-p<k&&k<s+p&&K-p<h&&h<P+p||B-p<k&&k<s+p&&K-p<o&&
o<P+p){if(c.snapMode!="inner"){var M=Math.abs(K-o)<=p,I=Math.abs(P-h)<=p,R=Math.abs(B-k)<=p,T=Math.abs(s-e)<=p;M&&(a.position.top=d._convertPositionTo("relative",{top:K-d.helperProportions.height,left:0}).top-d.margins.top);I&&(a.position.top=d._convertPositionTo("relative",{top:P,left:0}).top-d.margins.top);R&&(a.position.left=d._convertPositionTo("relative",{top:0,left:B-d.helperProportions.width}).left-d.margins.left);T&&(a.position.left=d._convertPositionTo("relative",{top:0,left:s}).left-d.margins.left)}var O=
M||I||R||T;if(c.snapMode!="outer"){M=Math.abs(K-h)<=p;I=Math.abs(P-o)<=p;R=Math.abs(B-e)<=p;T=Math.abs(s-k)<=p;M&&(a.position.top=d._convertPositionTo("relative",{top:K,left:0}).top-d.margins.top);I&&(a.position.top=d._convertPositionTo("relative",{top:P-d.helperProportions.height,left:0}).top-d.margins.top);R&&(a.position.left=d._convertPositionTo("relative",{top:0,left:B}).left-d.margins.left);T&&(a.position.left=d._convertPositionTo("relative",{top:0,left:s-d.helperProportions.width}).left-d.margins.left)}!d.snapElements[u].snapping&&
(M||I||R||T||O)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,n,b.extend(d._uiHash(),{snapItem:d.snapElements[u].item}));d.snapElements[u].snapping=M||I||R||T||O}else{d.snapElements[u].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,n,b.extend(d._uiHash(),{snapItem:d.snapElements[u].item}));d.snapElements[u].snapping=false}}}});b.ui.plugin.add("draggable","stack",{start:function(){var n=b(this).data("draggable").options;n=b.makeArray(b(n.stack)).sort(function(d,
c){return(parseInt(b(d).css("zIndex"),10)||0)-(parseInt(b(c).css("zIndex"),10)||0)});if(n.length){var a=parseInt(n[0].style.zIndex)||0;b(n).each(function(d){this.style.zIndex=a+d});this[0].style.zIndex=a+n.length}}});b.ui.plugin.add("draggable","zIndex",{start:function(n,a){var d=b(a.helper),c=b(this).data("draggable").options;d.css("zIndex")&&(c._zIndex=d.css("zIndex"));d.css("zIndex",c.zIndex)},stop:function(n,a){var d=b(this).data("draggable").options;d._zIndex&&b(a.helper).css("zIndex",d._zIndex)}})})(jQuery);
(function(b){b.widget("ui.slider",b.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var n=this,a=this.options,d=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),c=a.values&&a.values.length||1,p=[];this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(a.disabled?" ui-slider-disabled ui-disabled":""));this.range=b([]);a.range&&(a.range===true&&(a.values||(a.values=[this._valueMin(),this._valueMin()]),a.values.length&&a.values.length!==2&&(a.values=[a.values[0],a.values[0]])),this.range=b("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(a.range==="min"||a.range==="max"?" ui-slider-range-"+a.range:"")));for(var e=d.length;e<c;e+=1)p.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=d.add(b(p.join("")).appendTo(n.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(k){k.preventDefault()}).hover(function(){a.disabled||b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}).focus(function(){a.disabled?b(this).blur():(b(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),b(this).addClass("ui-state-focus"))}).blur(function(){b(this).removeClass("ui-state-focus")});this.handles.each(function(k){b(this).data("index.ui-slider-handle",
k)});this.handles.keydown(function(k){var h=true,o=b(this).data("index.ui-slider-handle"),u,B,s;if(!n.options.disabled){switch(k.keyCode){case b.ui.keyCode.HOME:case b.ui.keyCode.END:case b.ui.keyCode.PAGE_UP:case b.ui.keyCode.PAGE_DOWN:case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:h=false;if(!n._keySliding){n._keySliding=true;b(this).addClass("ui-state-active");u=n._start(k,o);if(u===false)return}}u=n.options.step;n.options.values&&n.options.values.length?
B=s=n.values(o):B=s=n.value();switch(k.keyCode){case b.ui.keyCode.HOME:s=n._valueMin();break;case b.ui.keyCode.END:s=n._valueMax();break;case b.ui.keyCode.PAGE_UP:s=n._trimAlignValue(B+(n._valueMax()-n._valueMin())/5);break;case b.ui.keyCode.PAGE_DOWN:s=n._trimAlignValue(B-(n._valueMax()-n._valueMin())/5);break;case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:if(B===n._valueMax())return;s=n._trimAlignValue(B+u);break;case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(B===n._valueMin())return;s=n._trimAlignValue(B-
u)}n._slide(k,o,s);return h}}).keyup(function(k){var h=b(this).data("index.ui-slider-handle");n._keySliding&&(n._keySliding=false,n._stop(k,h),n._change(k,h),b(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();
return this},_mouseCapture:function(n){var a=this.options,d,c,p,e,k;if(a.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();d=this._normValueFromMouse({x:n.pageX,y:n.pageY});c=this._valueMax()-this._valueMin()+1;e=this;this.handles.each(function(h){var o=Math.abs(d-e.values(h));c>o&&(c=o,p=b(this),k=h)});a.range===true&&this.values(1)===a.min&&(k+=1,p=b(this.handles[k]));if(this._start(n,k)===false)return false;
this._mouseSliding=true;e._handleIndex=k;p.addClass("ui-state-active").focus();a=p.offset();this._clickOffset=!b(n.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:n.pageX-a.left-p.width()/2,top:n.pageY-a.top-p.height()/2-(parseInt(p.css("borderTopWidth"),10)||0)-(parseInt(p.css("borderBottomWidth"),10)||0)+(parseInt(p.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(n,k,d);return this._animateOff=true},_mouseStart:function(){return true},_mouseDrag:function(n){var a=
this._normValueFromMouse({x:n.pageX,y:n.pageY});this._slide(n,this._handleIndex,a);return false},_mouseStop:function(n){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(n,this._handleIndex);this._change(n,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(n){var a,d;this.orientation==="horizontal"?
(a=this.elementSize.width,d=n.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(a=this.elementSize.height,d=n.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));n=d/a;n>1&&(n=1);n<0&&(n=0);this.orientation==="vertical"&&(n=1-n);a=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+n*a)},_start:function(n,a){var d={handle:this.handles[a],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(a),
d.values=this.values());return this._trigger("start",n,d)},_slide:function(n,a,d){var c,p,e;this.options.values&&this.options.values.length?(c=this.values(a?0:1),this.options.values.length===2&&this.options.range===true&&(a===0&&d>c||a===1&&d<c)&&(d=c),d!==this.values(a)&&(p=this.values(),p[a]=d,e=this._trigger("slide",n,{handle:this.handles[a],value:d,values:p}),this.values(a?0:1),e!==false&&this.values(a,d,true))):d!==this.value()&&(e=this._trigger("slide",n,{handle:this.handles[a],value:d}),e!==
false&&this.value(d))},_stop:function(n,a){var d={handle:this.handles[a],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(a),d.values=this.values());this._trigger("stop",n,d)},_change:function(n,a){if(!this._keySliding&&!this._mouseSliding){var d={handle:this.handles[a],value:this.value()};this.options.values&&this.options.values.length&&(d.value=this.values(a),d.values=this.values());this._trigger("change",n,d)}},value:function(n){if(arguments.length){this.options.value=
this._trimAlignValue(n);this._refreshValue();this._change(null,0)}else return this._value()},values:function(n,a){var d,c,p;if(arguments.length>1){this.options.values[n]=this._trimAlignValue(a);this._refreshValue();this._change(null,n)}else{if(!arguments.length)return this._values();if(!b.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(n):this.value();d=this.options.values;c=arguments[0];for(p=0;p<d.length;p+=1){d[p]=this._trimAlignValue(c[p]);this._change(null,
p)}this._refreshValue()}},_setOption:function(n,a){var d,c=0;b.isArray(this.options.values)&&(c=this.options.values.length);b.Widget.prototype._setOption.apply(this,arguments);switch(n){case "disabled":a?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",true),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",false),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(d=0;d<c;d+=1)this._change(null,d);this._animateOff=false}},_value:function(){var n=this.options.value;return n=this._trimAlignValue(n)},_values:function(n){var a,d;if(arguments.length){a=this.options.values[n];
return a=this._trimAlignValue(a)}a=this.options.values.slice();for(d=0;d<a.length;d+=1)a[d]=this._trimAlignValue(a[d]);return a},_trimAlignValue:function(n){if(n<=this._valueMin())return this._valueMin();if(n>=this._valueMax())return this._valueMax();var a=this.options.step>0?this.options.step:1,d=(n-this._valueMin())%a;n=n-d;Math.abs(d)*2>=a&&(n+=d>0?a:-a);return parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var n=
this.options.range,a=this.options,d=this,c=this._animateOff?false:a.animate,p,e={},k,h,o,u;this.options.values&&this.options.values.length?this.handles.each(function(B){p=(d.values(B)-d._valueMin())/(d._valueMax()-d._valueMin())*100;e[d.orientation==="horizontal"?"left":"bottom"]=p+"%";b(this).stop(1,1)[c?"animate":"css"](e,a.animate);d.options.range===true&&(d.orientation==="horizontal"?(B===0&&d.range.stop(1,1)[c?"animate":"css"]({left:p+"%"},a.animate),B===1&&d.range[c?"animate":"css"]({width:p-
k+"%"},{queue:false,duration:a.animate})):(B===0&&d.range.stop(1,1)[c?"animate":"css"]({bottom:p+"%"},a.animate),B===1&&d.range[c?"animate":"css"]({height:p-k+"%"},{queue:false,duration:a.animate})));k=p}):(h=this.value(),o=this._valueMin(),u=this._valueMax(),p=u!==o?(h-o)/(u-o)*100:0,e[d.orientation==="horizontal"?"left":"bottom"]=p+"%",this.handle.stop(1,1)[c?"animate":"css"](e,a.animate),n==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[c?"animate":"css"]({width:p+"%"},a.animate),
n==="max"&&this.orientation==="horizontal"&&this.range[c?"animate":"css"]({width:100-p+"%"},{queue:false,duration:a.animate}),n==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[c?"animate":"css"]({height:p+"%"},a.animate),n==="max"&&this.orientation==="vertical"&&this.range[c?"animate":"css"]({height:100-p+"%"},{queue:false,duration:a.animate}))}});b.extend(b.ui.slider,{version:"1.8.17"})})(jQuery);(function(b){Math.precision=function(e,k){if(k===undefined)k=0;return Math.round(e*Math.pow(10,k))/Math.pow(10,k)};var n=function(e,k){var h=this,o=e.find("img:first"),u=0,B=100,s=100,K=0,P=100,M=100,I=0,R=0,T,O,ca=[],ma=function(ba){for(var ea=0;ea<ca.length;ea++)ca[ea].call(h,h,ba)},ia=function(ba){var ea=e.offset();T={l:ea.left|0,t:ea.top|0};clearTimeout(O);O=setTimeout(function(){oa.call(h,ba)},0);b(document).bind("mousemove",Z).bind("mouseup",V);ba.preventDefault()},Z=function(ba){clearTimeout(O);
O=setTimeout(function(){oa.call(h,ba)},0);ba.stopPropagation();ba.preventDefault();return false},V=function(ba){b(document).unbind("mouseup",V).unbind("mousemove",Z);ba.stopPropagation();ba.preventDefault();return false},oa=function(ba){var ea=ba.pageX-T.l;ba=ba.pageY-T.t;var ra=e.w,pa=e.h;if(ea<0)ea=0;else if(ea>ra)ea=ra;if(ba<0)ba=0;else if(ba>pa)ba=pa;ha.call(h,"xy",{x:ea/ra*s+u,y:ba/pa*M+K})},ha=function(ba,ea,ra){if(ea===undefined){if(ba===undefined||ba==null)ba="xy";switch(ba.toLowerCase()){case "x":return I;
case "y":return R;default:return{x:I,y:R}}}if(!(ra!=null&&ra==h)){var pa=false,na,qa;if(ba==null)ba="xy";switch(ba.toLowerCase()){case "x":na=ea&&(ea.x&&ea.x|0||ea|0)||0;break;case "y":qa=ea&&(ea.y&&ea.y|0||ea|0)||0;break;default:na=ea&&ea.x&&ea.x|0||0;qa=ea&&ea.y&&ea.y|0||0}if(na!=null){if(na<u)na=u;else if(na>B)na=B;if(I!=na){I=na;pa=true}}if(qa!=null){if(qa<K)qa=K;else if(qa>P)qa=P;if(R!=qa){R=qa;pa=true}}pa&&ma.call(h,ra||h)}},la=function(ba){b.isFunction(ba)&&ca.push(ba)};b.extend(true,h,{val:ha,
range:function(ba,ea){if(ea===undefined){if(ba===undefined||ba==null)ba="all";switch(ba.toLowerCase()){case "minx":return u;case "maxx":return B;case "rangex":return{minX:u,maxX:B,rangeX:s};case "miny":return K;case "maxy":return P;case "rangey":return{minY:K,maxY:P,rangeY:M};default:return{minX:u,maxX:B,rangeX:s,minY:K,maxY:P,rangeY:M}}}var ra,pa,na,qa;if(ba==null)ba="all";switch(ba.toLowerCase()){case "minx":ra=ea&&(ea.minX&&ea.minX|0||ea|0)||0;break;case "maxx":pa=ea&&(ea.maxX&&ea.maxX|0||ea|0)||
0;break;case "rangex":ra=ea&&ea.minX&&ea.minX|0||0;pa=ea&&ea.maxX&&ea.maxX|0||0;break;case "miny":na=ea&&(ea.minY&&ea.minY|0||ea|0)||0;break;case "maxy":qa=ea&&(ea.maxY&&ea.maxY|0||ea|0)||0;break;case "rangey":na=ea&&ea.minY&&ea.minY|0||0;qa=ea&&ea.maxY&&ea.maxY|0||0;break;default:ra=ea&&ea.minX&&ea.minX|0||0;pa=ea&&ea.maxX&&ea.maxX|0||0;na=ea&&ea.minY&&ea.minY|0||0;qa=ea&&ea.maxY&&ea.maxY|0||0}if(ra!=null&&u!=ra){u=ra;s=B-u}if(pa!=null&&B!=pa){B=pa;s=B-u}if(na!=null&&K!=na){K=na;M=P-K}if(qa!=null&&
P!=qa){P=qa;M=P-K}},bind:la,unbind:function(ba){if(b.isFunction(ba))for(var ea;(ea=b.inArray(ba,ca))!=-1;)ca.splice(ea,1)},destroy:function(){b(document).unbind("mouseup",V).unbind("mousemove",Z);e.unbind("mousedown",ia);ca=o=e=null}});o.src=k.arrow&&k.arrow.image;o.w=k.arrow&&k.arrow.width||o.width();o.h=k.arrow&&k.arrow.height||o.height();e.w=k.map&&k.map.width||e.width();e.h=k.map&&k.map.height||e.height();e.bind("mousedown",ia);la.call(h,function(){var ba=0,ea=0,ra=e.w,pa=e.h,na=o.w,qa=o.h;setTimeout(function(){if(s>
0)ba=I==B?ra:I/s*ra|0;if(M>0)ea=R==P?pa:R/M*pa|0;if(na>=ra)ba=(ra>>1)-(na>>1);else ba-=na>>1;if(qa>=pa)ea=(pa>>1)-(qa>>1);else ea-=qa>>1;o.css({left:ba+"px",top:ea+"px"})},0)})},a=function(e,k,h,o){var u=this;e=e.find("td.Text input");var B=e.eq(3),s=e.eq(4),K=e.eq(5),P=e.length>7?e.eq(6):null,M=e.eq(0),I=e.eq(1),R=e.eq(2),T=e.eq(e.length>7?7:6),O=e.length>7?e.eq(8):null,ca=function(ha){if(!(ha.target.value==""&&ha.target!=T.get(0)&&(h!=null&&ha.target!=h.get(0)||h==null))){if(!Z(ha))return ha;switch(ha.target){case B.get(0):switch(ha.keyCode){case 38:B.val(V.call(u,
(B.val()<<0)+1,0,255));k.val("r",B.val(),ha.target);return false;case 40:B.val(V.call(u,(B.val()<<0)-1,0,255));k.val("r",B.val(),ha.target);return false}break;case s.get(0):switch(ha.keyCode){case 38:s.val(V.call(u,(s.val()<<0)+1,0,255));k.val("g",s.val(),ha.target);return false;case 40:s.val(V.call(u,(s.val()<<0)-1,0,255));k.val("g",s.val(),ha.target);return false}break;case K.get(0):switch(ha.keyCode){case 38:K.val(V.call(u,(K.val()<<0)+1,0,255));k.val("b",K.val(),ha.target);return false;case 40:K.val(V.call(u,
(K.val()<<0)-1,0,255));k.val("b",K.val(),ha.target);return false}break;case P&&P.get(0):switch(ha.keyCode){case 38:P.val(V.call(u,parseFloat(P.val())+1,0,100));k.val("a",Math.precision(P.val()*255/100,o),ha.target);return false;case 40:P.val(V.call(u,parseFloat(P.val())-1,0,100));k.val("a",Math.precision(P.val()*255/100,o),ha.target);return false}break;case M.get(0):switch(ha.keyCode){case 38:M.val(V.call(u,(M.val()<<0)+1,0,360));k.val("h",M.val(),ha.target);return false;case 40:M.val(V.call(u,(M.val()<<
0)-1,0,360));k.val("h",M.val(),ha.target);return false}break;case I.get(0):switch(ha.keyCode){case 38:I.val(V.call(u,(I.val()<<0)+1,0,100));k.val("s",I.val(),ha.target);return false;case 40:I.val(V.call(u,(I.val()<<0)-1,0,100));k.val("s",I.val(),ha.target);return false}break;case R.get(0):switch(ha.keyCode){case 38:R.val(V.call(u,(R.val()<<0)+1,0,100));k.val("v",R.val(),ha.target);return false;case 40:R.val(V.call(u,(R.val()<<0)-1,0,100));k.val("v",R.val(),ha.target);return false}}}},ma=function(ha){if(!(ha.target.value==
""&&ha.target!=T.get(0)&&(h!=null&&ha.target!=h.get(0)||h==null))){if(!Z(ha))return ha;switch(ha.target){case B.get(0):B.val(V.call(u,B.val(),0,255));k.val("r",B.val(),ha.target);break;case s.get(0):s.val(V.call(u,s.val(),0,255));k.val("g",s.val(),ha.target);break;case K.get(0):K.val(V.call(u,K.val(),0,255));k.val("b",K.val(),ha.target);break;case P&&P.get(0):P.val(V.call(u,P.val(),0,100));k.val("a",Math.precision(P.val()*255/100,o),ha.target);break;case M.get(0):M.val(V.call(u,M.val(),0,360));k.val("h",
M.val(),ha.target);break;case I.get(0):I.val(V.call(u,I.val(),0,100));k.val("s",I.val(),ha.target);break;case R.get(0):R.val(V.call(u,R.val(),0,100));k.val("v",R.val(),ha.target);break;case T.get(0):T.val(T.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));h&&h.val(T.val());k.val("hex",T.val()!=""?T.val():null,ha.target);break;case h&&h.get(0):h.val(h.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6));T.val(h.val());k.val("hex",h.val()!=""?h.val():null,ha.target);break;
case O&&O.get(0):O.val(O.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,2));k.val("a",O.val()!=null?parseInt(O.val(),16):null,ha.target)}}},ia=function(ha){if(k.val()!=null)switch(ha.target){case B.get(0):B.val(k.val("r"));break;case s.get(0):s.val(k.val("g"));break;case K.get(0):K.val(k.val("b"));break;case P&&P.get(0):P.val(Math.precision(k.val("a")*100/255,o));break;case M.get(0):M.val(k.val("h"));break;case I.get(0):I.val(k.val("s"));break;case R.get(0):R.val(k.val("v"));break;case T.get(0):case h&&
h.get(0):T.val(k.val("hex"));h&&h.val(k.val("hex"));break;case O&&O.get(0):O.val(k.val("ahex").substring(6))}},Z=function(ha){switch(ha.keyCode){case 9:case 16:case 29:case 37:case 39:return false;case "c".charCodeAt():case "v".charCodeAt():if(ha.ctrlKey)return false}return true},V=function(ha,la,ba){if(ha==""||isNaN(ha))return la;if(ha>ba)return ba;if(ha<la)return la;return ha},oa=function(ha,la){var ba=ha.val("all");if(la!=B.get(0))B.val(ba!=null?ba.r:"");if(la!=s.get(0))s.val(ba!=null?ba.g:"");
if(la!=K.get(0))K.val(ba!=null?ba.b:"");if(P&&la!=P.get(0))P.val(ba!=null?Math.precision(ba.a*100/255,o):"");if(la!=M.get(0))M.val(ba!=null?ba.h:"");if(la!=I.get(0))I.val(ba!=null?ba.s:"");if(la!=R.get(0))R.val(ba!=null?ba.v:"");if(la!=T.get(0)&&(h&&la!=h.get(0)||!h))T.val(ba!=null?ba.hex:"");if(h&&la!=h.get(0)&&la!=T.get(0))h.val(ba!=null?ba.hex:"");if(O&&la!=O.get(0))O.val(ba!=null?ba.ahex.substring(6):"")};b.extend(true,u,{destroy:function(){B.add(s).add(K).add(P).add(M).add(I).add(R).add(T).add(h).add(O).unbind("keyup",
ma).unbind("blur",ia);B.add(s).add(K).add(P).add(M).add(I).add(R).unbind("keydown",ca);k.unbind(oa);O=T=R=I=M=P=K=s=B=null}});B.add(s).add(K).add(P).add(M).add(I).add(R).add(T).add(h).add(O).bind("keyup",ma).bind("blur",ia);B.add(s).add(K).add(P).add(M).add(I).add(R).bind("keydown",ca);k.bind(oa)};b.jPicker={List:[],Color:function(e){var k=this,h,o,u,B,s,K,P,M=[],I=function(T){for(var O=0;O<M.length;O++)M[O].call(k,k,T)},R=function(T,O,ca){if(O===undefined){if(T===undefined||T==null||T=="")T="all";
if(h==null)return null;switch(T.toLowerCase()){case "ahex":return p.rgbaToHex({r:h,g:o,b:u,a:B});case "hex":return R("ahex").substring(0,6);case "all":return{r:h,g:o,b:u,a:B,h:s,s:K,v:P,hex:R.call(k,"hex"),ahex:R.call(k,"ahex")};default:O={};for(var ma=0;ma<T.length;ma++)switch(T.charAt(ma)){case "r":if(T.length==1)O=h;else O.r=h;break;case "g":if(T.length==1)O=o;else O.g=o;break;case "b":if(T.length==1)O=u;else O.b=u;break;case "a":if(T.length==1)O=B;else O.a=B;break;case "h":if(T.length==1)O=s;
else O.h=s;break;case "s":if(T.length==1)O=K;else O.s=K;break;case "v":if(T.length==1)O=P;else O.v=P}return O=={}?R.call(k,"all"):O}}if(!(ca!=null&&ca==k)){var ia=false;if(T==null)T="";if(O==null){if(h!=null){h=null;ia=true}if(o!=null){o=null;ia=true}if(u!=null){u=null;ia=true}if(B!=null){B=null;ia=true}if(s!=null){s=null;ia=true}if(K!=null){K=null;ia=true}if(P!=null){P=null;ia=true}ia&&I.call(k,ca||k)}else switch(T.toLowerCase()){case "ahex":case "hex":O=p.hexToRgba(O&&(O.ahex||O.hex)||O||"00000000");
R.call(k,"rgba",{r:O.r,g:O.g,b:O.b,a:T=="ahex"?O.a:B!=null?B:255},ca);break;default:if(O&&(O.ahex!=null||O.hex!=null)){R.call(k,"ahex",O.ahex||O.hex||"00000000",ca);break}var Z={},V=false,oa=false;if(O.r!==undefined&&!T.indexOf("r")==-1)T+="r";if(O.g!==undefined&&!T.indexOf("g")==-1)T+="g";if(O.b!==undefined&&!T.indexOf("b")==-1)T+="b";if(O.a!==undefined&&!T.indexOf("a")==-1)T+="a";if(O.h!==undefined&&!T.indexOf("h")==-1)T+="h";if(O.s!==undefined&&!T.indexOf("s")==-1)T+="s";if(O.v!==undefined&&!T.indexOf("v")==
-1)T+="v";for(ma=0;ma<T.length;ma++)switch(T.charAt(ma)){case "r":if(oa)continue;V=true;Z.r=O&&O.r&&O.r|0||O&&O|0||0;if(Z.r<0)Z.r=0;else if(Z.r>255)Z.r=255;if(h!=Z.r){h=Z.r;ia=true}break;case "g":if(oa)continue;V=true;Z.g=O&&O.g&&O.g|0||O&&O|0||0;if(Z.g<0)Z.g=0;else if(Z.g>255)Z.g=255;if(o!=Z.g){o=Z.g;ia=true}break;case "b":if(oa)continue;V=true;Z.b=O&&O.b&&O.b|0||O&&O|0||0;if(Z.b<0)Z.b=0;else if(Z.b>255)Z.b=255;if(u!=Z.b){u=Z.b;ia=true}break;case "a":Z.a=O&&O.a!=null?O.a|0:O!=null?O|0:255;if(Z.a<
0)Z.a=0;else if(Z.a>255)Z.a=255;if(B!=Z.a){B=Z.a;ia=true}break;case "h":if(V)continue;oa=true;Z.h=O&&O.h&&O.h|0||O&&O|0||0;if(Z.h<0)Z.h=0;else if(Z.h>360)Z.h=360;if(s!=Z.h){s=Z.h;ia=true}break;case "s":if(V)continue;oa=true;Z.s=O&&O.s!=null?O.s|0:O!=null?O|0:100;if(Z.s<0)Z.s=0;else if(Z.s>100)Z.s=100;if(K!=Z.s){K=Z.s;ia=true}break;case "v":if(V)continue;oa=true;Z.v=O&&O.v!=null?O.v|0:O!=null?O|0:100;if(Z.v<0)Z.v=0;else if(Z.v>100)Z.v=100;if(P!=Z.v){P=Z.v;ia=true}}if(ia){if(V){h=h||0;o=o||0;u=u||0;
O=p.rgbToHsv({r:h,g:o,b:u});s=O.h;K=O.s;P=O.v}else if(oa){s=s||0;K=K!=null?K:100;P=P!=null?P:100;O=p.hsvToRgb({h:s,s:K,v:P});h=O.r;o=O.g;u=O.b}B=B!=null?B:255;I.call(k,ca||k)}}}};b.extend(true,k,{val:R,bind:function(T){b.isFunction(T)&&M.push(T)},unbind:function(T){if(b.isFunction(T))for(var O;(O=b.inArray(T,M))!=-1;)M.splice(O,1)},destroy:function(){M=null}});if(e)if(e.ahex!=null)R("ahex",e);else if(e.hex!=null)R((e.a!=null?"a":"")+"hex",e.a!=null?{ahex:e.hex+p.intToHex(e.a)}:e);else if(e.r!=null&&
e.g!=null&&e.b!=null)R("rgb"+(e.a!=null?"a":""),e);else if(e.h!=null&&e.s!=null&&e.v!=null)R("hsv"+(e.a!=null?"a":""),e)},ColorMethods:{hexToRgba:function(e){e=this.validateHex(e);if(e=="")return{r:null,g:null,b:null,a:null};var k="00",h="00",o="00",u="255";if(e.length==6)e+="ff";if(e.length>6){k=e.substring(0,2);h=e.substring(2,4);o=e.substring(4,6);u=e.substring(6,e.length)}else{if(e.length>4){k=e.substring(4,e.length);e=e.substring(0,4)}if(e.length>2){h=e.substring(2,e.length);e=e.substring(0,
2)}if(e.length>0)o=e.substring(0,e.length)}return{r:this.hexToInt(k),g:this.hexToInt(h),b:this.hexToInt(o),a:this.hexToInt(u)}},validateHex:function(e){if(typeof e=="object")return"";e=e.toLowerCase().replace(/[^a-f0-9]/g,"");if(e.length>8)e=e.substring(0,8);return e},rgbaToHex:function(e){return this.intToHex(e.r)+this.intToHex(e.g)+this.intToHex(e.b)+this.intToHex(e.a)},intToHex:function(e){e=(e|0).toString(16);if(e.length==1)e="0"+e;return e.toLowerCase()},hexToInt:function(e){return parseInt(e,
16)},rgbToHsv:function(e){var k=e.r/255,h=e.g/255;e=e.b/255;var o={h:0,s:0,v:0},u=0,B=0;if(k>=h&&k>=e){B=k;u=h>e?e:h}else if(h>=e&&h>=k){B=h;u=k>e?e:k}else{B=e;u=h>k?k:h}o.v=B;o.s=B?(B-u)/B:0;if(o.s){u=B-u;o.h=k==B?(h-e)/u:h==B?2+(e-k)/u:4+(k-h)/u;o.h=parseInt(o.h*60);if(o.h<0)o.h+=360}else o.h=0;o.s=o.s*100|0;o.v=o.v*100|0;return o},hsvToRgb:function(e){var k={r:0,g:0,b:0,a:100},h=e.h,o=e.s;e=e.v;if(o==0)k.r=e==0?k.g=k.b=0:k.g=k.b=e*255/100|0;else{if(h==360)h=0;h/=60;o/=100;e/=100;var u=h|0,B=h-
u;h=e*(1-o);var s=e*(1-o*B);o=e*(1-o*(1-B));switch(u){case 0:k.r=e;k.g=o;k.b=h;break;case 1:k.r=s;k.g=e;k.b=h;break;case 2:k.r=h;k.g=e;k.b=o;break;case 3:k.r=h;k.g=s;k.b=e;break;case 4:k.r=o;k.g=h;k.b=e;break;case 5:k.r=e;k.g=h;k.b=s}k.r=k.r*255|0;k.g=k.g*255|0;k.b=k.b*255|0}return k}}};var d=b.jPicker.Color,c=b.jPicker.List,p=b.jPicker.ColorMethods;b.fn.jPicker=function(e){var k=arguments;return this.each(function(){var h=this,o=b.extend(true,{},b.fn.jPicker.defaults,e);if(b(h).get(0).nodeName.toLowerCase()==
"input"){b.extend(true,o,{window:{bindToInput:true,expandable:true,input:b(h)}});if(b(h).val()==""){o.color.active=new d({hex:null});o.color.current=new d({hex:null})}else if(p.validateHex(b(h).val())){o.color.active=new d({hex:b(h).val(),a:o.color.active.val("a")});o.color.current=new d({hex:b(h).val(),a:o.color.active.val("a")})}}if(o.window.expandable)b(h).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>');
else o.window.liveUpdate=false;var u=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters,B=null,s=null,K=null,P=null,M=null,I=null,R=null,T=null,O=null,ca=null,ma=null,ia=null,Z=null,V=null,oa=null,ha=null,la=null,ba=null,ea=null,ra=null,pa=null,na=null,qa=null,Ka=null,Fa=null,Oa=null,La=null,Ra=null,Ja=function(N){var Q=ja.active,da=Q.val("hex"),Da,Ma;o.color.mode=N;switch(N){case "h":setTimeout(function(){Wa.call(h,s,"transparent");Ba.call(h,P,0);ua.call(h,P,100);Ba.call(h,
M,260);ua.call(h,M,100);Wa.call(h,K,"transparent");Ba.call(h,R,0);ua.call(h,R,100);Ba.call(h,T,260);ua.call(h,T,100);Ba.call(h,O,260);ua.call(h,O,100);Ba.call(h,ca,260);ua.call(h,ca,100);Ba.call(h,ia,260);ua.call(h,ia,100)},0);Z.range("all",{minX:0,maxX:100,minY:0,maxY:100});V.range("rangeY",{minY:0,maxY:360});if(Q.val("ahex")==null)break;Z.val("xy",{x:Q.val("s"),y:100-Q.val("v")},Z);V.val("y",360-Q.val("h"),V);break;case "s":setTimeout(function(){Wa.call(h,s,"transparent");Ba.call(h,P,-260);Ba.call(h,
M,-520);Ba.call(h,R,-260);Ba.call(h,T,-520);Ba.call(h,ia,260);ua.call(h,ia,100)},0);Z.range("all",{minX:0,maxX:360,minY:0,maxY:100});V.range("rangeY",{minY:0,maxY:100});if(Q.val("ahex")==null)break;Z.val("xy",{x:Q.val("h"),y:100-Q.val("v")},Z);V.val("y",100-Q.val("s"),V);break;case "v":setTimeout(function(){Wa.call(h,s,"000000");Ba.call(h,P,-780);Ba.call(h,M,260);Wa.call(h,K,da);Ba.call(h,R,-520);Ba.call(h,T,260);ua.call(h,T,100);Ba.call(h,ia,260);ua.call(h,ia,100)},0);Z.range("all",{minX:0,maxX:360,
minY:0,maxY:100});V.range("rangeY",{minY:0,maxY:100});if(Q.val("ahex")==null)break;Z.val("xy",{x:Q.val("h"),y:100-Q.val("s")},Z);V.val("y",100-Q.val("v"),V);break;case "r":Da=-1040;Ma=-780;Z.range("all",{minX:0,maxX:255,minY:0,maxY:255});V.range("rangeY",{minY:0,maxY:255});if(Q.val("ahex")==null)break;Z.val("xy",{x:Q.val("b"),y:255-Q.val("g")},Z);V.val("y",255-Q.val("r"),V);break;case "g":Da=-1560;Ma=-1820;Z.range("all",{minX:0,maxX:255,minY:0,maxY:255});V.range("rangeY",{minY:0,maxY:255});if(Q.val("ahex")==
null)break;Z.val("xy",{x:Q.val("b"),y:255-Q.val("r")},Z);V.val("y",255-Q.val("g"),V);break;case "b":Da=-2080;Ma=-2860;Z.range("all",{minX:0,maxX:255,minY:0,maxY:255});V.range("rangeY",{minY:0,maxY:255});if(Q.val("ahex")==null)break;Z.val("xy",{x:Q.val("r"),y:255-Q.val("g")},Z);V.val("y",255-Q.val("b"),V);break;case "a":setTimeout(function(){Wa.call(h,s,"transparent");Ba.call(h,P,-260);Ba.call(h,M,-520);Ba.call(h,R,260);Ba.call(h,T,260);ua.call(h,T,100);Ba.call(h,ia,0);ua.call(h,ia,100)},0);Z.range("all",
{minX:0,maxX:360,minY:0,maxY:100});V.range("rangeY",{minY:0,maxY:255});if(Q.val("ahex")==null)break;Z.val("xy",{x:Q.val("h"),y:100-Q.val("v")},Z);V.val("y",255-Q.val("a"),V);break;default:throw"Invalid Mode";}switch(N){case "s":case "v":case "a":setTimeout(function(){ua.call(h,P,100);ua.call(h,R,100);Ba.call(h,O,260);ua.call(h,O,100);Ba.call(h,ca,260);ua.call(h,ca,100)},0);break;case "r":case "g":case "b":setTimeout(function(){Wa.call(h,s,"transparent");Wa.call(h,K,"transparent");ua.call(h,R,100);
ua.call(h,P,100);Ba.call(h,P,Da);Ba.call(h,M,Da-260);Ba.call(h,R,Ma-780);Ba.call(h,T,Ma-520);Ba.call(h,O,Ma);Ba.call(h,ca,Ma-260);Ba.call(h,ia,260);ua.call(h,ia,100)},0)}Q.val("ahex")!=null&&ta.call(h,Q)},ta=function(N,Q){if(Q==null||Q!=V&&Q!=Z)va.call(h,N,Q);setTimeout(function(){Va.call(h,N);ub.call(h,N);fb.call(h,N)},0)},wa=function(N,Q){var da=ja.active;if(!(Q!=Z&&da.val()==null)){var Da=N.val("all");switch(o.color.mode){case "h":da.val("sv",{s:Da.x,v:100-Da.y},Q);break;case "s":case "a":da.val("hv",
{h:Da.x,v:100-Da.y},Q);break;case "v":da.val("hs",{h:Da.x,s:100-Da.y},Q);break;case "r":da.val("gb",{g:255-Da.y,b:Da.x},Q);break;case "g":da.val("rb",{r:255-Da.y,b:Da.x},Q);break;case "b":da.val("rg",{r:Da.x,g:255-Da.y},Q)}}},Ea=function(N,Q){var da=ja.active;if(!(Q!=V&&da.val()==null))switch(o.color.mode){case "h":da.val("h",{h:360-N.val("y")},Q);break;case "s":da.val("s",{s:100-N.val("y")},Q);break;case "v":da.val("v",{v:100-N.val("y")},Q);break;case "r":da.val("r",{r:255-N.val("y")},Q);break;case "g":da.val("g",
{g:255-N.val("y")},Q);break;case "b":da.val("b",{b:255-N.val("y")},Q);break;case "a":da.val("a",255-N.val("y"),Q)}},va=function(N,Q){if(Q!=Z)switch(o.color.mode){case "h":var da=N.val("sv");Z.val("xy",{x:da!=null?da.s:100,y:100-(da!=null?da.v:100)},Q);break;case "s":case "a":da=N.val("hv");Z.val("xy",{x:da&&da.h||0,y:100-(da!=null?da.v:100)},Q);break;case "v":da=N.val("hs");Z.val("xy",{x:da&&da.h||0,y:100-(da!=null?da.s:100)},Q);break;case "r":da=N.val("bg");Z.val("xy",{x:da&&da.b||0,y:255-(da&&da.g||
0)},Q);break;case "g":da=N.val("br");Z.val("xy",{x:da&&da.b||0,y:255-(da&&da.r||0)},Q);break;case "b":da=N.val("rg");Z.val("xy",{x:da&&da.r||0,y:255-(da&&da.g||0)},Q)}if(Q!=V)switch(o.color.mode){case "h":V.val("y",360-(N.val("h")||0),Q);break;case "s":da=N.val("s");V.val("y",100-(da!=null?da:100),Q);break;case "v":da=N.val("v");V.val("y",100-(da!=null?da:100),Q);break;case "r":V.val("y",255-(N.val("r")||0),Q);break;case "g":V.val("y",255-(N.val("g")||0),Q);break;case "b":V.val("y",255-(N.val("b")||
0),Q);break;case "a":da=N.val("a");V.val("y",255-(da!=null?da:255),Q)}},Va=function(N){try{var Q=N.val("all");ra.css({backgroundColor:Q&&"#"+Q.hex||"transparent"});ua.call(h,ra,Q&&Math.precision(Q.a*100/255,4)||0)}catch(da){}},ub=function(N){switch(o.color.mode){case "h":Wa.call(h,s,(new d({h:N.val("h")||0,s:100,v:100})).val("hex"));break;case "s":case "a":var Q=N.val("s");ua.call(h,M,100-(Q!=null?Q:100));break;case "v":Q=N.val("v");ua.call(h,P,Q!=null?Q:100);break;case "r":ua.call(h,M,Math.precision((N.val("r")||
0)/255*100,4));break;case "g":ua.call(h,M,Math.precision((N.val("g")||0)/255*100,4));break;case "b":ua.call(h,M,Math.precision((N.val("b")||0)/255*100))}N=N.val("a");ua.call(h,I,Math.precision((255-(N||0))*100/255,4))},fb=function(N){switch(o.color.mode){case "h":var Q=N.val("a");ua.call(h,ma,Math.precision((255-(Q||0))*100/255,4));break;case "s":Q=N.val("hva");var da=new d({h:Q&&Q.h||0,s:100,v:Q!=null?Q.v:100});Wa.call(h,K,da.val("hex"));ua.call(h,T,100-(Q!=null?Q.v:100));ua.call(h,ma,Math.precision((255-
(Q&&Q.a||0))*100/255,4));break;case "v":Q=N.val("hsa");da=new d({h:Q&&Q.h||0,s:Q!=null?Q.s:100,v:100});Wa.call(h,K,da.val("hex"));ua.call(h,ma,Math.precision((255-(Q&&Q.a||0))*100/255,4));break;case "r":case "g":case "b":da=Q=0;N=N.val("rgba");if(o.color.mode=="r"){Q=N&&N.b||0;da=N&&N.g||0}else if(o.color.mode=="g"){Q=N&&N.b||0;da=N&&N.r||0}else if(o.color.mode=="b"){Q=N&&N.r||0;da=N&&N.g||0}var Da=da>Q?Q:da;ua.call(h,T,Q>da?Math.precision((Q-da)/(255-da)*100,4):0);ua.call(h,O,da>Q?Math.precision((da-
Q)/(255-Q)*100,4):0);ua.call(h,ca,Math.precision(Da/255*100,4));ua.call(h,ma,Math.precision((255-(N&&N.a||0))*100/255,4));break;case "a":Q=N.val("a");Wa.call(h,K,N.val("hex")||"000000");ua.call(h,ma,Q!=null?0:100);ua.call(h,ia,Q!=null?100:0)}},Wa=function(N,Q){N.css({backgroundColor:Q&&Q.length==6&&"#"+Q||"transparent"})},Ya=function(N,Q){if(u&&(Q.indexOf("AlphaBar.png")!=-1||Q.indexOf("Bars.png")!=-1||Q.indexOf("Maps.png")!=-1)){N.attr("pngSrc",Q);N.css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
Q+"', sizingMethod='scale')"})}else N.css({backgroundImage:"url('"+Q+"')"})},Ba=function(N,Q){N.css({top:Q+"px"})},ua=function(N,Q){N.css({visibility:Q>0?"visible":"hidden"});if(Q>0&&Q<100)if(u){var da=N.attr("pngSrc");da!=null&&(da.indexOf("AlphaBar.png")!=-1||da.indexOf("Bars.png")!=-1||da.indexOf("Maps.png")!=-1)?N.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+da+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+Q+")"}):N.css({opacity:Math.precision(Q/
100,4)})}else N.css({opacity:Math.precision(Q/100,4)});else if(Q==0||Q==100)if(u){da=N.attr("pngSrc");da!=null&&(da.indexOf("AlphaBar.png")!=-1||da.indexOf("Bars.png")!=-1||da.indexOf("Maps.png")!=-1)?N.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+da+"', sizingMethod='scale')"}):N.css({opacity:""})}else N.css({opacity:""})},db=function(){ja.active.val("ahex",ja.current.val("ahex"))},Ga=function(){ja.current.val("ahex",ja.active.val("ahex"))},Ua=function(N){b(this).parents("tbody:first").find('input:radio[value!="'+
N.target.value+'"]').removeAttr("checked");Ja.call(h,N.target.value)},Ca=function(){db.call(h)},hb=function(){db.call(h);o.window.expandable&&wb.call(h);b.isFunction(nb)&&nb.call(h,ja.active,qa)},qb=function(){Ga.call(h);o.window.expandable&&wb.call(h);b.isFunction(lb)&&lb.call(h,ja.active,na)},Za=function(){rb.call(h)},$a=function(N){var Q=N.val("hex");pa.css({backgroundColor:Q&&"#"+Q||"transparent"});ua.call(h,pa,Math.precision((N.val("a")||0)*100/255,4))},vb=function(N){var Q=N.val("hex");N=N.val("va");
Fa.css({backgroundColor:Q&&"#"+Q||"transparent"});ua.call(h,Oa,Math.precision((255-(N&&N.a||0))*100/255,4));if(o.window.bindToInput&&o.window.updateInputColor)o.window.input.css({backgroundColor:Q&&"#"+Q||"transparent",color:N==null||N.v>75?"#000000":"#ffffff"})},sa=function(N){ha=parseInt(B.css("left"));la=parseInt(B.css("top"));ba=N.pageX;ea=N.pageY;b(document).bind("mousemove",kb).bind("mouseup",gb);N.preventDefault()},kb=function(N){B.css({left:ha-(ba-N.pageX)+"px",top:la-(ea-N.pageY)+"px"});
o.window.expandable&&!b.support.boxModel&&B.prev().css({left:B.css("left"),top:B.css("top")});N.stopPropagation();N.preventDefault();return false},gb=function(N){b(document).unbind("mousemove",kb).unbind("mouseup",gb);N.stopPropagation();N.preventDefault();return false},tb=function(N){N.preventDefault();N.stopPropagation();ja.active.val("ahex",b(this).attr("title")||null,N.target);return false},lb=b.isFunction(k[1])&&k[1]||null,eb=b.isFunction(k[2])&&k[2]||null,nb=b.isFunction(k[3])&&k[3]||null,rb=
function(){ja.current.val("ahex",ja.active.val("ahex"));var N=function(){if(!(!o.window.expandable||b.support.boxModel)){var Q=B.find("table:first");B.before("<iframe/>");B.prev().css({width:Q.width(),height:B.height(),opacity:0,position:"absolute",left:B.css("left"),top:B.css("top")})}};if(o.window.expandable){b(document.body).children("div.jPicker.Container").css({zIndex:10});B.css({zIndex:20})}switch(o.window.effects.type){case "fade":B.fadeIn(o.window.effects.speed.show,N);break;case "slide":B.slideDown(o.window.effects.speed.show,
N);break;default:B.show(o.window.effects.speed.show,N)}},wb=function(){var N=function(){o.window.expandable&&B.css({zIndex:10});!o.window.expandable||b.support.boxModel||B.prev().remove()};switch(o.window.effects.type){case "fade":B.fadeOut(o.window.effects.speed.hide,N);break;case "slide":B.slideUp(o.window.effects.speed.hide,N);break;default:B.hide(o.window.effects.speed.hide,N)}},xb=function(){var N=o.window,Q=N.expandable?b(h).next().find(".Container:first"):null;B=N.expandable?b("<div/>"):b(h);
B.addClass("jPicker Container");N.expandable&&B.hide();B.get(0).onselectstart=function(Pa){if(Pa.target.nodeName.toLowerCase()!=="input")return false};var da=ja.active.val("all");if(N.alphaPrecision<0)N.alphaPrecision=0;else if(N.alphaPrecision>2)N.alphaPrecision=2;var Da='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(N.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(N.title||aa.text.title)+'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+
ga.clientPath+ga.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+ga.clientPath+ga.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview"><div class="prev_div">'+aa.text.newColor+'<div class="color_preview"><span class="Active" title="'+aa.tooltips.colors.newColor+
'">&nbsp;</span><span class="Current" title="'+aa.tooltips.colors.currentColor+'">&nbsp;</span></div></div>'+aa.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+aa.text.ok+'" title="'+aa.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+aa.text.cancel+'" title="'+aa.tooltips.buttons.cancel+'"/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+aa.tooltips.hue.radio+'"><input type="radio" value="h"'+
(o.color.mode=="h"?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(da!=null?da.h:"")+'" title="'+aa.tooltips.hue.textbox+'"/>&nbsp;\u00ba</td></tr><tr class="Saturation"><td class="Radio"><label title="'+aa.tooltips.saturation.radio+'"><input type="radio" value="s"'+(o.color.mode=="s"?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(da!=null?da.s:"")+'" title="'+aa.tooltips.saturation.textbox+
'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+aa.tooltips.value.radio+'"><input type="radio" value="v"'+(o.color.mode=="v"?' checked="checked"':"")+'/>V:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(da!=null?da.v:"")+'" title="'+aa.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+aa.tooltips.red.radio+'"><input type="radio" value="r"'+(o.color.mode=="r"?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+
(da!=null?da.r:"")+'" title="'+aa.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+aa.tooltips.green.radio+'"><input type="radio" value="g"'+(o.color.mode=="g"?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(da!=null?da.g:"")+'" title="'+aa.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+aa.tooltips.blue.radio+'"><input type="radio" value="b"'+(o.color.mode=="b"?' checked="checked"':
"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(da!=null?da.b:"")+'" title="'+aa.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(N.alphaSupport?'<label title="'+aa.tooltips.alpha.radio+'"><input type="radio" value="a"'+(o.color.mode=="a"?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(N.alphaSupport?'<input type="text" maxlength="'+(3+N.alphaPrecision)+'" value="'+(da!=null?Math.precision(da.a*100/255,N.alphaPrecision):
"")+'" title="'+aa.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+aa.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(da!=null?da.hex:"")+'"/></label>'+(N.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(da!=null?da.ahex.substring(6):"")+'" title="'+aa.tooltips.hex.alpha+'"/></td>':"&nbsp;")+"</tr></tbody></table>";if(N.expandable){B.html(Da);b(document.body).children("div.jPicker.Container").length==
0?b(document.body).prepend(B):b(document.body).children("div.jPicker.Container:last").after(B);B.mousedown(function(){b(document.body).children("div.jPicker.Container").css({zIndex:10});B.css({zIndex:20})});B.css({left:N.position.x=="left"?Q.offset().left-530-(N.position.y=="center"?25:0)+"px":N.position.x=="center"?Q.offset().left-260+"px":N.position.x=="right"?Q.offset().left-10+(N.position.y=="center"?25:0)+"px":N.position.x=="screenCenter"?(b(document).width()>>1)-260+"px":Q.offset().left+parseInt(N.position.x)+
"px",position:"absolute",top:N.position.y=="top"?Q.offset().top-312+"px":N.position.y=="center"?Q.offset().top-156+"px":N.position.y=="bottom"?Q.offset().top+25+"px":Q.offset().top+parseInt(N.position.y)+"px"})}else{B=b(h);B.html(Da)}Da=B.find("tbody:first");s=Da.find("div.Map:first");K=Da.find("div.Bar:first");var Ma=s.find("span"),Sa=K.find("span");P=Ma.filter(".Map1:first");M=Ma.filter(".Map2:first");I=Ma.filter(".Map3:first");R=Sa.filter(".Map1:first");T=Sa.filter(".Map2:first");O=Sa.filter(".Map3:first");
ca=Sa.filter(".Map4:first");ma=Sa.filter(".Map5:first");ia=Sa.filter(".Map6:first");Z=new n(s,{map:{width:ga.colorMap.width,height:ga.colorMap.height},arrow:{image:ga.clientPath+ga.colorMap.arrow.file,width:ga.colorMap.arrow.width,height:ga.colorMap.arrow.height}});Z.bind(wa);V=new n(K,{map:{width:ga.colorBar.width,height:ga.colorBar.height},arrow:{image:ga.clientPath+ga.colorBar.arrow.file,width:ga.colorBar.arrow.width,height:ga.colorBar.arrow.height}});V.bind(Ea);oa=new a(Da,ja.active,N.expandable&&
N.bindToInput?N.input:null,N.alphaPrecision);Ma=da!=null?da.hex:null;var cb=Da.find(".Preview");Sa=Da.find(".Button");ra=cb.find(".Active:first").css({backgroundColor:Ma&&"#"+Ma||"transparent"});pa=cb.find(".Current:first").css({backgroundColor:Ma&&"#"+Ma||"transparent"}).bind("click",Ca);ua.call(h,pa,Math.precision(ja.current.val("a")*100)/255,4);na=Sa.find(".Ok:first").bind("click touchstart",qb);qa=Sa.find(".Cancel:first").bind("click touchstart",hb);Ka=Sa.find(".Grid:first");setTimeout(function(){Ya.call(h,
P,ga.clientPath+"Maps.png");Ya.call(h,M,ga.clientPath+"Maps.png");Ya.call(h,I,ga.clientPath+"map-opacity.png");Ya.call(h,R,ga.clientPath+"Bars.png");Ya.call(h,T,ga.clientPath+"Bars.png");Ya.call(h,O,ga.clientPath+"Bars.png");Ya.call(h,ca,ga.clientPath+"Bars.png");Ya.call(h,ma,ga.clientPath+"bar-opacity.png");Ya.call(h,ia,ga.clientPath+"AlphaBar.png");Ya.call(h,cb.find("div:last"),ga.clientPath+"preview-opacity.png")},0);Da.find("td.Radio input").bind("click  touchstart",Ua);if(ja.quickList&&ja.quickList.length>
0){Sa="";for(i=0;i<ja.quickList.length;i++){if((typeof ja.quickList[i]).toString().toLowerCase()=="string")ja.quickList[i]=new d({hex:ja.quickList[i]});var pb=ja.quickList[i].val("a"),Ta=ja.quickList[i].val("ahex");if(!N.alphaSupport&&Ta)Ta=Ta.substring(0,6)+"ff";var ob=ja.quickList[i].val("hex");Sa+='<span class="QuickColor"'+(Ta&&' title="#'+Ta+'"'||"")+' style="background-color:'+(ob&&"#"+ob||"")+";"+(ob?"":"background-image:url("+ga.clientPath+"NoColor.png)")+(N.alphaSupport&&pb&&pb<255?";opacity:"+
Math.precision(pb/255,4)+";filter:Alpha(opacity="+Math.precision(pb/2.55,4)+")":"")+'">&nbsp;</span>'}Ya.call(h,Ka,ga.clientPath+"bar-opacity.png");Ka.html(Sa);Ka.find(".QuickColor").click(tb)}Ja.call(h,o.color.mode);ja.active.bind(ta);b.isFunction(eb)&&ja.active.bind(eb);ja.current.bind($a);if(N.expandable){h.icon=Q.parents(".Icon:first");Fa=h.icon.find(".Color:first").css({backgroundColor:Ma&&"#"+Ma||"transparent"});Oa=h.icon.find(".Alpha:first");Ya.call(h,Oa,ga.clientPath+"bar-opacity.png");ua.call(h,
Oa,Math.precision((255-(da!=null?da.a:0))*100/255,4));La=h.icon.find(".Image:first").css({backgroundImage:"url('"+ga.clientPath+ga.picker.file+"')"}).bind("click",Za);if(N.bindToInput&&N.updateInputColor)N.input.css({backgroundColor:Ma&&"#"+Ma||"transparent",color:da==null||da.v>75?"#000000":"#ffffff"});Ra=Da.find(".Move:first").bind("mousedown",sa);ja.active.bind(vb)}else rb.call(h)},ga=o.images,aa=o.localization,ja={active:(typeof o.color.active).toString().toLowerCase()=="string"?new d({ahex:!o.window.alphaSupport&&
o.color.active?o.color.active.substring(0,6)+"ff":o.color.active}):new d({ahex:!o.window.alphaSupport&&o.color.active.val("ahex")?o.color.active.val("ahex").substring(0,6)+"ff":o.color.active.val("ahex")}),current:(typeof o.color.active).toString().toLowerCase()=="string"?new d({ahex:!o.window.alphaSupport&&o.color.active?o.color.active.substring(0,6)+"ff":o.color.active}):new d({ahex:!o.window.alphaSupport&&o.color.active.val("ahex")?o.color.active.val("ahex").substring(0,6)+"ff":o.color.active.val("ahex")}),
quickList:o.color.quickList};b.extend(true,h,{commitCallback:lb,liveCallback:eb,cancelCallback:nb,color:ja,show:rb,hide:wb,destroy:function(){B.find("td.Radio input  touchstart").unbind("click",Ua);pa.unbind("click  touchstart",Ca);qa.unbind("click  touchstart",hb);na.unbind("click  touchstart",qb);if(o.window.expandable){La.unbind("click",Za);Ra.unbind("mousedown",sa);h.icon=null}B.find(".QuickColor").unbind("click",tb);ia=ma=ca=O=T=R=I=M=P=K=s=null;Z.destroy();Z=null;V.destroy();V=null;oa.destroy();
eb=nb=lb=Ka=qa=na=pa=ra=oa=null;B.html("");for(i=0;i<c.length;i++)c[i]==h&&c.splice(i,1)}});c.push(h);setTimeout(function(){xb.call(h)},0)})};b.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:false,liveUpdate:true,alphaSupport:false,alphaPrecision:0,updateInputColor:true},color:{mode:"h",active:new d({ahex:"#ffcc00ff"}),quickList:[new d({h:360,s:33,v:100}),new d({h:360,s:66,v:100}),new d({h:360,s:100,v:100}),
new d({h:360,s:100,v:75}),new d({h:360,s:100,v:50}),new d({h:180,s:0,v:100}),new d({h:30,s:33,v:100}),new d({h:30,s:66,v:100}),new d({h:30,s:100,v:100}),new d({h:30,s:100,v:75}),new d({h:30,s:100,v:50}),new d({h:180,s:0,v:90}),new d({h:60,s:33,v:100}),new d({h:60,s:66,v:100}),new d({h:60,s:100,v:100}),new d({h:60,s:100,v:75}),new d({h:60,s:100,v:50}),new d({h:180,s:0,v:80}),new d({h:90,s:33,v:100}),new d({h:90,s:66,v:100}),new d({h:90,s:100,v:100}),new d({h:90,s:100,v:75}),new d({h:90,s:100,v:50}),
new d({h:180,s:0,v:70}),new d({h:120,s:33,v:100}),new d({h:120,s:66,v:100}),new d({h:120,s:100,v:100}),new d({h:120,s:100,v:75}),new d({h:120,s:100,v:50}),new d({h:180,s:0,v:60}),new d({h:150,s:33,v:100}),new d({h:150,s:66,v:100}),new d({h:150,s:100,v:100}),new d({h:150,s:100,v:75}),new d({h:150,s:100,v:50}),new d({h:180,s:0,v:50}),new d({h:180,s:33,v:100}),new d({h:180,s:66,v:100}),new d({h:180,s:100,v:100}),new d({h:180,s:100,v:75}),new d({h:180,s:100,v:50}),new d({h:180,s:0,v:40}),new d({h:210,
s:33,v:100}),new d({h:210,s:66,v:100}),new d({h:210,s:100,v:100}),new d({h:210,s:100,v:75}),new d({h:210,s:100,v:50}),new d({h:180,s:0,v:30}),new d({h:240,s:33,v:100}),new d({h:240,s:66,v:100}),new d({h:240,s:100,v:100}),new d({h:240,s:100,v:75}),new d({h:240,s:100,v:50}),new d({h:180,s:0,v:20}),new d({h:270,s:33,v:100}),new d({h:270,s:66,v:100}),new d({h:270,s:100,v:100}),new d({h:270,s:100,v:75}),new d({h:270,s:100,v:50}),new d({h:180,s:0,v:10}),new d({h:300,s:33,v:100}),new d({h:300,s:66,v:100}),
new d({h:300,s:100,v:100}),new d({h:300,s:100,v:75}),new d({h:300,s:100,v:50}),new d({h:180,s:0,v:0}),new d({h:330,s:33,v:100}),new d({h:330,s:66,v:100}),new d({h:330,s:100,v:100}),new d({h:330,s:100,v:75}),new d({h:330,s:100,v:50}),new d]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",
newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},
value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},
hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}}})(jQuery,"1.1.6");(function(b){function n(c){var p=c||window.event,e=[].slice.call(arguments,1),k=0,h=0,o=0;c=b.event.fix(p);c.type="mousewheel";if(p.wheelDelta)k=p.wheelDelta/120;if(p.detail)k=-p.detail/3;o=k;if(p.axis!==undefined&&p.axis===p.HORIZONTAL_AXIS){o=0;h=-1*k}if(p.wheelDeltaY!==undefined)o=p.wheelDeltaY/120;if(p.wheelDeltaX!==undefined)h=-1*p.wheelDeltaX/120;e.unshift(c,k,h,o);return(b.event.dispatch||b.event.handle).apply(this,e)}var a=["DOMMouseScroll","mousewheel"];if(b.event.fixHooks)for(var d=a.length;d;)b.event.fixHooks[a[--d]]=
b.event.mouseHooks;b.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var c=a.length;c;)this.addEventListener(a[--c],n,false);else this.onmousewheel=n},teardown:function(){if(this.removeEventListener)for(var c=a.length;c;)this.removeEventListener(a[--c],n,false);else this.onmousewheel=null}};b.fn.extend({mousewheel:function(c){return c?this.bind("mousewheel",c):this.trigger("mousewheel")},unmousewheel:function(c){return this.unbind("mousewheel",c)}})})(jQuery);methodDraw.addExtension("eyedropper",function(b){var n=methodDraw.canvas,a=svgedit.history.ChangeElementCommand,d={fillPaint:"red",fillOpacity:1,strokePaint:"black",strokeOpacity:1,strokeWidth:5,strokeDashArray:null,opacity:1,strokeLinecap:"butt",strokeLinejoin:"miter"},c=function(p,e,k){var h=null;if(p.indexOf("url(#")===0){p=(p=n.getRefElem(p))?p.cloneNode(true):$("#"+k+"_color defs *")[0];h={alpha:e};h[p.tagName]=p}else h=p.indexOf("#")===0?{alpha:e,solidColor:p.substr(1)}:{alpha:e,solidColor:"none"};
return new $.jGraduate.Paint(h)};return{name:"eyedropper",svgicons:"extensions/eyedropper-icon.xml",buttons:[{id:"tool_eyedropper",type:"mode",title:"Eye Dropper Tool",position:8,key:"I",icon:"extensions/eyedropper.png",events:{click:function(){n.setMode("eyedropper")}}}],mouseDown:function(p){var e=n.getMode(),k=p.event;k=k.target.id==="svgroot"?document.getElementById("canvas_background"):k.target;if(e=="eyedropper"&&k){d.fillPaint=k.getAttribute("fill")||"white";d.fillOpacity=k.getAttribute("fill-opacity")||
1;d.strokePaint=k.getAttribute("stroke")||"none";d.strokeOpacity=k.getAttribute("stroke-opacity")||1;d.strokeWidth=k.getAttribute("stroke-width");d.strokeDashArray=k.getAttribute("stroke-dasharray");d.strokeLinecap=k.getAttribute("stroke-linecap");d.strokeLinejoin=k.getAttribute("stroke-linejoin");d.opacity=k.getAttribute("opacity")||1;p.selectedElements=p.selectedElements.filter(Boolean);if(p.selectedElements.length){if($.inArray(p.selectedElements.nodeName,["g","use"])==-1){var h={},o=function(B,
s,K){h[s]=B.getAttribute(s);B.setAttribute(s,K)},u=new b.BatchCommand;p.selectedElements.forEach(function(B){d.fillPaint&&o(B,"fill",d.fillPaint);d.fillOpacity&&o(B,"fill-opacity",d.fillOpacity);d.strokePaint&&o(B,"stroke",d.strokePaint);d.strokeOpacity&&o(B,"stroke-opacity",d.strokeOpacity);d.strokeWidth&&o(B,"stroke-width",d.strokeWidth);d.strokeDashArray&&o(B,"stroke-dasharray",d.strokeDashArray);d.opacity&&o(B,"opacity",d.opacity);d.strokeLinecap&&o(B,"stroke-linecap",d.strokeLinecap);d.strokeLinejoin&&
o(B,"stroke-linejoin",d.strokeLinejoin);u.addSubCommand(new a(B,h));h={}});p=c(d.fillPaint,d.fillOpacity*100,"fill");e=c(d.strokePaint,d.strokeOpacity*100,"stroke");methodDraw.paintBox.fill.update(true);methodDraw.paintBox.stroke.update(true);n.undoMgr.addCommandToHistory(u)}}else{p=c(d.fillPaint,d.fillOpacity*100,"fill");e=c(d.strokePaint,d.strokeOpacity*100,"stroke");methodDraw.paintBox.fill.setPaint(p);methodDraw.paintBox.stroke.setPaint(e)}}}}});methodDraw.addExtension("view_grid",function(b){function n(o){k.attr("width");k.attr("height");var u=svgedit.units.getTypeMap()[methodDraw.curConfig.baseUnit],B=[0.01,0.1,1,10,100,1E3];d.getContentElem().getAttribute("x");var s=p;u=u*o;var K=100/u,P=1;for(o=0;o<B.length;o++){var M=B[o];P=M;if(K<=M)break}B=P*u;s.width=B;s.height=B;u=s.getContext("2d");K=B/10;u.globalAlpha=0.2;u.strokeStyle="#000";for(o=1;o<10;o++){P=Math.round(K*o)+0.5;u.moveTo(P,B);u.lineTo(P,0);u.moveTo(B,P);u.lineTo(0,P)}u.stroke();
u.beginPath();u.globalAlpha=0.5;u.moveTo(0.5,B);u.lineTo(0.5,0);u.moveTo(B,0.5);u.lineTo(0,0.5);u.stroke();s=s.toDataURL("image/png");h.setAttribute("width",B);h.setAttribute("height",B);h.parentNode.setAttribute("width",B);h.parentNode.setAttribute("height",B);d.setHref(h,s)}if(!document.getElementById("canvasGrid")){var a=document.getElementById("svgcanvas").ownerDocument,d=methodDraw.canvas,c=false;b=b.assignAttributes;var p=document.createElement("canvas");$(p).hide().appendTo("body");var e=a.createElementNS("http://www.w3.org/2000/svg",
"g");b(e,{id:"canvasGrid",width:"100%",height:"100%",x:0,y:0,overflow:"visible",display:"none"});var k=$("#canvas_background");k.after(e);e=a.createElementNS("http://www.w3.org/2000/svg","pattern");b(e,{id:"gridpattern",patternUnits:"userSpaceOnUse",x:0,y:0,width:100,height:100});var h=a.createElementNS("http://www.w3.org/2000/svg","image");b(h,{x:0,y:0,width:100,height:100});e.appendChild(h);$("#svgroot defs").append(e);a=a.createElementNS("http://www.w3.org/2000/svg","rect");b(a,{width:"100%",height:"100%",
x:0,y:0,"stroke-width":0,stroke:"none",fill:"url(#gridpattern)",style:"pointer-events: none; display:visible;"});$("#canvasGrid").append(a)}return{name:"view_grid",zoomChanged:function(o){c&&n(o)},buttons:[{id:"view_grid",type:"menu",after:"tool_wireframe",panel:"view_menu",title:"View Grid",events:{click:function(){if($("#view_grid").hasClass("push_button_pressed")){methodDraw.curConfig.showGrid=c=false;$("#view_grid").removeClass("push_button_pressed");$("#canvasGrid").attr("display","none")}else{methodDraw.curConfig.showGrid=
c=true;$("#view_grid").addClass("push_button_pressed");$("#canvasGrid").attr("display","inline");n(d.getZoom())}}}}]}});methodDraw.addExtension("shapes",function(){function b(){$("#shape_buttons").empty();$("#shape_buttons").append(K.buttons)}function n(M){var I=s[M];if(I){K=I;I.buttons.length||a(M,I);b()}else{$("#shape_buttons").html("Loading...");$.getJSON("extensions/shapelib/"+M+".json",function(R){K=s[M]={data:R.data,size:R.size,fill:R.fill};a(M,R);b()})}}function a(M,I){var R=K.size||300,T=K.fill||false,O=R*0.05;O=[-O,-O,R+O*2,R+O*2].join(" ");R=T?0:R/30;R=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg"><svg viewBox="'+
O+'"><path fill="#333" stroke="transparent" stroke-width="'+R+'" /></svg></svg>',"text/xml");R.documentElement.setAttribute("width",40);R.documentElement.setAttribute("height",40);R=$(document.importNode(R.documentElement,true));T=I.data;K.buttons=[];for(var ca in T){O=T[ca];var ma=R.clone();ma.find("path").attr("d",O);O=ma.wrap('<div class="tool_button">').parent().attr({id:P+"_"+ca,title:ca});K.buttons.push(O[0])}}var d,c,p=methodDraw.canvas,e,k,h,o=p.getRootElem(),u={},B={basic:"Basic",object:"Objects",
symbol:"Symbols",arrow:"Arrows",flowchart:"Flowchart",nature:"Nature",game:"Cards & Chess",dialog_balloon:"Dialog balloons",music:"Music",weather:"Weather &amp; Time",ui:"User Interface",social:"Social Web"},s={basic:{data:{star_points_5:"m1,116.58409l113.82668,0l35.17332,-108.13487l35.17334,108.13487l113.82666,0l-92.08755,66.83026l35.17514,108.13487l-92.08759,-66.83208l-92.08757,66.83208l35.17515,-108.13487l-92.08758,-66.83026z",donut:"m1,150l0,0c0,-82.29042 66.70958,-149 149,-149l0,0c39.51724,0 77.41599,15.69816 105.35889,43.64108c27.94293,27.94293 43.64111,65.84165 43.64111,105.35892l0,0c0,82.29041 -66.70958,149 -149,149l0,0c-82.29041,0 -149,-66.70959 -149,-149zm74.5,0l0,0c0,41.1452 33.35481,74.5 74.5,74.5c41.14522,0 74.5,-33.3548 74.5,-74.5c0,-41.1452 -33.3548,-74.5 -74.5,-74.5l0,0c-41.14519,0 -74.5,33.35481 -74.5,74.5z",
triangle:"m1,280.375l149,-260.75l149,260.75z",right_triangle:"m1,299l0,-298l298,298z",diamond:"m1,150l149,-149l149,149l-149,149l-149,-149z",pentagon:"m1.00035,116.97758l148.99963,-108.4053l148.99998,108.4053l-56.91267,175.4042l-184.1741,0l-56.91284,-175.4042z",hexagon:"m1,149.99944l63.85715,-127.71428l170.28572,0l63.85713,127.71428l-63.85713,127.71428l-170.28572,0l-63.85715,-127.71428z",septagon1:"m0.99917,191.06511l29.51249,-127.7108l119.48833,-56.83673l119.48836,56.83673l29.51303,127.7108l-82.69087,102.41679l-132.62103,0l-82.69031,-102.41679z",
heptagon:"m1,88.28171l87.28172,-87.28171l123.43653,0l87.28172,87.28171l0,123.43654l-87.28172,87.28172l-123.43653,0l-87.28172,-87.28172l0,-123.43654z",decagon:"m1,150.00093l28.45646,-88.40318l74.49956,-54.63682l92.08794,0l74.50002,54.63682l28.45599,88.40318l-28.45599,88.40318l-74.50002,54.63681l-92.08794,0l-74.49956,-54.63681l-28.45646,-88.40318z",dodecagon:"m1,110.07421l39.92579,-69.14842l69.14842,-39.92579l79.85159,0l69.14842,39.92579l39.92578,69.14842l0,79.85159l-39.92578,69.14842l-69.14842,39.92578l-79.85159,0l-69.14842,-39.92578l-39.92579,-69.14842l0,-79.85159z",
trapezoid:"m1,299l55.875,-298l186.25001,0l55.87498,298z",dialog_balloon_1:"m0.99786,35.96579l0,0c0,-19.31077 15.28761,-34.96524 34.14583,-34.96524l15.52084,0l0,0l74.50001,0l139.68748,0c9.05606,0 17.74118,3.68382 24.14478,10.24108c6.40356,6.55726 10.00107,15.45081 10.00107,24.72416l0,87.41311l0,0l0,52.44785l0,0c0,19.31078 -15.2876,34.96524 -34.14584,34.96524l-139.68748,0l-97.32507,88.90848l22.82506,-88.90848l-15.52084,0c-18.85822,0 -34.14583,-15.65446 -34.14583,-34.96524l0,0l0,-52.44785l0,0z",heart:"m150,73c61,-175 300,0 0,225c-300,-225 -61,-400 0,-225z",
cylinder:"m299.0007,83.77844c0,18.28676 -66.70958,33.11111 -149.00002,33.11111m149.00002,-33.11111l0,0c0,18.28676 -66.70958,33.11111 -149.00002,33.11111c-82.29041,0 -148.99997,-14.82432 -148.99997,-33.11111m0,0l0,0c0,-18.28674 66.70956,-33.1111 148.99997,-33.1111c82.29044,0 149.00002,14.82436 149.00002,33.1111l0,132.44449c0,18.28674 -66.70958,33.11105 -149.00002,33.11105c-82.29041,0 -148.99997,-14.82431 -148.99997,-33.11105z",arrow_up:"m1.49805,149.64304l148.50121,-148.00241l148.50121,148.00241l-74.25061,0l0,148.71457l-148.5012,0l0,-148.71457z",
arrow_u_turn:"m1.00059,299.00055l0,-167.62497l0,0c0,-72.00411 58.37087,-130.37499 130.375,-130.37499l0,0l0,0c34.57759,0 67.73898,13.7359 92.18906,38.18595c24.45006,24.45005 38.18593,57.61144 38.18593,92.18904l0,18.625l37.24997,0l-74.49995,74.50002l-74.50002,-74.50002l37.25,0l0,-18.625c0,-30.8589 -25.0161,-55.87498 -55.87498,-55.87498l0,0l0,0c-30.85892,0 -55.875,25.01608 -55.875,55.87498l0,167.62497z",arrow_left_up:"m0.99865,224.5l74.50004,-74.5l0,37.25l111.74991,0l0,-111.75l-37.25,0l74.5,-74.5l74.5,74.5l-37.25,0l0,186.25l-186.24989,0l0,37.25l-74.50005,-74.5z",
plaque:"m-0.00197,49.94376l0,0c27.5829,0 49.94327,-22.36036 49.94327,-49.94327l199.76709,0l0,0c0,27.5829 22.36037,49.94327 49.94325,49.94327l0,199.7671l0,0c-27.58289,0 -49.94325,22.36034 -49.94325,49.94325l-199.76709,0c0,-27.58292 -22.36037,-49.94325 -49.94327,-49.94325z",page:"m249.3298,298.99744l9.9335,-39.73413l39.73413,-9.93355l-49.66763,49.66768l-248.33237,0l0,-298.00001l298.00001,0l0,248.33234",cross:"m0.99844,99.71339l98.71494,0l0,-98.71495l101.26279,0l0,98.71495l98.71495,0l0,101.2628l-98.71495,0l0,98.71494l-101.26279,0l0,-98.71494l-98.71494,0z",
divide:"m150,0.99785l0,0c25.17819,0 45.58916,20.41097 45.58916,45.58916c0,25.17821 -20.41096,45.58916 -45.58916,45.58916c-25.17822,0 -45.58916,-20.41093 -45.58916,-45.58916c0,-25.1782 20.41093,-45.58916 45.58916,-45.58916zm0,296.25203c-25.17822,0 -45.58916,-20.41095 -45.58916,-45.58917c0,-25.17819 20.41093,-45.58916 45.58916,-45.58916c25.17819,0 45.58916,20.41096 45.58916,45.58916c0,25.17822 -20.41096,45.58917 -45.58916,45.58917zm-134.06754,-193.71518l268.13507,0l0,91.17833l-268.13507,0z",minus:"m0.99887,102.39503l297.49445,0l0,95.2112l-297.49445,0z",
times:"m1.00089,73.36786l72.36697,-72.36697l76.87431,76.87368l76.87431,-76.87368l72.36765,72.36697l-76.87433,76.87431l76.87433,76.87431l-72.36765,72.36765l-76.87431,-76.87433l-76.87431,76.87433l-72.36697,-72.36765l76.87368,-76.87431l-76.87368,-76.87431z"},buttons:[]}},K=s.basic,P="shapelib";return{svgicons:"extensions/ext-shapes.xml",buttons:[{id:"tool_shapelib",type:"mode_flyout",position:6,title:"Shape library",icon:"extensions/ext-shapes.png",events:{click:function(){p.setMode(P)}}}],callback:function(){var M=
$('<div id="shape_buttons">');$("#tools_shapelib > *").wrapAll(M);var I=$("#tools_shapelib_show");n("basic");$("#shape_buttons").mouseup(function(T){T=$(T.target).closest("div.tool_button");if(T.length){var O=T.children().clone().attr({width:24,height:24});I.children(":not(.flyout_arrow_horiz)").remove();I.append(O).attr("data-curopt","#"+T[0].id).mouseup();p.setMode(P);c=T[0].id.substr((P+"_").length);d=K.data[c];$(".tools_flyout").fadeOut()}});M=$('<div id="shape_cats">');var R="";$.each(B,function(T,
O){R+="<div data-cat="+T+">"+O+"</div>"});M.html(R).children().bind("mouseup",function(){var T=$(this);T.siblings().removeClass("current");T.addClass("current");n(T.attr("data-cat"));return false});M.children().eq(0).addClass("current");$("#tools_shapelib").prepend(M);I.mouseup(function(){p.setMode(d?P:"select")});$("#tool_shapelib").remove();M=$("#tools_shapelib").height();$("#tools_shapelib").css({"margin-top":-(M/2),"margin-left":3})},mouseDown:function(M){if(p.getMode()===P){var I=k=M.start_x;
M=h=M.start_y;var R=p.getStyle();e=p.addSvgElementFromJson({element:"path",curStyles:true,attr:{d:d,id:p.getNextId(),opacity:R.opacity/2,style:"pointer-events:none"}});e.setAttribute("d",d);if(/[a-z]/.test(d)){d=K.data[c]=p.pathActions.convertPath(e);e.setAttribute("d",d);p.pathActions.fixEnd(e)}e.setAttribute("transform","translate("+I+","+M+") scale(0.005) translate("+-I+","+-M+")");p.recalculateDimensions(e);p.getTransformList(e);u=e.getBBox();totalScale={sx:1,sy:1};return{started:true}}},mouseMove:function(M){if(p.getMode()===
P){var I=p.getZoom(),R=M.event,T=M.mouse_x/I,O=M.mouse_y/I;M=p.getTransformList(e);var ca=e.getBBox();I=ca.x;var ma=ca.y,ia=ca.width,Z=ca.height,V=T-k,oa=O-h,ha={x:Math.min(k,T),y:Math.min(h,O),width:Math.abs(T-k),height:Math.abs(O-h)},la=ca=0;Z=Z?(Z+oa)/Z:1;ia=ia?(ia+V)/ia:1;ia=ha.width/u.width;Z=ha.height/u.height;ia=ia||1;Z=Z||1;if(T<k)ca=u.width;if(O<h)la=u.height;T=o.createSVGTransform();O=o.createSVGTransform();ha=o.createSVGTransform();T.setTranslate(-(I+ca),-(ma+la));if(R.shiftKey){replaced=
true;R=Math.min(Math.abs(ia),Math.abs(Z));ia=R*(ia<0?-1:1);Z=R*(Z<0?-1:1);if(totalScale.sx!=totalScale.sy){R=totalScale.sx>totalScale.sy?1:totalScale.sx/totalScale.sy;ia*=totalScale.sy>totalScale.sx?1:totalScale.sy/totalScale.sx;Z*=R}}totalScale.sx*=ia;totalScale.sy*=Z;O.setScale(ia,Z);ha.setTranslate(I+ca,ma+la);M.appendItem(ha);M.appendItem(O);M.appendItem(T);p.recalculateDimensions(e);u=e.getBBox()}},mouseUp:function(M){if(p.getMode()===P){if(M.mouse_x==k&&M.mouse_y==h)return{keep:false,element:e,
started:false};p.setMode("select");return{keep:true,element:e,started:false}}}}});(function(){for(var b=0,n=["ms","moz","webkit","o"],a=0;a<n.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[n[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[n[a]+"CancelAnimationFrame"]||window[n[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(d){var c=(new Date).getTime(),p=Math.max(0,16-(c-b)),e=window.setTimeout(function(){d(c+p)},p);b=c+p;return e};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=
function(d){clearTimeout(d)}})();(function(b){function n(s){var K=s.originalEvent;if(!K.touches||K.targetTouches.length===1&&K.touches.length===1){e.call(this,s);s=b(this);s.bind(u,a);s.bind(o,d)}else{clearTimeout(B);p.call(this)}}function a(s){if(B!=null){var K=s.originalEvent;s=K.changedTouches?K.changedTouches[0].pageX:K.pageX;K=K.changedTouches?K.changedTouches[0].pageY:K.pageY;var P=b(this).data("taphold.point");s=s-P.x;K=K-P.y;if(Math.sqrt(s*s+K*K)>h){clearTimeout(B);p.call(this)}}}function d(){clearTimeout(B);p.call(this)}
function c(s){p.call(this);b(this).data("taphold.handler").call(this,s)}function p(){B=null;b(this).unbind(u,a);b(this).unbind(o,d)}function e(s){if(B==null){var K=this;B=setTimeout(function(){c.call(K,s)},k);var P=s.originalEvent,M={};M.x=P.changedTouches?P.changedTouches[0].pageX:P.pageX;M.y=P.changedTouches?P.changedTouches[0].pageY:P.pageY;b(this).data("taphold.point",M)}}var k=1E3,h=5,o="touchend",u="touchmove",B=null;b.event.special.taphold={setup:function(){},add:function(s){b(this).data("taphold.handler",
s.handler);s.data?b(this).bind("touchstart",s.data,n):b(this).bind("touchstart",n)},remove:function(s){clearTimeout(B);p.call(this);s.data?b(this).unbind("touchstart",s.data,n):b(this).unbind("touchstart",n)},teardown:function(){}}})(jQuery);var saveAs=saveAs||function(b){if(!(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent))){var n=b.document.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in n,d=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),c=b.webkitRequestFileSystem,p=b.requestFileSystem||c||b.mozRequestFileSystem,e=function(K){(b.setImmediate||b.setTimeout)(function(){throw K;},0)},k=0,h=function(K){var P=function(){typeof K==="string"?(b.URL||b.webkitURL||b).revokeObjectURL(K):K.remove()};
b.chrome?P():setTimeout(P,500)},o=function(K,P,M){P=[].concat(P);for(var I=P.length;I--;){var R=K["on"+P[I]];if(typeof R==="function")try{R.call(K,M||K)}catch(T){e(T)}}},u=function(K){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(K.type))return new Blob(["\ufeff",K],{type:K.type});return K},B=function(K,P,M){M||(K=u(K));var I=this;M=K.type;var R=false,T,O,ca=function(){o(I,"writestart progress write writeend".split(" "))},ma=function(){if(O&&d&&typeof FileReader!==
"undefined"){var oa=new FileReader;oa.onloadend=function(){var ha=oa.result;O.location.href="data:attachment/file"+ha.slice(ha.search(/[,;]/));I.readyState=I.DONE;ca()};oa.readAsDataURL(K);I.readyState=I.INIT}else{if(R||!T)T=(b.URL||b.webkitURL||b).createObjectURL(K);if(O)O.location.href=T;else if(b.open(T,"_blank")==undefined&&d)b.location.href=T;I.readyState=I.DONE;ca();h(T)}},ia=function(oa){return function(){if(I.readyState!==I.DONE)return oa.apply(this,arguments)}},Z={create:true,exclusive:false},
V;I.readyState=I.INIT;P||(P="download");if(a){T=(b.URL||b.webkitURL||b).createObjectURL(K);setTimeout(function(){n.href=T;n.download=P;var oa=new MouseEvent("click");n.dispatchEvent(oa);ca();h(T);I.readyState=I.DONE})}else{if(b.chrome&&M&&M!=="application/octet-stream"){V=K.slice||K.webkitSlice;K=V.call(K,0,K.size,"application/octet-stream");R=true}if(c&&P!=="download")P+=".download";if(M==="application/octet-stream"||c)O=b;if(p){k+=K.size;p(b.TEMPORARY,k,ia(function(oa){oa.root.getDirectory("saved",
Z,ia(function(ha){var la=function(){ha.getFile(P,Z,ia(function(ba){ba.createWriter(ia(function(ea){ea.onwriteend=function(ra){O.location.href=ba.toURL();I.readyState=I.DONE;o(I,"writeend",ra);h(ba)};ea.onerror=function(){var ra=ea.error;ra.code!==ra.ABORT_ERR&&ma()};"writestart progress write abort".split(" ").forEach(function(ra){ea["on"+ra]=I["on"+ra]});ea.write(K);I.abort=function(){ea.abort();I.readyState=I.DONE};I.readyState=I.WRITING}),ma)}),ma)};ha.getFile(P,{create:false},ia(function(ba){ba.remove();
la()}),ia(function(ba){ba.code===ba.NOT_FOUND_ERR?la():ma()}))}),ma)}),ma)}else ma()}},s=B.prototype;if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob)return function(K,P,M){M||(K=u(K));return navigator.msSaveOrOpenBlob(K,P||"download")};s.abort=function(){this.readyState=this.DONE;o(this,"abort")};s.readyState=s.INIT=0;s.WRITING=1;s.DONE=2;s.error=s.onwritestart=s.onprogress=s.onwrite=s.onabort=s.onerror=s.onwriteend=null;return function(K,P,M){return new B(K,P,M)}}}(typeof self!=="undefined"&&
self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports)module.exports.saveAs=saveAs;else typeof define!=="undefined"&&define!==null&&define.amd!=null&&define([],function(){return saveAs});
